/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Ln=Symbol("Comlink.proxy"),ws=Symbol("Comlink.endpoint"),Cs=Symbol("Comlink.releaseProxy"),te=Symbol("Comlink.finalizer"),Dt=Symbol("Comlink.thrown"),Mn=e=>typeof e=="object"&&e!==null||typeof e=="function",Os={canHandle:e=>Mn(e)&&e[Ln],serialize(e){const{port1:t,port2:n}=new MessageChannel;return xe(e,t),[n,[n]]},deserialize(e){return e.start(),Ds(e)}},xs={canHandle:e=>Mn(e)&&Dt in e,serialize({value:e}){let t;return e instanceof Error?t={isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:t={isError:!1,value:e},[t,[]]},deserialize(e){throw e.isError?Object.assign(new Error(e.value.message),e.value):e.value}},kn=new Map([["proxy",Os],["throw",xs]]);function Es(e,t){for(const n of e)if(t===n||n==="*"||n instanceof RegExp&&n.test(t))return!0;return!1}function xe(e,t=globalThis,n=["*"]){t.addEventListener("message",function r(s){if(!s||!s.data)return;if(!Es(n,s.origin)){console.warn(`Invalid origin '${s.origin}' for comlink proxy`);return}const{id:a,type:i,path:c}=Object.assign({path:[]},s.data),o=(s.data.argumentList||[]).map(st);let u;try{const f=c.slice(0,-1).reduce((g,h)=>g[h],e),l=c.reduce((g,h)=>g[h],e);switch(i){case"GET":u=l;break;case"SET":f[c.slice(-1)[0]]=st(s.data.value),u=!0;break;case"APPLY":u=l.apply(f,o);break;case"CONSTRUCT":{const g=new l(...o);u=$s(g)}break;case"ENDPOINT":{const{port1:g,port2:h}=new MessageChannel;xe(e,h),u=Ns(g,[g])}break;case"RELEASE":u=void 0;break;default:return}}catch(f){u={value:f,[Dt]:0}}Promise.resolve(u).catch(f=>({value:f,[Dt]:0})).then(f=>{const[l,g]=Rt(f);t.postMessage(Object.assign(Object.assign({},l),{id:a}),g),i==="RELEASE"&&(t.removeEventListener("message",r),Nn(t),te in e&&typeof e[te]=="function"&&e[te]())}).catch(f=>{const[l,g]=Rt({value:new TypeError("Unserializable return value"),[Dt]:0});t.postMessage(Object.assign(Object.assign({},l),{id:a}),g)})}),t.start&&t.start()}function Ss(e){return e.constructor.name==="MessagePort"}function Nn(e){Ss(e)&&e.close()}function Ds(e,t){const n=new Map;return e.addEventListener("message",function(s){const{data:a}=s;if(!a||!a.id)return;const i=n.get(a.id);if(i)try{i(a)}finally{n.delete(a.id)}}),le(e,n,[],t)}function dt(e){if(e)throw new Error("Proxy has been released and is not useable")}function $n(e){return gt(e,new Map,{type:"RELEASE"}).then(()=>{Nn(e)})}const Ft=new WeakMap,Ut="FinalizationRegistry"in globalThis&&new FinalizationRegistry(e=>{const t=(Ft.get(e)||0)-1;Ft.set(e,t),t===0&&$n(e)});function Ls(e,t){const n=(Ft.get(t)||0)+1;Ft.set(t,n),Ut&&Ut.register(e,t,e)}function Ms(e){Ut&&Ut.unregister(e)}function le(e,t,n=[],r=function(){}){let s=!1;const a=new Proxy(r,{get(i,c){if(dt(s),c===Cs)return()=>{Ms(a),$n(e),t.clear(),s=!0};if(c==="then"){if(n.length===0)return{then:()=>a};const o=gt(e,t,{type:"GET",path:n.map(u=>u.toString())}).then(st);return o.then.bind(o)}return le(e,t,[...n,c])},set(i,c,o){dt(s);const[u,f]=Rt(o);return gt(e,t,{type:"SET",path:[...n,c].map(l=>l.toString()),value:u},f).then(st)},apply(i,c,o){dt(s);const u=n[n.length-1];if(u===ws)return gt(e,t,{type:"ENDPOINT"}).then(st);if(u==="bind")return le(e,t,n.slice(0,-1));const[f,l]=Je(o);return gt(e,t,{type:"APPLY",path:n.map(g=>g.toString()),argumentList:f},l).then(st)},construct(i,c){dt(s);const[o,u]=Je(c);return gt(e,t,{type:"CONSTRUCT",path:n.map(f=>f.toString()),argumentList:o},u).then(st)}});return Ls(a,e),a}function ks(e){return Array.prototype.concat.apply([],e)}function Je(e){const t=e.map(Rt);return[t.map(n=>n[0]),ks(t.map(n=>n[1]))]}const Vn=new WeakMap;function Ns(e,t){return Vn.set(e,t),e}function $s(e){return Object.assign(e,{[Ln]:!0})}function Rt(e){for(const[t,n]of kn)if(n.canHandle(e)){const[r,s]=n.serialize(e);return[{type:"HANDLER",name:t,value:r},s]}return[{type:"RAW",value:e},Vn.get(e)||[]]}function st(e){switch(e.type){case"HANDLER":return kn.get(e.name).deserialize(e.value);case"RAW":return e.value}}function gt(e,t,n,r){return new Promise(s=>{const a=Vs();t.set(a,s),e.start&&e.start(),e.postMessage(Object.assign({id:a},n),r)})}function Vs(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}var ot=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};function _n(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function _s(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var n=function r(){return this instanceof r?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var s=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(n,r,s.get?s:{enumerable:!0,get:function(){return e[r]}})}),n}var Fs=function e(t,n){if(t===n)return!0;if(t&&n&&typeof t=="object"&&typeof n=="object"){if(t.constructor!==n.constructor)return!1;var r,s,a;if(Array.isArray(t)){if(r=t.length,r!=n.length)return!1;for(s=r;s--!==0;)if(!e(t[s],n[s]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if(a=Object.keys(t),r=a.length,r!==Object.keys(n).length)return!1;for(s=r;s--!==0;)if(!Object.prototype.hasOwnProperty.call(n,a[s]))return!1;for(s=r;s--!==0;){var i=a[s];if(!e(t[i],n[i]))return!1}return!0}return t!==t&&n!==n},Us=_n(Fs),qe=Object.prototype.toString,Fn=function(t){var n=qe.call(t),r=n==="[object Arguments]";return r||(r=n!=="[object Array]"&&t!==null&&typeof t=="object"&&typeof t.length=="number"&&t.length>=0&&qe.call(t.callee)==="[object Function]"),r},ee,Qe;function Rs(){if(Qe)return ee;Qe=1;var e;if(!Object.keys){var t=Object.prototype.hasOwnProperty,n=Object.prototype.toString,r=Fn,s=Object.prototype.propertyIsEnumerable,a=!s.call({toString:null},"toString"),i=s.call(function(){},"prototype"),c=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],o=function(g){var h=g.constructor;return h&&h.prototype===g},u={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},f=function(){if(typeof window>"u")return!1;for(var g in window)try{if(!u["$"+g]&&t.call(window,g)&&window[g]!==null&&typeof window[g]=="object")try{o(window[g])}catch{return!0}}catch{return!0}return!1}(),l=function(g){if(typeof window>"u"||!f)return o(g);try{return o(g)}catch{return!1}};e=function(h){var y=h!==null&&typeof h=="object",p=n.call(h)==="[object Function]",m=r(h),C=y&&n.call(h)==="[object String]",E=[];if(!y&&!p&&!m)throw new TypeError("Object.keys called on a non-object");var v=i&&p;if(C&&h.length>0&&!t.call(h,0))for(var d=0;d<h.length;++d)E.push(String(d));if(m&&h.length>0)for(var O=0;O<h.length;++O)E.push(String(O));else for(var w in h)!(v&&w==="prototype")&&t.call(h,w)&&E.push(String(w));if(a)for(var x=l(h),T=0;T<c.length;++T)!(x&&c[T]==="constructor")&&t.call(h,c[T])&&E.push(c[T]);return E}}return ee=e,ee}var js=Array.prototype.slice,Is=Fn,Ze=Object.keys,Lt=Ze?function(t){return Ze(t)}:Rs(),Pe=Object.keys;Lt.shim=function(){if(Object.keys){var t=function(){var n=Object.keys(arguments);return n&&n.length===arguments.length}(1,2);t||(Object.keys=function(r){return Is(r)?Pe(js.call(r)):Pe(r)})}else Object.keys=Lt;return Object.keys||Lt};var zs=Lt,Mt=Object.defineProperty||!1;if(Mt)try{Mt({},"a",{value:1})}catch{Mt=!1}var Un=Mt,As=SyntaxError,bs=TypeError,Bs=Object.getOwnPropertyDescriptor,kt=Bs;if(kt)try{kt([],"length")}catch{kt=null}var Ks=kt,tn=Un,Gs=As,ft=bs,en=Ks,Ws=function(t,n,r){if(!t||typeof t!="object"&&typeof t!="function")throw new ft("`obj` must be an object or a function`");if(typeof n!="string"&&typeof n!="symbol")throw new ft("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new ft("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new ft("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new ft("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new ft("`loose`, if provided, must be a boolean");var s=arguments.length>3?arguments[3]:null,a=arguments.length>4?arguments[4]:null,i=arguments.length>5?arguments[5]:null,c=arguments.length>6?arguments[6]:!1,o=!!en&&en(t,n);if(tn)tn(t,n,{configurable:i===null&&o?o.configurable:!i,enumerable:s===null&&o?o.enumerable:!s,value:r,writable:a===null&&o?o.writable:!a});else if(c||!s&&!a&&!i)t[n]=r;else throw new Gs("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},ge=Un,Rn=function(){return!!ge};Rn.hasArrayLengthDefineBug=function(){if(!ge)return null;try{return ge([],"length",{value:1}).length!==1}catch{return!0}};var Hs=Rn,Xs=zs,Ys=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",Js=Object.prototype.toString,qs=Array.prototype.concat,nn=Ws,Qs=function(e){return typeof e=="function"&&Js.call(e)==="[object Function]"},jn=Hs(),Zs=function(e,t,n,r){if(t in e){if(r===!0){if(e[t]===n)return}else if(!Qs(r)||!r())return}jn?nn(e,t,n,!0):nn(e,t,n)},In=function(e,t){var n=arguments.length>2?arguments[2]:{},r=Xs(t);Ys&&(r=qs.call(r,Object.getOwnPropertySymbols(t)));for(var s=0;s<r.length;s+=1)Zs(e,r[s],t[r[s]],n[r[s]])};In.supportsDescriptors=!!jn;var zn=In,Nt={exports:{}};typeof self<"u"?Nt.exports=self:typeof window<"u"?Nt.exports=window:Nt.exports=Function("return this")();var An=Nt.exports,Ps=An,bn=function(){return typeof globalThis!="object"||!globalThis||globalThis.Math!==Math||globalThis.Array!==Array?Ps:globalThis},ta=zn,ea=bn,na=function(){var t=ea();if(ta.supportsDescriptors){var n=Object.getOwnPropertyDescriptor(t,"globalThis");(!n||n.configurable&&(n.enumerable||!n.writable||globalThis!==t))&&Object.defineProperty(t,"globalThis",{configurable:!0,enumerable:!1,value:t,writable:!0})}else(typeof globalThis!="object"||globalThis!==t)&&(t.globalThis=t);return t},ra=zn,sa=An,Bn=bn,aa=na,ia=Bn(),Kn=function(){return ia};ra(Kn,{getPolyfill:Bn,implementation:sa,shim:aa});var oa=Kn,ca=_n(oa);const W=ca(),Gn={vtkObject:()=>null};function H(e){if(e==null||e.isA)return e;if(!e.vtkClass)return W.console&&W.console.error&&W.console.error("Invalid VTK object"),null;const t=Gn[e.vtkClass];if(!t)return W.console&&W.console.error&&W.console.error(`No vtk class found for Object of type ${e.vtkClass}`),null;const n={...e};Object.keys(n).forEach(s=>{n[s]&&typeof n[s]=="object"&&n[s].vtkClass&&(n[s]=H(n[s]))});const r=t(n);return r&&r.modified&&r.modified(),r}function ua(e,t){Gn[e]=t}H.register=ua;class ne extends Array{push(){for(let t=0;t<arguments.length;t++)this.includes(arguments[t])||super.push(arguments[t]);return this.length}}let he=0;const Wn=Symbol("void");function fa(){return he}const Hn={};function at(){}const la=["log","debug","info","warn","error","time","timeEnd","group","groupEnd"];la.forEach(e=>{Hn[e]=at});W.console=console.hasOwnProperty("log")?console:Hn;const et={debug:at,error:W.console.error||at,info:W.console.info||at,log:W.console.log||at,warn:W.console.warn||at};function Xn(e,t){et[e]&&(et[e]=t||at)}function Yn(){et.log(...arguments)}function Jn(){et.info(...arguments)}function jt(){et.debug(...arguments)}function j(){et.error(...arguments)}function Ee(){et.warn(...arguments)}const rn={};function qn(e){rn[e]||(et.error(e),rn[e]=!0)}const A=Object.create(null);A.Float32Array=Float32Array;A.Float64Array=Float64Array;A.Uint8Array=Uint8Array;A.Int8Array=Int8Array;A.Uint16Array=Uint16Array;A.Int16Array=Int16Array;A.Uint32Array=Uint32Array;A.Int32Array=Int32Array;A.Uint8ClampedArray=Uint8ClampedArray;try{A.BigInt64Array=BigInt64Array,A.BigUint64Array=BigUint64Array}catch{}function Gt(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return new(A[e]||Float64Array)(...n)}function Wt(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return(A[e]||Float64Array).from(...n)}function Ht(e){return e.charAt(0).toUpperCase()+e.slice(1)}function R(e){return Ht(e[0]==="_"?e.slice(1):e)}function Qn(e){return e.charAt(0).toLowerCase()+e.slice(1)}function Zn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1e3;const r=["TB","GB","MB","KB"];let s=Number(e),a="B";for(;s>n;)s/=n,a=r.pop();return`${s.toFixed(t)} ${a}`}function Pn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";const n=[];let r=e;for(;r>1e3;)n.push(`000${r%1e3}`.slice(-3)),r=Math.floor(r/1e3);return r>0&&n.push(r),n.reverse(),n.join(t)}function tr(e){Object.keys(e).forEach(t=>{Array.isArray(e[t])&&(e[t]=[].concat(e[t]))})}function ga(e){return Object.values(A).some(t=>e instanceof t)}function ha(e,t){if(e===t)return!0;if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}return!1}function ya(e,t){return Object.keys(e).find(n=>e[n]===t)}function er(e){return e&&e.isA?e.getState():e}function Se(e){setTimeout(e,0)}function nr(e,t){const n=performance.now();e.finally(()=>{const r=performance.now()-n;t(r)})}function Xt(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};tr(t);const n=[];if(Number.isInteger(t.mtime)||(t.mtime=++he),!("classHierarchy"in t))t.classHierarchy=new ne("vtkObject");else if(!(t.classHierarchy instanceof ne)){const a=new ne;for(let i=0;i<t.classHierarchy.length;i++)a.push(t.classHierarchy[i]);t.classHierarchy=a}function r(a){n[a]=null}function s(a){function i(){r(a)}return Object.freeze({unsubscribe:i})}return e.isDeleted=()=>!!t.deleted,e.modified=a=>{if(t.deleted){j("instance deleted - cannot call any method");return}a&&a<e.getMTime()||(t.mtime=++he,n.forEach(i=>i&&i(e)))},e.onModified=a=>{if(t.deleted)return j("instance deleted - cannot call any method"),null;const i=n.length;return n.push(a),s(i)},e.getMTime=()=>t.mtime,e.isA=a=>{let i=t.classHierarchy.length;for(;i--;)if(t.classHierarchy[i]===a)return!0;return!1},e.getClassName=function(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return t.classHierarchy[t.classHierarchy.length-1-a]},e.set=function(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=!1;return Object.keys(a).forEach(u=>{const f=c?null:e[`set${Ht(u)}`];f&&Array.isArray(a[u])&&f.length>1?o=f(...a[u])||o:f?o=f(a[u])||o:(["mtime"].indexOf(u)===-1&&!i&&Ee(`Warning: Set value to model directly ${u}, ${a[u]}`),o=t[u]!==a[u]||o,t[u]=a[u])}),o},e.get=function(){for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];if(!i.length)return t;const o={};return i.forEach(u=>{o[u]=t[u]}),o},e.getReferenceByName=a=>t[a],e.delete=()=>{Object.keys(t).forEach(a=>delete t[a]),n.forEach((a,i)=>r(i)),t.deleted=!0},e.getState=()=>{if(t.deleted)return null;const a={...t,vtkClass:e.getClassName()};Object.keys(a).forEach(c=>{a[c]===null||a[c]===void 0||c[0]==="_"?delete a[c]:a[c].isA?a[c]=a[c].getState():Array.isArray(a[c])?a[c]=a[c].map(er):ga(a[c])&&(a[c]=Array.from(a[c]))});const i={};return Object.keys(a).sort().forEach(c=>{i[c]=a[c]}),i.mtime&&delete i.mtime,i},e.shallowCopy=function(a){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(a.getClassName()!==e.getClassName())throw new Error(`Cannot ShallowCopy ${a.getClassName()} into ${e.getClassName()}`);const c=a.get(),o=Object.keys(t).sort();Object.keys(c).sort().forEach(f=>{const l=o.indexOf(f);l===-1?i&&jt(`add ${f} in shallowCopy`):o.splice(l,1),t[f]=c[f]}),o.length&&i&&jt(`Untouched keys: ${o.join(", ")}`),e.modified()},e.toJSON=function(){return e.getState()},e}const pa={object(e,t,n){return function(){return{...t[n.name]}}}};function vt(e,t,n){n.forEach(r=>{if(typeof r=="object"){const s=pa[r.type];s?e[`get${R(r.name)}`]=s(e,t,r):e[`get${R(r.name)}`]=()=>t[r.name]}else e[`get${R(r)}`]=()=>t[r]})}const va={enum(e,t,n){const r=`_on${R(n.name)}Changed`;return s=>{if(typeof s=="string"){if(n.enum[s]!==void 0)return t[n.name]!==n.enum[s]?(t[n.name]=n.enum[s],e.modified(),!0):!1;throw j(`Set Enum with invalid argument ${n}, ${s}`),new RangeError("Set Enum with invalid string argument")}if(typeof s=="number"){if(t[n.name]!==s){if(Object.keys(n.enum).map(a=>n.enum[a]).indexOf(s)!==-1){const a=t[n.name];return t[n.name]=s,t[r]?.(e,t,s,a),e.modified(),!0}throw j(`Set Enum outside numeric range ${n}, ${s}`),new RangeError("Set Enum outside numeric range")}return!1}throw j(`Set Enum with invalid argument (String/Number) ${n}, ${s}`),new TypeError("Set Enum with invalid argument (String/Number)")}},object(e,t,n){const r=`_on${R(n.name)}Changed`;return s=>{if(!Us(t[n.name],s)){const a=t[n.name];return t[n.name]=s,t[r]?.(e,t,s,a),e.modified(),!0}return!1}}};function sn(e){if(typeof e=="object"){const t=va[e.type];if(t)return(n,r)=>t(n,r,e);throw j(`No setter for field ${e}`),new TypeError("No setter for field")}return function(n,r){const s=`_on${R(e)}Changed`;return function(i){if(r.deleted)return j("instance deleted - cannot call any method"),!1;if(r[e]!==i){const c=r[e.name];return r[e]=i,r[s]?.(n,r,i,c),n.modified(),!0}return!1}}}function Yt(e,t,n){n.forEach(r=>{typeof r=="object"?e[`set${R(r.name)}`]=sn(r)(e,t):e[`set${R(r)}`]=sn(r)(e,t)})}function Jt(e,t,n){vt(e,t,n),Yt(e,t,n)}function De(e,t,n){n.forEach(r=>{e[`get${R(r)}`]=()=>t[r]?Array.from(t[r]):t[r],e[`get${R(r)}ByReference`]=()=>t[r]})}function Le(e,t,n,r){let s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:void 0;n.forEach(a=>{if(t[a]&&r&&t[a].length!==r)throw new RangeError(`Invalid initial number of values for array (${a})`);const i=`_on${R(a)}Changed`;e[`set${R(a)}`]=function(){if(t.deleted)return j("instance deleted - cannot call any method"),!1;for(var c=arguments.length,o=new Array(c),u=0;u<c;u++)o[u]=arguments[u];let f=o,l,g=!1;if(f.length===1&&(f[0]==null||f[0].length>=0)&&(f=f[0],g=!0),f==null)l=t[a]!==f;else{if(r&&f.length!==r)if(f.length<r&&s!==void 0)for(f=Array.from(f),g=!1;f.length<r;)f.push(s);else throw new RangeError(`Invalid number of values for array setter (${a})`);l=t[a]==null||t[a].length!==f.length;for(let h=0;!l&&h<f.length;++h)l=t[a][h]!==f[h];l&&g&&(f=Array.from(f))}if(l){const h=t[a.name];t[a]=f,t[i]?.(e,t,f,h),e.modified()}return l},e[`set${R(a)}From`]=c=>{const o=t[a];c.forEach((u,f)=>{o[f]=u})}})}function rr(e,t,n,r){let s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:void 0;De(e,t,n),Le(e,t,n,r,s)}function sr(e,t,n){for(let r=0;r<n.length;r++){const s=n[r];t[s]!==void 0&&(t[`_${s}`]=t[s],delete t[s])}}function Me(e,t,n,r){t.inputData?t.inputData=t.inputData.map(H):t.inputData=[],t.inputConnection?t.inputConnection=t.inputConnection.map(H):t.inputConnection=[],t.output?t.output=t.output.map(H):t.output=[],t.inputArrayToProcess?t.inputArrayToProcess=t.inputArrayToProcess.map(H):t.inputArrayToProcess=[],t.numberOfInputs=n;function s(h){let y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(t.deleted){j("instance deleted - cannot call any method");return}if(y>=t.numberOfInputs){j(`algorithm ${e.getClassName()} only has ${t.numberOfInputs} input ports. To add more input ports, use addInputData()`);return}(t.inputData[y]!==h||t.inputConnection[y])&&(t.inputData[y]=h,t.inputConnection[y]=null,e.modified&&e.modified())}function a(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return t.inputConnection[h]&&(t.inputData[h]=t.inputConnection[h]()),t.inputData[h]}function i(h){let y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(t.deleted){j("instance deleted - cannot call any method");return}if(y>=t.numberOfInputs){let p=`algorithm ${e.getClassName()} only has `;p+=`${t.numberOfInputs}`,p+=" input ports. To add more input ports, use addInputConnection()",j(p);return}t.inputData[y]=null,t.inputConnection[y]=h}function c(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return t.inputConnection[h]}function o(){let h=t.numberOfInputs;for(;h&&!t.inputData[h-1]&&!t.inputConnection[h-1];)h--;return h===t.numberOfInputs&&t.numberOfInputs++,h}function u(h){if(t.deleted){j("instance deleted - cannot call any method");return}i(h,o())}function f(h){if(t.deleted){j("instance deleted - cannot call any method");return}s(h,o())}function l(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return t.deleted?(j("instance deleted - cannot call any method"),null):(e.shouldUpdate()&&e.update(),t.output[h])}e.shouldUpdate=()=>{const h=e.getMTime();let y=1/0,p=r;for(;p--;){if(!t.output[p]||t.output[p].isDeleted())return!0;const m=t.output[p].getMTime();if(m<h)return!0;m<y&&(y=m)}for(p=t.numberOfInputs;p--;)if(t.inputConnection[p]?.filter.shouldUpdate()||e.getInputData(p)?.getMTime()>y)return!0;return!1};function g(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;const y=()=>l(h);return y.filter=e,y}if(t.numberOfInputs){let h=t.numberOfInputs;for(;h--;)t.inputData.push(null),t.inputConnection.push(null);e.setInputData=s,e.setInputConnection=i,e.addInputData=f,e.addInputConnection=u,e.getInputData=a,e.getInputConnection=c}r&&(e.getOutputData=l,e.getOutputPort=g),e.update=()=>{const h=[];if(t.numberOfInputs){let y=0;for(;y<t.numberOfInputs;)h[y]=e.getInputData(y),y++}e.shouldUpdate()&&e.requestData&&e.requestData(h,t.output)},e.getNumberOfInputPorts=()=>t.numberOfInputs,e.getNumberOfOutputPorts=()=>r||t.output.length,e.getInputArrayToProcess=h=>{const y=t.inputArrayToProcess[h],p=t.inputData[h];return y&&p?p[`get${y.fieldAssociation}`]().getArray(y.arrayName):null},e.setInputArrayToProcess=function(h,y,p){let m=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"Scalars";for(;t.inputArrayToProcess.length<h;)t.inputArrayToProcess.push(null);t.inputArrayToProcess[h]={arrayName:y,fieldAssociation:p,attributeType:m}}}const ke=Symbol("Event abort");function ar(e,t,n){const r=[],s=e.delete;let a=1;function i(u){for(let f=0;f<r.length;++f){const[l]=r[f];if(l===u){r.splice(f,1);return}}}function c(u){function f(){i(u)}return Object.freeze({unsubscribe:f})}function o(){if(t.deleted){j("instance deleted - cannot call any method");return}const u=r.slice();for(let f=0;f<u.length;++f){const[,l,g]=u[f];if(l){if(g<0)setTimeout(()=>l.apply(e,arguments),1-g);else if(l.apply(e,arguments)===ke)break}}}e[`invoke${R(n)}`]=o,e[`on${R(n)}`]=function(u){let f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(!u.apply)return console.error(`Invalid callback for event ${n}`),null;if(t.deleted)return j("instance deleted - cannot call any method"),null;const l=a++;return r.push([l,u,f]),r.sort((g,h)=>h[2]-g[2]),c(l)},e.delete=()=>{s(),r.forEach(u=>{let[f]=u;return i(f)})}}function qt(e,t){const n=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const s={},a={};return e(a,s,r),Object.freeze(a)};return t&&H.register(t,n),n}function ir(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(){for(var r=arguments.length,s=new Array(r),a=0;a<r;a++)s[a]=arguments[a];return t.filter(i=>!!i).map(i=>i(...s))}}function Ne(e){return e&&e.isA&&e.isA("vtkObject")}function It(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[];if(Ne(e)){if(r.indexOf(e)>=0)return n;r.push(e);const s=t(e);s!==void 0&&n.push(s);const a=e.get();Object.keys(a).forEach(i=>{const c=a[i];Array.isArray(c)?c.forEach(o=>{It(o,t,n,r)}):It(c,t,n,r)})}return n}function or(e,t,n){var r=this;let s;const a=function(){for(var i=arguments.length,c=new Array(i),o=0;o<i;o++)c[o]=arguments[o];const u=r,f=()=>{s=null,n||e.apply(u,c)},l=n&&!s;clearTimeout(s),s=setTimeout(f,t),l&&e.apply(u,c)};return a.cancel=()=>clearTimeout(s),a}function cr(e,t){let n=!1,r=null;function s(){n=!1,r!==null&&(a(...r),r=null)}function a(){for(var i=arguments.length,c=new Array(i),o=0;o<i;o++)c[o]=arguments[o];if(n){r=c;return}n=!0,e(...c),setTimeout(s,t)}return a}function $e(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};t.keystore=Object.assign(t.keystore||{},n),e.setKey=(r,s)=>{t.keystore[r]=s},e.getKey=r=>t.keystore[r],e.getAllKeys=()=>Object.keys(t.keystore),e.deleteKey=r=>delete t.keystore[r],e.clearKeystore=()=>e.getAllKeys().forEach(r=>delete t.keystore[r])}let ma=1;const Tt="__root__";function ur(e,t){$e(e,t);const n=e.delete;t.proxyId=`${ma++}`,t.ui=JSON.parse(JSON.stringify(t.ui||[])),vt(e,t,["proxyId","proxyGroup","proxyName"]),Jt(e,t,["proxyManager"]);const r={},s={};function a(u,f){s[f]||(s[f]=[]);const l=s[f];for(let g=0;g<u.length;g++)l.push(u[g].name),r[u[g].name]=u[g],u[g].children&&u[g].children.length&&a(u[g].children,u[g].name)}a(t.ui,Tt),e.updateUI=u=>{t.ui=JSON.parse(JSON.stringify(u||[])),Object.keys(r).forEach(f=>delete r[f]),Object.keys(s).forEach(f=>delete s[f]),a(t.ui,Tt),e.modified()};function i(){let u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Tt;return s[u]}e.updateProxyProperty=(u,f)=>{const l=r[u];l?Object.assign(l,f):r[u]={...f}},e.activate=()=>{if(t.proxyManager){const u=`setActive${R(e.getProxyGroup().slice(0,-1))}`;t.proxyManager[u]&&t.proxyManager[u](e)}},t.propertyLinkSubscribers={},e.registerPropertyLinkForGC=(u,f)=>{f in t.propertyLinkSubscribers||(t.propertyLinkSubscribers[f]=[]),t.propertyLinkSubscribers[f].push(u)},e.gcPropertyLinks=u=>{const f=t.propertyLinkSubscribers[u]||[];for(;f.length;)f.pop().unbind(e)},t.propertyLinkMap={},e.getPropertyLink=function(u){let f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(t.propertyLinkMap[u])return t.propertyLinkMap[u];let l=null;const g=[];let h=0,y=!1;function p(d){let O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(y)return null;const w=[];let x=null;for(h=g.length;h--;){const L=g[h];L.instance===d?x=L:w.push(L)}if(!x)return null;const T=x.instance[`get${R(x.propertyName)}`]();if(!ha(T,l)||O){for(l=T,y=!0;w.length;){const L=w.pop();L.instance.set({[L.propertyName]:l})}y=!1}return t.propertyLinkMap[u].persistent&&(t.propertyLinkMap[u].value=T),T}function m(d,O){const w=[];for(h=g.length;h--;){const x=g[h];x.instance===d&&(x.propertyName===O||O===void 0)&&(x.subscription.unsubscribe(),w.push(h))}for(;w.length;)g.splice(w.pop(),1)}function C(d,O){let w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const x=d.onModified(p),T=g[0];return g.push({instance:d,propertyName:O,subscription:x}),w&&(t.propertyLinkMap[u].persistent&&t.propertyLinkMap[u].value!==void 0?d.set({[O]:t.propertyLinkMap[u].value}):T&&p(T.instance,!0)),{unsubscribe:()=>m(d,O)}}function E(){for(;g.length;)g.pop().subscription.unsubscribe()}const v={bind:C,unbind:m,unsubscribe:E,persistent:f};return t.propertyLinkMap[u]=v,v};function c(){let u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Tt;const f=[],l=t.proxyId,g=i(u)||[];for(let h=0;h<g.length;h++){const y=g[h],p=e[`get${R(y)}`],m=p?p():void 0,C={id:l,name:y,value:m},E=c(y);E.length&&(C.children=E),f.push(C)}return f}e.listPropertyNames=()=>c().map(u=>u.name),e.getPropertyByName=u=>c().find(f=>f.name===u),e.getPropertyDomainByName=u=>(r[u]||{}).domain,e.getProxySection=()=>({id:t.proxyId,name:t.proxyGroup,ui:t.ui,properties:c()}),e.delete=()=>{const u=Object.keys(t.propertyLinkMap);let f=u.length;for(;f--;)t.propertyLinkMap[u[f]].unsubscribe();Object.keys(t.propertyLinkSubscribers).forEach(e.gcPropertyLinks),n()},e.getState=()=>null;function o(){if(t.links)for(let u=0;u<t.links.length;u++){const{link:f,property:l,persistent:g,updateOnBind:h,type:y}=t.links[u];if(y==="application"){const p=t.proxyManager.getPropertyLink(f,g);e.registerPropertyLinkForGC(p,"application"),p.bind(e,l,h)}}}Se(o)}function fr(e,t,n){const r=e.delete,s=[],a=Object.keys(n);let i=a.length;for(;i--;){const c=a[i],{modelKey:o,property:u,modified:f=!0}=n[c],l=R(u),g=R(c);e[`get${g}`]=t[o][`get${l}`],e[`set${g}`]=t[o][`set${l}`],f&&s.push(t[o].onModified(e.modified))}e.delete=()=>{for(;s.length;)s.pop().unsubscribe();r()}}function lr(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};t.this=e;function s(c){const o=Object.keys(c);let u=o.length;for(;u--;){const f=o[u];t[f].set(c[f])}}const a=Object.keys(r);let i=a.length;for(;i--;){const c=a[i];t[c]=r[c];const o=n[c];e[`set${R(c)}`]=u=>{if(u!==t[c]){t[c]=u;const f=o[u];s(f),e.modified()}}}a.length&&vt(e,t,a)}const an=10,on=40,cn=800;function gr(e){let t=0,n=0,r=0,s=0;return"detail"in e&&(n=e.detail),"wheelDelta"in e&&(n=-e.wheelDelta/120),"wheelDeltaY"in e&&(n=-e.wheelDeltaY/120),"wheelDeltaX"in e&&(t=-e.wheelDeltaX/120),"axis"in e&&e.axis===e.HORIZONTAL_AXIS&&(t=n,n=0),r=t*an,s=n*an,"deltaY"in e&&(s=e.deltaY),"deltaX"in e&&(r=e.deltaX),(r||s)&&e.deltaMode&&(e.deltaMode===1?(r*=on,s*=on):(r*=cn,s*=cn)),r&&!t&&(t=r<1?-1:1),s&&!n&&(n=s<1?-1:1),{spinX:t,spinY:n||t,pixelX:r,pixelY:s||r}}var N={algo:Me,capitalize:Ht,chain:ir,debounce:or,enumToString:ya,event:ar,EVENT_ABORT:ke,formatBytesToProperUnit:Zn,formatNumbersWithThousandSeparator:Pn,get:vt,getArray:De,getCurrentGlobalMTime:fa,getStateArrayMapFunc:er,isVtkObject:Ne,keystore:$e,measurePromiseExecution:nr,moveToProtected:sr,newInstance:qt,newTypedArray:Gt,newTypedArrayFrom:Wt,normalizeWheel:gr,obj:Xt,proxy:ur,proxyPropertyMapping:fr,proxyPropertyState:lr,safeArrays:tr,set:Yt,setArray:Le,setGet:Jt,setGetArray:rr,setImmediate:Se,setLoggerFunction:Xn,throttle:cr,traverseInstanceTree:It,TYPED_ARRAYS:A,uncapitalize:Qn,VOID:Wn,vtkDebugMacro:jt,vtkErrorMacro:j,vtkInfoMacro:Jn,vtkLogMacro:Yn,vtkOnceErrorMacro:qn,vtkWarningMacro:Ee},hr=Object.freeze({__proto__:null,VOID:Wn,setLoggerFunction:Xn,vtkLogMacro:Yn,vtkInfoMacro:Jn,vtkDebugMacro:jt,vtkErrorMacro:j,vtkWarningMacro:Ee,vtkOnceErrorMacro:qn,TYPED_ARRAYS:A,newTypedArray:Gt,newTypedArrayFrom:Wt,capitalize:Ht,_capitalize:R,uncapitalize:Qn,formatBytesToProperUnit:Zn,formatNumbersWithThousandSeparator:Pn,setImmediateVTK:Se,measurePromiseExecution:nr,obj:Xt,get:vt,set:Yt,setGet:Jt,getArray:De,setArray:Le,setGetArray:rr,moveToProtected:sr,algo:Me,EVENT_ABORT:ke,event:ar,newInstance:qt,chain:ir,isVtkObject:Ne,traverseInstanceTree:It,debounce:or,throttle:cr,keystore:$e,proxy:ur,proxyPropertyMapping:fr,proxyPropertyState:lr,normalizeWheel:gr,default:N}),Ve={exports:{}};Ve.exports;(function(e){(function(t,n,r){function s(o){var u=this,f=c();u.next=function(){var l=2091639*u.s0+u.c*23283064365386963e-26;return u.s0=u.s1,u.s1=u.s2,u.s2=l-(u.c=l|0)},u.c=1,u.s0=f(" "),u.s1=f(" "),u.s2=f(" "),u.s0-=f(o),u.s0<0&&(u.s0+=1),u.s1-=f(o),u.s1<0&&(u.s1+=1),u.s2-=f(o),u.s2<0&&(u.s2+=1),f=null}function a(o,u){return u.c=o.c,u.s0=o.s0,u.s1=o.s1,u.s2=o.s2,u}function i(o,u){var f=new s(o),l=u&&u.state,g=f.next;return g.int32=function(){return f.next()*4294967296|0},g.double=function(){return g()+(g()*2097152|0)*11102230246251565e-32},g.quick=g,l&&(typeof l=="object"&&a(l,f),g.state=function(){return a(f,{})}),g}function c(){var o=4022871197,u=function(f){f=String(f);for(var l=0;l<f.length;l++){o+=f.charCodeAt(l);var g=.02519603282416938*o;o=g>>>0,g-=o,g*=o,o=g>>>0,g-=o,o+=g*4294967296}return(o>>>0)*23283064365386963e-26};return u}n&&n.exports?n.exports=i:this.alea=i})(ot,e)})(Ve);var da=Ve.exports,_e={exports:{}};_e.exports;(function(e){(function(t,n,r){function s(c){var o=this,u="";o.x=0,o.y=0,o.z=0,o.w=0,o.next=function(){var l=o.x^o.x<<11;return o.x=o.y,o.y=o.z,o.z=o.w,o.w^=o.w>>>19^l^l>>>8},c===(c|0)?o.x=c:u+=c;for(var f=0;f<u.length+64;f++)o.x^=u.charCodeAt(f)|0,o.next()}function a(c,o){return o.x=c.x,o.y=c.y,o.z=c.z,o.w=c.w,o}function i(c,o){var u=new s(c),f=o&&o.state,l=function(){return(u.next()>>>0)/4294967296};return l.double=function(){do var g=u.next()>>>11,h=(u.next()>>>0)/4294967296,y=(g+h)/(1<<21);while(y===0);return y},l.int32=u.next,l.quick=l,f&&(typeof f=="object"&&a(f,u),l.state=function(){return a(u,{})}),l}n&&n.exports?n.exports=i:this.xor128=i})(ot,e)})(_e);var Ta=_e.exports,Fe={exports:{}};Fe.exports;(function(e){(function(t,n,r){function s(c){var o=this,u="";o.next=function(){var l=o.x^o.x>>>2;return o.x=o.y,o.y=o.z,o.z=o.w,o.w=o.v,(o.d=o.d+362437|0)+(o.v=o.v^o.v<<4^(l^l<<1))|0},o.x=0,o.y=0,o.z=0,o.w=0,o.v=0,c===(c|0)?o.x=c:u+=c;for(var f=0;f<u.length+64;f++)o.x^=u.charCodeAt(f)|0,f==u.length&&(o.d=o.x<<10^o.x>>>4),o.next()}function a(c,o){return o.x=c.x,o.y=c.y,o.z=c.z,o.w=c.w,o.v=c.v,o.d=c.d,o}function i(c,o){var u=new s(c),f=o&&o.state,l=function(){return(u.next()>>>0)/4294967296};return l.double=function(){do var g=u.next()>>>11,h=(u.next()>>>0)/4294967296,y=(g+h)/(1<<21);while(y===0);return y},l.int32=u.next,l.quick=l,f&&(typeof f=="object"&&a(f,u),l.state=function(){return a(u,{})}),l}n&&n.exports?n.exports=i:this.xorwow=i})(ot,e)})(Fe);var wa=Fe.exports,Ue={exports:{}};Ue.exports;(function(e){(function(t,n,r){function s(c){var o=this;o.next=function(){var f=o.x,l=o.i,g,h;return g=f[l],g^=g>>>7,h=g^g<<24,g=f[l+1&7],h^=g^g>>>10,g=f[l+3&7],h^=g^g>>>3,g=f[l+4&7],h^=g^g<<7,g=f[l+7&7],g=g^g<<13,h^=g^g<<9,f[l]=h,o.i=l+1&7,h};function u(f,l){var g,h=[];if(l===(l|0))h[0]=l;else for(l=""+l,g=0;g<l.length;++g)h[g&7]=h[g&7]<<15^l.charCodeAt(g)+h[g+1&7]<<13;for(;h.length<8;)h.push(0);for(g=0;g<8&&h[g]===0;++g);for(g==8?h[7]=-1:h[g],f.x=h,f.i=0,g=256;g>0;--g)f.next()}u(o,c)}function a(c,o){return o.x=c.x.slice(),o.i=c.i,o}function i(c,o){c==null&&(c=+new Date);var u=new s(c),f=o&&o.state,l=function(){return(u.next()>>>0)/4294967296};return l.double=function(){do var g=u.next()>>>11,h=(u.next()>>>0)/4294967296,y=(g+h)/(1<<21);while(y===0);return y},l.int32=u.next,l.quick=l,f&&(f.x&&a(f,u),l.state=function(){return a(u,{})}),l}n&&n.exports?n.exports=i:this.xorshift7=i})(ot,e)})(Ue);var Ca=Ue.exports,Re={exports:{}};Re.exports;(function(e){(function(t,n,r){function s(c){var o=this;o.next=function(){var f=o.w,l=o.X,g=o.i,h,y;return o.w=f=f+1640531527|0,y=l[g+34&127],h=l[g=g+1&127],y^=y<<13,h^=h<<17,y^=y>>>15,h^=h>>>12,y=l[g]=y^h,o.i=g,y+(f^f>>>16)|0};function u(f,l){var g,h,y,p,m,C=[],E=128;for(l===(l|0)?(h=l,l=null):(l=l+"\0",h=0,E=Math.max(E,l.length)),y=0,p=-32;p<E;++p)l&&(h^=l.charCodeAt((p+32)%l.length)),p===0&&(m=h),h^=h<<10,h^=h>>>15,h^=h<<4,h^=h>>>13,p>=0&&(m=m+1640531527|0,g=C[p&127]^=h+m,y=g==0?y+1:0);for(y>=128&&(C[(l&&l.length||0)&127]=-1),y=127,p=4*128;p>0;--p)h=C[y+34&127],g=C[y=y+1&127],h^=h<<13,g^=g<<17,h^=h>>>15,g^=g>>>12,C[y]=h^g;f.w=m,f.X=C,f.i=y}u(o,c)}function a(c,o){return o.i=c.i,o.w=c.w,o.X=c.X.slice(),o}function i(c,o){c==null&&(c=+new Date);var u=new s(c),f=o&&o.state,l=function(){return(u.next()>>>0)/4294967296};return l.double=function(){do var g=u.next()>>>11,h=(u.next()>>>0)/4294967296,y=(g+h)/(1<<21);while(y===0);return y},l.int32=u.next,l.quick=l,f&&(f.X&&a(f,u),l.state=function(){return a(u,{})}),l}n&&n.exports?n.exports=i:this.xor4096=i})(ot,e)})(Re);var Oa=Re.exports,je={exports:{}};je.exports;(function(e){(function(t,n,r){function s(c){var o=this,u="";o.next=function(){var l=o.b,g=o.c,h=o.d,y=o.a;return l=l<<25^l>>>7^g,g=g-h|0,h=h<<24^h>>>8^y,y=y-l|0,o.b=l=l<<20^l>>>12^g,o.c=g=g-h|0,o.d=h<<16^g>>>16^y,o.a=y-l|0},o.a=0,o.b=0,o.c=-1640531527,o.d=1367130551,c===Math.floor(c)?(o.a=c/4294967296|0,o.b=c|0):u+=c;for(var f=0;f<u.length+20;f++)o.b^=u.charCodeAt(f)|0,o.next()}function a(c,o){return o.a=c.a,o.b=c.b,o.c=c.c,o.d=c.d,o}function i(c,o){var u=new s(c),f=o&&o.state,l=function(){return(u.next()>>>0)/4294967296};return l.double=function(){do var g=u.next()>>>11,h=(u.next()>>>0)/4294967296,y=(g+h)/(1<<21);while(y===0);return y},l.int32=u.next,l.quick=l,f&&(typeof f=="object"&&a(f,u),l.state=function(){return a(u,{})}),l}n&&n.exports?n.exports=i:this.tychei=i})(ot,e)})(je);var xa=je.exports,yr={exports:{}},Ea={},Sa=Object.freeze({__proto__:null,default:Ea}),Da=_s(Sa);(function(e){(function(t,n,r){var s=256,a=6,i=52,c="random",o=r.pow(s,a),u=r.pow(2,i),f=u*2,l=s-1,g;function h(d,O,w){var x=[];O=O==!0?{entropy:!0}:O||{};var T=C(m(O.entropy?[d,v(n)]:d??E(),3),x),L=new y(x),S=function(){for(var M=L.g(a),k=o,$=0;M<u;)M=(M+$)*s,k*=s,$=L.g(1);for(;M>=f;)M/=2,k/=2,$>>>=1;return(M+$)/k};return S.int32=function(){return L.g(4)|0},S.quick=function(){return L.g(4)/4294967296},S.double=S,C(v(L.S),n),(O.pass||w||function(M,k,$,D){return D&&(D.S&&p(D,L),M.state=function(){return p(L,{})}),$?(r[c]=M,k):M})(S,T,"global"in O?O.global:this==r,O.state)}function y(d){var O,w=d.length,x=this,T=0,L=x.i=x.j=0,S=x.S=[];for(w||(d=[w++]);T<s;)S[T]=T++;for(T=0;T<s;T++)S[T]=S[L=l&L+d[T%w]+(O=S[T])],S[L]=O;(x.g=function(M){for(var k,$=0,D=x.i,_=x.j,F=x.S;M--;)k=F[D=l&D+1],$=$*s+F[l&(F[D]=F[_=l&_+k])+(F[_]=k)];return x.i=D,x.j=_,$})(s)}function p(d,O){return O.i=d.i,O.j=d.j,O.S=d.S.slice(),O}function m(d,O){var w=[],x=typeof d,T;if(O&&x=="object")for(T in d)try{w.push(m(d[T],O-1))}catch{}return w.length?w:x=="string"?d:d+"\0"}function C(d,O){for(var w=d+"",x,T=0;T<w.length;)O[l&T]=l&(x^=O[l&T]*19)+w.charCodeAt(T++);return v(O)}function E(){try{var d;return g&&(d=g.randomBytes)?d=d(s):(d=new Uint8Array(s),(t.crypto||t.msCrypto).getRandomValues(d)),v(d)}catch{var O=t.navigator,w=O&&O.plugins;return[+new Date,t,w,t.screen,v(n)]}}function v(d){return String.fromCharCode.apply(0,d)}if(C(r.random(),n),e.exports){e.exports=h;try{g=Da}catch{}}else r["seed"+c]=h})(typeof self<"u"?self:ot,[],Math)})(yr);var La=yr.exports,Ma=da,ka=Ta,Na=wa,$a=Ca,Va=Oa,_a=xa,yt=La;yt.alea=Ma;yt.xor128=ka;yt.xorwow=Na;yt.xorshift7=$a;yt.xor4096=Va;yt.tychei=_a;const Fa=1e-12,{vtkErrorMacro:sc,vtkWarningMacro:un}=N;function ye(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:3;const t=Array(e);for(let n=0;n<e;++n)t[n]=0;return t}function Ua(e,t,n){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n}function tt(e,t,n){return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n}function fn(e,t,n,r){return r[0]=e[0]+t[0]*n,r[1]=e[1]+t[1]*n,r[2]=e[2]+t[2]*n,r}function V(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function pr(e,t,n){const r=e[1]*t[2]-e[2]*t[1],s=e[2]*t[0]-e[0]*t[2],a=e[0]*t[1]-e[1]*t[0];return n[0]=r,n[1]=s,n[2]=a,n}function vr(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:3;switch(t){case 1:return Math.abs(e);case 2:return Math.sqrt(e[0]*e[0]+e[1]*e[1]);case 3:return Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);default:{let n=0;for(let r=0;r<t;r++)n+=e[r]*e[r];return Math.sqrt(n)}}}function Ra(e){const t=vr(e);return t!==0&&(e[0]/=t,e[1]/=t,e[2]/=t),t}function q(e,t){return(e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1])+(e[2]-t[2])*(e[2]-t[2])}function $t(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.length===2?t[0][0]*t[1][1]-t[1][0]*t[0][1]:t.length===4?t[0]*t[3]-t[1]*t[2]:Number.NaN}function re(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(!`${e}`.includes("e"))return+`${Math.round(`${e}e+${t}`)}e-${t}`;const n=`${e}`.split("e");let r="";return+n[1]+t>0&&(r="+"),+`${Math.round(`${+n[0]}e${r}${+n[1]+t}`)}e-${t}`}function ln(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return t[0]=re(e[0],n),t[1]=re(e[1],n),t[2]=re(e[2],n),t}function ja(e,t,n){let r,s,a,i,c=0,o,u,f;const l=ye(n);for(r=0;r<n;r++){for(i=0,s=0;s<n;s++)(f=Math.abs(e[r*n+s]))>i&&(i=f);if(i===0)return un("Unable to factor linear system"),0;l[r]=1/i}for(s=0;s<n;s++){for(r=0;r<s;r++){for(o=e[r*n+s],a=0;a<r;a++)o-=e[r*n+a]*e[a*n+s];e[r*n+s]=o}for(i=0,r=s;r<n;r++){for(o=e[r*n+s],a=0;a<s;a++)o-=e[r*n+a]*e[a*n+s];e[r*n+s]=o,(u=l[r]*Math.abs(o))>=i&&(i=u,c=r)}if(s!==c){for(a=0;a<n;a++)u=e[c*n+a],e[c*n+a]=e[s*n+a],e[s*n+a]=u;l[c]=l[s]}if(t[s]=c,Math.abs(e[s*n+s])<=Fa)return un("Unable to factor linear system"),0;if(s!==n-1)for(u=1/e[s*n+s],r=s+1;r<n;r++)e[r*n+s]*=u}return 1}function Ia(e,t,n,r){let s,a,i,c,o;for(i=-1,s=0;s<r;s++){if(c=t[s],o=n[c],n[c]=n[s],i>=0)for(a=i;a<=s-1;a++)o-=e[s*r+a]*n[a];else o!==0&&(i=s);n[s]=o}for(s=r-1;s>=0;s--){for(o=n[s],a=s+1;a<r;a++)o-=e[s*r+a]*n[a];n[s]=o/e[s*r+s]}}function za(e,t,n){if(n===2){const s=ye(2),a=$t(e[0],e[1],e[2],e[3]);return a===0?0:(s[0]=(e[3]*t[0]-e[1]*t[1])/a,s[1]=(-(e[2]*t[0])+e[0]*t[1])/a,t[0]=s[0],t[1]=s[1],1)}if(n===1)return e[0]===0?0:(t[0]/=e[0],1);const r=ye(n);return ja(e,r,n)===0?0:(Ia(e,r,t,n),1)}function Aa(e){return e[0]=1,e[1]=-1,e[2]=1,e[3]=-1,e[4]=1,e[5]=-1,e}function se(e,t,n){return e<t?t:e>n?n:e}function gn(e,t,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[0,0,0];return r[0]=se(e[0],t[0],n[0]),r[1]=se(e[1],t[1],n[1]),r[2]=se(e[2],t[2],n[2]),r}var mr=1e-6,Y=typeof Float32Array<"u"?Float32Array:Array;function ba(e,t){return Math.abs(e-t)<=mr*Math.max(1,Math.abs(e),Math.abs(t))}Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});function Ba(){var e=new Y(9);return Y!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function Ka(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function Ga(e,t){var n=t[0],r=t[1],s=t[2],a=t[3],i=t[4],c=t[5],o=t[6],u=t[7],f=t[8],l=t[9],g=t[10],h=t[11],y=t[12],p=t[13],m=t[14],C=t[15],E=n*c-r*i,v=n*o-s*i,d=n*u-a*i,O=r*o-s*c,w=r*u-a*c,x=s*u-a*o,T=f*p-l*y,L=f*m-g*y,S=f*C-h*y,M=l*m-g*p,k=l*C-h*p,$=g*C-h*m,D=E*$-v*k+d*M+O*S-w*L+x*T;return D?(D=1/D,e[0]=(c*$-o*k+u*M)*D,e[1]=(s*k-r*$-a*M)*D,e[2]=(p*x-m*w+C*O)*D,e[3]=(g*w-l*x-h*O)*D,e[4]=(o*S-i*$-u*L)*D,e[5]=(n*$-s*S+a*L)*D,e[6]=(m*d-y*x-C*v)*D,e[7]=(f*x-g*d+h*v)*D,e[8]=(i*k-c*S+u*T)*D,e[9]=(r*S-n*k-a*T)*D,e[10]=(y*w-p*d+C*E)*D,e[11]=(l*d-f*w-h*E)*D,e[12]=(c*L-i*M-o*T)*D,e[13]=(n*M-r*L+s*T)*D,e[14]=(p*v-y*O-m*E)*D,e[15]=(f*O-l*v+g*E)*D,e):null}function Wa(e,t,n){var r=n[0],s=n[1],a=n[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*s,e[5]=t[5]*s,e[6]=t[6]*s,e[7]=t[7]*s,e[8]=t[8]*a,e[9]=t[9]*a,e[10]=t[10]*a,e[11]=t[11]*a,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Ha(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function dr(){var e=new Y(3);return Y!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function ae(e){var t=new Y(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function Xa(e){var t=e[0],n=e[1],r=e[2];return Math.hypot(t,n,r)}function z(e,t,n){var r=new Y(3);return r[0]=e,r[1]=t,r[2]=n,r}function hn(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function ie(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e}function Ya(e,t){var n=t[0],r=t[1],s=t[2],a=n*n+r*r+s*s;return a>0&&(a=1/Math.sqrt(a)),e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a,e}function pe(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function oe(e,t,n){var r=t[0],s=t[1],a=t[2],i=n[0],c=n[1],o=n[2];return e[0]=s*o-a*c,e[1]=a*i-r*o,e[2]=r*c-s*i,e}function ve(e,t,n){var r=t[0],s=t[1],a=t[2],i=n[3]*r+n[7]*s+n[11]*a+n[15];return i=i||1,e[0]=(n[0]*r+n[4]*s+n[8]*a+n[12])/i,e[1]=(n[1]*r+n[5]*s+n[9]*a+n[13])/i,e[2]=(n[2]*r+n[6]*s+n[10]*a+n[14])/i,e}var Ja=Xa;(function(){var e=dr();return function(t,n,r,s,a,i){var c,o;for(n||(n=3),r||(r=0),s?o=Math.min(s*n+r,t.length):o=t.length,c=r;c<o;c+=n)e[0]=t[c],e[1]=t[c+1],e[2]=t[c+2],a(e,e,i),t[c]=e[0],t[c+1]=e[1],t[c+2]=e[2];return t}})();function qa(){var e=new Y(4);return Y!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function Qa(e,t){var n=t[0],r=t[1],s=t[2],a=t[3],i=n*n+r*r+s*s+a*a;return i>0&&(i=1/Math.sqrt(i)),e[0]=n*i,e[1]=r*i,e[2]=s*i,e[3]=a*i,e}(function(){var e=qa();return function(t,n,r,s,a,i){var c,o;for(n||(n=4),r||(r=0),s?o=Math.min(s*n+r,t.length):o=t.length,c=r;c<o;c+=n)e[0]=t[c],e[1]=t[c+1],e[2]=t[c+2],e[3]=t[c+3],a(e,e,i),t[c]=e[0],t[c+1]=e[1],t[c+2]=e[2],t[c+3]=e[3];return t}})();function yn(){var e=new Y(4);return Y!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function Za(e,t,n){n=n*.5;var r=Math.sin(n);return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=Math.cos(n),e}function Vt(e,t,n,r){var s=t[0],a=t[1],i=t[2],c=t[3],o=n[0],u=n[1],f=n[2],l=n[3],g,h,y,p,m;return h=s*o+a*u+i*f+c*l,h<0&&(h=-h,o=-o,u=-u,f=-f,l=-l),1-h>mr?(g=Math.acos(h),y=Math.sin(g),p=Math.sin((1-r)*g)/y,m=Math.sin(r*g)/y):(p=1-r,m=r),e[0]=p*s+m*o,e[1]=p*a+m*u,e[2]=p*i+m*f,e[3]=p*c+m*l,e}function Pa(e,t){var n=t[0]+t[4]+t[8],r;if(n>0)r=Math.sqrt(n+1),e[3]=.5*r,r=.5/r,e[0]=(t[5]-t[7])*r,e[1]=(t[6]-t[2])*r,e[2]=(t[1]-t[3])*r;else{var s=0;t[4]>t[0]&&(s=1),t[8]>t[s*3+s]&&(s=2);var a=(s+1)%3,i=(s+2)%3;r=Math.sqrt(t[s*3+s]-t[a*3+a]-t[i*3+i]+1),e[s]=.5*r,r=.5/r,e[3]=(t[a*3+i]-t[i*3+a])*r,e[a]=(t[a*3+s]+t[s*3+a])*r,e[i]=(t[i*3+s]+t[s*3+i])*r}return e}var Tr=Qa;(function(){var e=dr(),t=z(1,0,0),n=z(0,1,0);return function(r,s,a){var i=pe(s,a);return i<-.999999?(oe(e,t,s),Ja(e)<1e-6&&oe(e,n,s),Ya(e,e),Za(r,e,Math.PI),r):i>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(oe(e,s,a),r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=1+i,Tr(r,r))}})();(function(){var e=yn(),t=yn();return function(n,r,s,a,i,c){return Vt(e,r,i,c),Vt(t,s,a,c),Vt(n,e,t,2*c*(1-c)),n}})();(function(){var e=Ba();return function(t,n,r,s){return e[0]=r[0],e[3]=r[1],e[6]=r[2],e[1]=s[0],e[4]=s[1],e[7]=s[2],e[2]=-n[0],e[5]=-n[1],e[8]=-n[2],Tr(t,Pa(t,e))}})();const me=1e-6,wr="coincide",Cr="disjoint";function ti(e,t,n){return e[0]*(n[0]-t[0])+e[1]*(n[1]-t[1])+e[2]*(n[2]-t[2])}function Or(e,t,n){const r=n[0]*(e[0]-t[0])+n[1]*(e[1]-t[1])+n[2]*(e[2]-t[2]);return Math.abs(r)}function xr(e,t,n,r){const s=[];tt(e,t,s);const a=V(n,s);r[0]=e[0]-a*n[0],r[1]=e[1]-a*n[1],r[2]=e[2]-a*n[2]}function Er(e,t,n){const r=V(e,t);let s=V(t,t);return s===0&&(s=1),n[0]=e[0]-r*t[0]/s,n[1]=e[1]-r*t[1]/s,n[2]=e[2]-r*t[2]/s,n}function Sr(e,t,n,r){const s=[];tt(e,t,s);const a=V(n,s),i=V(n,n);i!==0?(r[0]=e[0]-a*n[0]/i,r[1]=e[1]-a*n[1]/i,r[2]=e[2]-a*n[2]/i):(r[0]=e[0],r[1]=e[1],r[2]=e[2])}function Dr(e,t,n,r){const s={intersection:!1,betweenPoints:!1,t:Number.MAX_VALUE,x:[]},a=[],i=[];tt(t,e,a),tt(n,e,i);const c=V(r,i),o=V(r,a);let u,f;return o<0?u=-o:u=o,c<0?f=-c*me:f=c*me,u<=f||(s.t=c/o,s.x[0]=e[0]+s.t*a[0],s.x[1]=e[1]+s.t*a[1],s.x[2]=e[2]+s.t*a[2],s.intersection=!0,s.betweenPoints=s.t>=0&&s.t<=1),s}function Lr(e,t,n,r){const s={intersection:!1,l0:[],l1:[],error:null},a=[];pr(t,r,a);const i=a.map(l=>Math.abs(l));if(i[0]+i[1]+i[2]<me){const l=[];return tt(e,n,l),V(t,l)===0?s.error=wr:s.error=Cr,s}let c;i[0]>i[1]&&i[0]>i[2]?c="x":i[1]>i[2]?c="y":c="z";const o=[],u=-V(t,e),f=-V(r,n);switch(c){case"x":o[0]=0,o[1]=(f*t[2]-u*r[2])/a[0],o[2]=(u*r[1]-f*t[1])/a[0];break;case"y":o[0]=(u*r[2]-f*t[2])/a[1],o[1]=0,o[2]=(f*t[0]-u*r[0])/a[1];break;case"z":o[0]=(f*t[1]-u*r[1])/a[2],o[1]=(u*r[0]-f*t[0])/a[2],o[2]=0;break}return s.l0=o,Ua(o,a,s.l1),s.intersection=!0,s}const ei={evaluate:ti,distanceToPlane:Or,projectPoint:xr,projectVector:Er,generalizedProjectPoint:Sr,intersectWithLine:Dr,intersectWithPlane:Lr,DISJOINT:Cr,COINCIDE:wr};function ni(e,t){t.classHierarchy.push("vtkPlane"),e.distanceToPlane=n=>Or(n,t.origin,t.normal),e.projectPoint=(n,r)=>{xr(n,t.origin,t.normal,r)},e.projectVector=(n,r)=>Er(n,t.normal,r),e.push=n=>{if(n!==0)for(let r=0;r<3;r++)t.origin[r]+=n*t.normal[r]},e.generalizedProjectPoint=(n,r)=>{Sr(n,t.origin,t.normal,r)},e.evaluateFunction=(n,r,s)=>Array.isArray(n)?t.normal[0]*(n[0]-t.origin[0])+t.normal[1]*(n[1]-t.origin[1])+t.normal[2]*(n[2]-t.origin[2]):t.normal[0]*(n-t.origin[0])+t.normal[1]*(r-t.origin[1])+t.normal[2]*(s-t.origin[2]),e.evaluateGradient=n=>[t.normal[0],t.normal[1],t.normal[2]],e.intersectWithLine=(n,r)=>Dr(n,r,t.origin,t.normal),e.intersectWithPlane=(n,r)=>Lr(n,r,t.origin,t.normal)}const ri={normal:[0,0,1],origin:[0,0,0]};function Mr(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(t,ri,n),N.obj(e,t),N.setGetArray(e,t,["normal","origin"],3),ni(e,t)}const si=N.newInstance(Mr,"vtkPlane");var it={newInstance:si,extend:Mr,...ei};const Qt=[Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE];function kr(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]}function Z(e){return e?.length>=6&&e[0]<=e[1]&&e[2]<=e[3]&&e[4]<=e[5]}function Ie(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function ze(e){return Ie(e,Qt)}function zt(e,t,n,r){const[s,a,i,c,o,u]=e;return e[0]=s<t?s:t,e[1]=a>t?a:t,e[2]=i<n?i:n,e[3]=c>n?c:n,e[4]=o<r?o:r,e[5]=u>r?u:r,e}function Ae(e,t){if(t.length===0)return e;if(Array.isArray(t[0]))for(let n=0;n<t.length;++n)zt(e,...t[n]);else for(let n=0;n<t.length;n+=3)zt(e,...t.slice(n,n+3));return e}function Nr(e,t,n,r,s,a,i){const[c,o,u,f,l,g]=e;return i===void 0?(e[0]=Math.min(t[0],c),e[1]=Math.max(t[1],o),e[2]=Math.min(t[2],u),e[3]=Math.max(t[3],f),e[4]=Math.min(t[4],l),e[5]=Math.max(t[5],g)):(e[0]=Math.min(t,c),e[1]=Math.max(n,o),e[2]=Math.min(r,u),e[3]=Math.max(s,f),e[4]=Math.min(a,l),e[5]=Math.max(i,g)),e}function $r(e,t,n,r){const[s,a,i,c,o,u]=e;return e[0]=t,e[1]=t>a?t:a,e[2]=n,e[3]=n>c?n:c,e[4]=r,e[5]=r>u?r:u,s!==t||i!==n||o!==r}function Vr(e,t,n,r){const[s,a,i,c,o,u]=e;return e[0]=t<s?t:s,e[1]=t,e[2]=n<i?n:i,e[3]=n,e[4]=r<o?r:o,e[5]=r,a!==t||c!==n||u!==r}function _r(e,t){return e[0]-=t,e[1]+=t,e[2]-=t,e[3]+=t,e[4]-=t,e[5]+=t,e}function be(e,t,n,r){return Z(e)?(t>=0?(e[0]*=t,e[1]*=t):(e[0]=t*e[1],e[1]=t*e[0]),n>=0?(e[2]*=n,e[3]*=n):(e[2]=n*e[3],e[3]=n*e[2]),r>=0?(e[4]*=r,e[5]*=r):(e[4]=r*e[5],e[5]=r*e[4]),!0):!1}function Be(e){return[.5*(e[0]+e[1]),.5*(e[2]+e[3]),.5*(e[4]+e[5])]}function ai(e,t,n,r){if(!Z(e))return!1;const s=Be(e);return e[0]-=s[0],e[1]-=s[0],e[2]-=s[1],e[3]-=s[1],e[4]-=s[2],e[5]-=s[2],be(e,t,n,r),e[0]+=s[0],e[1]+=s[0],e[2]+=s[1],e[3]+=s[1],e[4]+=s[2],e[5]+=s[2],!0}function pt(e,t){return e[t*2+1]-e[t*2]}function Zt(e){return[pt(e,0),pt(e,1),pt(e,2)]}function Fr(e){return e.slice(0,2)}function Ur(e){return e.slice(2,4)}function Rr(e){return e.slice(4,6)}function jr(e){const t=Zt(e);return t[0]>t[1]?t[0]>t[2]?t[0]:t[2]:t[1]>t[2]?t[1]:t[2]}function Ir(e){if(Z(e)){const t=Zt(e);return Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2])}return null}function Ke(e){return[e[0],e[2],e[4]]}function Ge(e){return[e[1],e[3],e[5]]}function wt(e,t){return e<=0&&t>=0||e>=0&&t<=0}function We(e,t){let n=0;for(let r=0;r<2;r++)for(let s=2;s<4;s++)for(let a=4;a<6;a++)t[n++]=[e[r],e[s],e[a]];return t}function zr(e,t,n){return t[0]=e[0],t[1]=e[2],t[2]=e[4],n[0]=e[1],n[1]=e[3],n[2]=e[5],t}function Ar(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const r=We(e,[]);for(let s=0;s<r.length;++s)ve(r[s],r[s],t);return ze(n),Ae(n,r)}function br(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return t[0]=.5*(e[1]-e[0]),t[1]=.5*(e[3]-e[2]),t[2]=.5*(e[5]-e[4]),t}function Br(e,t,n,r){const s=[].concat(Qt),a=e.getData();for(let i=0;i<a.length;i+=3){const c=[a[i],a[i+1],a[i+2]],o=V(c,t);s[0]=Math.min(o,s[0]),s[1]=Math.max(o,s[1]);const u=V(c,n);s[2]=Math.min(u,s[2]),s[3]=Math.max(u,s[3]);const f=V(c,r);s[4]=Math.min(f,s[4]),s[5]=Math.max(f,s[5])}return s}function Kr(e,t,n,r,s){let a=!0;const i=[];let c=0;const o=[],u=[0,0,0],f=0,l=1,g=2;for(let h=0;h<3;h++)t[h]<e[2*h]?(i[h]=l,u[h]=e[2*h],a=!1):t[h]>e[2*h+1]?(i[h]=f,u[h]=e[2*h+1],a=!1):i[h]=g;if(a)return r[0]=t[0],r[1]=t[1],r[2]=t[2],s[0]=0,1;for(let h=0;h<3;h++)i[h]!==g&&n[h]!==0?o[h]=(u[h]-t[h])/n[h]:o[h]=-1;for(let h=0;h<3;h++)o[c]<o[h]&&(c=h);if(o[c]>1||o[c]<0)return 0;s[0]=o[c];for(let h=0;h<3;h++)if(c!==h){if(r[h]=t[h]+o[c]*n[h],r[h]<e[2*h]||r[h]>e[2*h+1])return 0}else r[h]=u[h];return 1}function Gr(e,t,n){const r=[];let s=0,a=1,i=1;for(let c=4;c<=5;++c){r[2]=e[c];for(let o=2;o<=3;++o){r[1]=e[o];for(let u=0;u<=1;++u)if(r[0]=e[u],s=it.evaluate(n,t,r),i&&(a=s>=0?1:-1,i=0),s===0||a>0&&s<0||a<0&&s>0)return 1}}return 0}function Wr(e,t){if(!(Z(e)&&Z(t)))return!1;const n=[0,0,0,0,0,0];let r;for(let s=0;s<3;s++)if(r=!1,t[s*2]>=e[s*2]&&t[s*2]<=e[s*2+1]?(r=!0,n[s*2]=t[s*2]):e[s*2]>=t[s*2]&&e[s*2]<=t[s*2+1]&&(r=!0,n[s*2]=e[s*2]),t[s*2+1]>=e[s*2]&&t[s*2+1]<=e[s*2+1]?(r=!0,n[s*2+1]=t[2*s+1]):e[s*2+1]>=t[s*2]&&e[s*2+1]<=t[s*2+1]&&(r=!0,n[s*2+1]=e[s*2+1]),!r)return!1;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],!0}function At(e,t){if(!(Z(e)&&Z(t)))return!1;for(let n=0;n<3;n++)if(!(t[n*2]>=e[n*2]&&t[n*2]<=e[n*2+1])&&!(e[n*2]>=t[n*2]&&e[n*2]<=t[n*2+1])&&!(t[n*2+1]>=e[n*2]&&t[n*2+1]<=e[n*2+1])&&!(e[n*2+1]>=t[n*2]&&e[n*2+1]<=t[n*2+1]))return!1;return!0}function bt(e,t,n,r){return!(t<e[0]||t>e[1]||n<e[2]||n>e[3]||r<e[4]||r>e[5])}function ii(e,t){return!(!At(e,t)||!bt(e,...Ke(t))||!bt(e,...Ge(t)))}function Hr(e,t,n){const r=[[0,1,2,3,4,5,6,7],[0,1,4,5,2,3,6,7],[0,2,4,6,1,3,5,7]],s=[0,0,0,0,0,0,0,0];let a=0;for(let l=0;l<2;l++)for(let g=2;g<4;g++)for(let h=4;h<6;h++){const y=[e[l],e[g],e[h]];s[a++]=it.evaluate(n,t,y)}let i=2;for(;i--&&!(wt(s[r[i][0]],s[r[i][4]])&&wt(s[r[i][1]],s[r[i][5]])&&wt(s[r[i][2]],s[r[i][6]])&&wt(s[r[i][3]],s[r[i][7]])););if(i<0)return!1;const c=Math.sign(n[i]),o=Math.abs((e[i*2+1]-e[i*2])*n[i]);let u=c>0?1:0;for(let l=0;l<4;l++){if(o===0)continue;const g=Math.abs(s[r[i][l]])/o;c>0&&g<u&&(u=g),c<0&&g>u&&(u=g)}const f=(1-u)*e[i*2]+u*e[i*2+1];return c>0?e[i*2]=f:e[i*2+1]=f,!0}class oi{constructor(t){this.bounds=t,this.bounds||(this.bounds=new Float64Array(Qt))}getBounds(){return this.bounds}equals(t){return kr(this.bounds,t)}isValid(){return Z(this.bounds)}setBounds(t){return Ie(this.bounds,t)}reset(){return ze(this.bounds)}addPoint(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return zt(this.bounds,...n)}addPoints(t){return Ae(this.bounds,t)}addBounds(t,n,r,s,a,i){return Nr(this.bounds,t,n,r,s,a,i)}setMinPoint(t,n,r){return $r(this.bounds,t,n,r)}setMaxPoint(t,n,r){return Vr(this.bounds,t,n,r)}inflate(t){return _r(this.bounds,t)}scale(t,n,r){return be(this.bounds,t,n,r)}getCenter(){return Be(this.bounds)}getLength(t){return pt(this.bounds,t)}getLengths(){return Zt(this.bounds)}getMaxLength(){return jr(this.bounds)}getDiagonalLength(){return Ir(this.bounds)}getMinPoint(){return Ke(this.bounds)}getMaxPoint(){return Ge(this.bounds)}getXRange(){return Fr(this.bounds)}getYRange(){return Ur(this.bounds)}getZRange(){return Rr(this.bounds)}getCorners(t){return We(this.bounds,t)}computeCornerPoints(t,n){return zr(this.bounds,t,n)}computeLocalBounds(t,n,r){return Br(this.bounds,t,n,r)}transformBounds(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return Ar(this.bounds,t,n)}computeScale3(t){return br(this.bounds,t)}cutWithPlane(t,n){return Hr(this.bounds,t,n)}intersectBox(t,n,r,s){return Kr(this.bounds,t,n,r,s)}intersectPlane(t,n){return Gr(this.bounds,t,n)}intersect(t){return Wr(this.bounds,t)}intersects(t){return At(this.bounds,t)}containsPoint(t,n,r){return bt(this.bounds,t,n,r)}contains(t){return At(this.bounds,t)}}function ci(e){const t=e&&e.bounds;return new oi(t)}const ui={equals:kr,isValid:Z,setBounds:Ie,reset:ze,addPoint:zt,addPoints:Ae,addBounds:Nr,setMinPoint:$r,setMaxPoint:Vr,inflate:_r,scale:be,scaleAboutCenter:ai,getCenter:Be,getLength:pt,getLengths:Zt,getMaxLength:jr,getDiagonalLength:Ir,getMinPoint:Ke,getMaxPoint:Ge,getXRange:Fr,getYRange:Ur,getZRange:Rr,getCorners:We,computeCornerPoints:zr,computeLocalBounds:Br,transformBounds:Ar,computeScale3:br,cutWithPlane:Hr,intersectBox:Kr,intersectPlane:Gr,intersect:Wr,intersects:At,containsPoint:bt,contains:ii,INIT_BOUNDS:Qt};var lt={newInstance:ci,...ui};const fi={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},Pt={VOID:"",CHAR:"Int8Array",SIGNED_CHAR:"Int8Array",UNSIGNED_CHAR:"Uint8Array",UNSIGNED_CHAR_CLAMPED:"Uint8ClampedArray",SHORT:"Int16Array",UNSIGNED_SHORT:"Uint16Array",INT:"Int32Array",UNSIGNED_INT:"Uint32Array",FLOAT:"Float32Array",DOUBLE:"Float64Array"},li=Pt.FLOAT;var Xr={DefaultDataType:li,DataTypeByteSize:fi,VtkDataTypes:Pt};const{vtkErrorMacro:gi}=hr,{DefaultDataType:hi}=Xr,yi=1e-6;function de(e,t,n){const r=e.length;let s=Number.MAX_VALUE,a=-Number.MAX_VALUE,i,c;for(c=t;c<r;c+=n)if(!Number.isNaN(e[c])){s=e[c],a=s;break}for(;c<r;c+=n)i=e[c],i<s?s=i:i>a&&(a=i);return{min:s,max:a}}function pi(){let e=Number.MAX_VALUE,t=-Number.MAX_VALUE,n=0,r=0;return{add(s){e>s&&(e=s),t<s&&(t=s),n++,r+=s},get(){return{min:e,max:t,count:n,sum:r,mean:r/n}},getRange(){return{min:e,max:t}}}}function Yr(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;if(t<0&&n>1){const s=e.length/n,a=new Float64Array(s);for(let i=0,c=0;i<s;++i){for(let o=c+n;c<o;++c)a[i]+=e[c]*e[c];a[i]**=.5}return de(a,0,1)}return de(e,t<0?0:t,n)}function pn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=e||[];for(;n.length<=t;)n.push(null);return n}function He(e){return Object.prototype.toString.call(e).slice(8,-1)}function vi(e){const t=e.getNumberOfComponents();let n=0;const r=new Array(t);for(let s=0;s<e.getNumberOfTuples();++s){e.getTuple(s,r);const a=vr(r,t);a>n&&(n=a)}return n}const mi={computeRange:Yr,createRangeHelper:pi,fastComputeRange:de,getDataType:He,getMaxNorm:vi};function di(e,t){t.classHierarchy.push("vtkDataArray");function n(r){if(r<0)return!1;const s=e.getNumberOfComponents(),a=t.values.length/(s>0?s:1);if(r===a)return!0;if(r>a){const i=t.values;return t.values=Gt(t.dataType,(r+a)*s),t.values.set(i),!0}return t.size>r*s&&(t.size=r*s,e.dataChange()),!0}e.dataChange=()=>{t.ranges=null,e.modified()},e.resize=r=>{n(r);const s=r*e.getNumberOfComponents();return t.size!==s?(t.size=s,e.dataChange(),!0):!1},e.initialize=()=>{e.resize(0)},e.getElementComponentSize=()=>t.values.BYTES_PER_ELEMENT,e.getComponent=function(r){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return t.values[r*t.numberOfComponents+s]},e.setComponent=(r,s,a)=>{a!==t.values[r*t.numberOfComponents+s]&&(t.values[r*t.numberOfComponents+s]=a,e.dataChange())},e.getValue=r=>{const s=r/t.numberOfComponents,a=r%t.numberOfComponents;return e.getComponent(s,a)},e.setValue=(r,s)=>{const a=r/t.numberOfComponents,i=r%t.numberOfComponents;e.setComponent(a,i,s)},e.getData=()=>t.size===t.values.length?t.values:t.values.subarray(0,t.size),e.getRange=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:-1,s=r;s<0&&(s=t.numberOfComponents===1?0:t.numberOfComponents);let a=null;return t.ranges||(t.ranges=pn(t.ranges,t.numberOfComponents)),a=t.ranges[s],a?(t.rangeTuple[0]=a.min,t.rangeTuple[1]=a.max,t.rangeTuple):(a=Yr(e.getData(),r,t.numberOfComponents),t.ranges[s]=a,t.rangeTuple[0]=a.min,t.rangeTuple[1]=a.max,t.rangeTuple)},e.setRange=(r,s)=>{t.ranges||(t.ranges=pn(t.ranges,t.numberOfComponents));const a={min:r.min,max:r.max};return t.ranges[s]=a,t.rangeTuple[0]=a.min,t.rangeTuple[1]=a.max,t.rangeTuple},e.setTuple=(r,s)=>{const a=r*t.numberOfComponents;for(let i=0;i<t.numberOfComponents;i++)t.values[a+i]=s[i]},e.setTuples=(r,s)=>{let a=r*t.numberOfComponents;const i=Math.min(s.length,t.size-a);for(let c=0;c<i;)t.values[a++]=s[c++]},e.insertTuple=(r,s)=>(t.size<=r*t.numberOfComponents&&(t.size=(r+1)*t.numberOfComponents,n(r+1)),e.setTuple(r,s),r),e.insertTuples=(r,s)=>{const a=r+s.length/t.numberOfComponents;return t.size<a*t.numberOfComponents&&(t.size=a*t.numberOfComponents,n(a)),e.setTuples(r,s),a},e.insertNextTuple=r=>{const s=t.size/t.numberOfComponents;return e.insertTuple(s,r)},e.insertNextTuples=r=>{const s=t.size/t.numberOfComponents;return e.insertTuples(s,r)},e.findTuple=function(r){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:yi;for(let a=0;a<t.size;a+=t.numberOfComponents)if(Math.abs(r[0]-t.values[a])<=s){let i=!0;for(let c=1;c<t.numberOfComponents;++c)if(Math.abs(r[c]-t.values[a+c])>s){i=!1;break}if(i)return a/t.numberOfComponents}return-1},e.getTuple=function(r){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const a=t.numberOfComponents||1,i=r*a;switch(a){case 4:s[3]=t.values[i+3];case 3:s[2]=t.values[i+2];case 2:s[1]=t.values[i+1];case 1:s[0]=t.values[i];break;default:for(let c=a-1;c>=0;--c)s[c]=t.values[i+c]}return s},e.getTuples=(r,s)=>{const a=(r??0)*t.numberOfComponents,i=(s??e.getNumberOfTuples())*t.numberOfComponents,c=e.getData().subarray(a,i);return c.length>0?c:null},e.getTupleLocation=function(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:1)*t.numberOfComponents},e.getNumberOfComponents=()=>t.numberOfComponents,e.getNumberOfValues=()=>t.size,e.getNumberOfTuples=()=>t.size/t.numberOfComponents,e.getDataType=()=>t.dataType,e.newClone=()=>qr({empty:!0,name:t.name,dataType:t.dataType,numberOfComponents:t.numberOfComponents}),e.getName=()=>(t.name||(e.modified(),t.name=`vtkDataArray${e.getMTime()}`),t.name),e.setData=(r,s)=>{t.values=r,t.size=r.length,t.dataType=He(r),s&&(t.numberOfComponents=s),t.size%t.numberOfComponents!==0&&(t.numberOfComponents=1),e.dataChange()},e.getState=()=>{if(t.deleted)return null;const r={...t,vtkClass:e.getClassName()};r.values=Array.from(r.values),delete r.buffer,Object.keys(r).forEach(a=>{r[a]||delete r[a]});const s={};return Object.keys(r).sort().forEach(a=>{s[a]=r[a]}),s.mtime&&delete s.mtime,s},e.deepCopy=r=>{const s=e.getDataType(),a=t.values;e.shallowCopy(r),a?.length>=r.getNumberOfValues()&&s===r.getDataType()?(a.set(r.getData()),t.values=a,e.dataChange()):e.setData(r.getData().slice())},e.interpolateTuple=(r,s,a,i,c,o)=>{const u=t.numberOfComponents||1;(u!==s.getNumberOfComponents()||u!==i.getNumberOfComponents())&&gi("numberOfComponents must match");const f=s.getTuple(a),l=i.getTuple(c),g=[];switch(g.length=u,u){case 4:g[3]=f[3]+(l[3]-f[3])*o;case 3:g[2]=f[2]+(l[2]-f[2])*o;case 2:g[1]=f[1]+(l[1]-f[1])*o;case 1:g[0]=f[0]+(l[0]-f[0])*o;break;default:for(let h=0;h<u;h++)g[h]=f[h]+(l[h]-f[h])*o}return e.insertTuple(r,g)}}const Ti={name:"",numberOfComponents:1,dataType:hi,rangeTuple:[0,0]};function Jr(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(Object.assign(t,Ti,n),!t.empty&&!t.values&&!t.size)throw new TypeError("Cannot create vtkDataArray object without: size > 0, values");if(t.values?Array.isArray(t.values)&&(t.values=Wt(t.dataType,t.values)):t.values=Gt(t.dataType,t.size),t.values&&(t.size=t.size??t.values.length,t.dataType=He(t.values)),Xt(e,t),Yt(e,t,["name","numberOfComponents"]),t.size%t.numberOfComponents!==0)throw new RangeError("model.size is not a multiple of model.numberOfComponents");di(e,t)}const qr=qt(Jr,"vtkDataArray");var Q={newInstance:qr,extend:Jr,...mi,...Xr};const{vtkErrorMacro:vn,vtkWarningMacro:wi}=N;function Ci(e,t){t.classHierarchy.push("vtkFieldData");const n=e.getState;t.arrays&&(t.arrays=t.arrays.map(r=>({data:H(r.data)}))),e.initialize=()=>{e.initializeFields(),e.copyAllOn(),e.clearFieldFlags()},e.initializeFields=()=>{t.arrays=[],t.copyFieldFlags={},e.modified()},e.copyStructure=r=>{e.initializeFields(),t.copyFieldFlags=r.getCopyFieldFlags().map(s=>s),t.arrays=r.arrays().map(s=>({array:s}))},e.getNumberOfArrays=()=>t.arrays.length,e.getNumberOfActiveArrays=()=>t.arrays.length,e.addArray=r=>{const s=r.getName(),{array:a,index:i}=e.getArrayWithIndex(s);return a!=null?(t.arrays[i]={data:r},i):(t.arrays=[].concat(t.arrays,{data:r}),t.arrays.length-1)},e.removeAllArrays=()=>{t.arrays=[]},e.removeArray=r=>{const s=t.arrays.findIndex(a=>a.data.getName()===r);return e.removeArrayByIndex(s)},e.removeArrayByIndex=r=>r!==-1&&r<t.arrays.length?(t.arrays.splice(r,1),!0):!1,e.getArrays=()=>t.arrays.map(r=>r.data),e.getArray=r=>typeof r=="number"?e.getArrayByIndex(r):e.getArrayByName(r),e.getArrayByName=r=>t.arrays.reduce((s,a,i)=>a.data.getName()===r?a.data:s,null),e.getArrayWithIndex=r=>{const s=t.arrays.findIndex(a=>a.data.getName()===r);return{array:s!==-1?t.arrays[s].data:null,index:s}},e.getArrayByIndex=r=>r>=0&&r<t.arrays.length?t.arrays[r].data:null,e.hasArray=r=>e.getArrayWithIndex(r).index>=0,e.getArrayName=r=>{const s=t.arrays[r];return s?s.data.getName():""},e.getCopyFieldFlags=()=>t.copyFieldFlags,e.getFlag=r=>t.copyFieldFlags[r],e.passData=function(r){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1;r.getArrays().forEach(i=>{const c=e.getFlag(i.getName());if(c!==!1&&!(t.doCopyAllOff&&c!==!0)&&i){let o=e.getArrayByName(i.getName());if(o)if(i.getNumberOfComponents()===o.getNumberOfComponents())if(s>-1&&s<i.getNumberOfTuples()){const u=a>-1?a:s;o.insertTuple(u,i.getTuple(s))}else o.insertTuples(0,i.getTuples());else vn("Unhandled case in passData");else if(s<0||s>i.getNumberOfTuples())e.addArray(i),r.getAttributes(i).forEach(u=>{e.setAttribute(i,u)});else{const u=i.getNumberOfComponents();let f=i.getNumberOfValues();const l=a>-1?a:s;f<=l*u&&(f=(l+1)*u),o=Q.newInstance({name:i.getName(),dataType:i.getDataType(),numberOfComponents:u,values:N.newTypedArray(i.getDataType(),f),size:0}),o.insertTuple(l,i.getTuple(s)),e.addArray(o),r.getAttributes(i).forEach(g=>{e.setAttribute(o,g)})}}})},e.interpolateData=function(r){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:-1,c=arguments.length>4&&arguments[4]!==void 0?arguments[4]:.5;r.getArrays().forEach(o=>{const u=e.getFlag(o.getName());if(u!==!1&&!(t.doCopyAllOff&&u!==!0)&&o){let f=e.getArrayByName(o.getName());if(f)if(o.getNumberOfComponents()===f.getNumberOfComponents())if(s>-1&&s<o.getNumberOfTuples()){const l=i>-1?i:s;f.interpolateTuple(l,o,s,o,a,c),wi("Unexpected case in interpolateData")}else f.insertTuples(o.getTuples());else vn("Unhandled case in interpolateData");else if(s<0||a<0||s>o.getNumberOfTuples())e.addArray(o),r.getAttributes(o).forEach(l=>{e.setAttribute(o,l)});else{const l=o.getNumberOfComponents();let g=o.getNumberOfValues();const h=i>-1?i:s;g<=h*l&&(g=(h+1)*l),f=Q.newInstance({name:o.getName(),dataType:o.getDataType(),numberOfComponents:l,values:N.newTypedArray(o.getDataType(),g),size:0}),f.interpolateTuple(h,o,s,o,a,c),e.addArray(f),r.getAttributes(o).forEach(y=>{e.setAttribute(f,y)})}}})},e.copyFieldOn=r=>{t.copyFieldFlags[r]=!0},e.copyFieldOff=r=>{t.copyFieldFlags[r]=!1},e.copyAllOn=()=>{(!t.doCopyAllOn||t.doCopyAllOff)&&(t.doCopyAllOn=!0,t.doCopyAllOff=!1,e.modified())},e.copyAllOff=()=>{(t.doCopyAllOn||!t.doCopyAllOff)&&(t.doCopyAllOn=!1,t.doCopyAllOff=!0,e.modified())},e.clearFieldFlags=()=>{t.copyFieldFlags={}},e.deepCopy=r=>{t.arrays=r.getArrays().map(s=>{const a=s.newClone();return a.deepCopy(s),{data:a}})},e.copyFlags=r=>r.getCopyFieldFlags().map(s=>s),e.reset=()=>t.arrays.forEach(r=>r.data.reset()),e.getMTime=()=>t.arrays.reduce((r,s)=>s.data.getMTime()>r?s.data.getMTime():r,t.mtime),e.getNumberOfComponents=()=>t.arrays.reduce((r,s)=>r+s.data.getNumberOfComponents(),0),e.getNumberOfTuples=()=>t.arrays.length>0?t.arrays[0].getNumberOfTuples():0,e.getState=()=>{const r=n();return r&&(r.arrays=t.arrays.map(s=>({data:s.data.getState()}))),r}}const Oi={arrays:[],copyFieldFlags:[],doCopyAllOn:!0,doCopyAllOff:!1};function Qr(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(t,Oi,n),N.obj(e,t),Ci(e,t)}const xi=N.newInstance(Qr,"vtkFieldData");var Ei={newInstance:xi,extend:Qr};const Si={SCALARS:0,VECTORS:1,NORMALS:2,TCOORDS:3,TENSORS:4,GLOBALIDS:5,PEDIGREEIDS:6,EDGEFLAG:7,NUM_ATTRIBUTES:8},Di={MAX:0,EXACT:1,NOLIMIT:2},Li={DUPLICATECELL:1,HIGHCONNECTIVITYCELL:2,LOWCONNECTIVITYCELL:4,REFINEDCELL:8,EXTERIORCELL:16,HIDDENCELL:32},Mi={DUPLICATEPOINT:1,HIDDENPOINT:2},ki={COPYTUPLE:0,INTERPOLATE:1,PASSDATA:2,ALLCOPY:3},Ni="vtkGhostType",$i={DEFAULT:0,SINGLE:1,DOUBLE:2};var Zr={AttributeCopyOperations:ki,AttributeLimitTypes:Di,AttributeTypes:Si,CellGhostTypes:Li,DesiredOutputPrecision:$i,PointGhostTypes:Mi,ghostArrayName:Ni};const{AttributeTypes:P,AttributeCopyOperations:nt}=Zr,{vtkWarningMacro:Ct}=N;function Vi(e,t){const n=["Scalars","Vectors","Normals","TCoords","Tensors","GlobalIds","PedigreeIds"];function r(i){let c=n.find(o=>P[o.toUpperCase()]===i||typeof i!="number"&&o.toLowerCase()===i.toLowerCase());return typeof c>"u"&&(c=null),c}t.classHierarchy.push("vtkDataSetAttributes");const s={...e};e.checkNumberOfComponents=i=>!0,e.setAttribute=(i,c)=>{const o=r(c);if(i&&o.toUpperCase()==="PEDIGREEIDS"&&!i.isA("vtkDataArray"))return Ct(`Cannot set attribute ${o}. The attribute must be a vtkDataArray.`),-1;if(i&&!e.checkNumberOfComponents(i,o))return Ct(`Cannot set attribute ${o}. Incorrect number of components.`),-1;let u=t[`active${o}`];if(u>=0&&u<t.arrays.length){if(t.arrays[u]===i)return u;e.removeArrayByIndex(u)}return i?(u=e.addArray(i),t[`active${o}`]=u):t[`active${o}`]=-1,e.modified(),t[`active${o}`]},e.getAttributes=i=>n.filter(c=>e[`get${c}`]()===i),e.setActiveAttributeByName=(i,c)=>e.setActiveAttributeByIndex(e.getArrayWithIndex(i).index,c),e.setActiveAttributeByIndex=(i,c)=>{const o=r(c);if(i>=0&&i<t.arrays.length){if(o.toUpperCase()!=="PEDIGREEIDS"){const u=e.getArrayByIndex(i);if(!u.isA("vtkDataArray"))return Ct(`Cannot set attribute ${o}. Only vtkDataArray subclasses can be set as active attributes.`),-1;if(!e.checkNumberOfComponents(u,o))return Ct(`Cannot set attribute ${o}. Incorrect number of components.`),-1}return t[`active${o}`]=i,e.modified(),i}return i===-1&&(t[`active${o}`]=i,e.modified()),-1},e.getActiveAttribute=i=>{const c=r(i);return e[`get${c}`]()},e.removeAllArrays=()=>{n.forEach(i=>{t[`active${i}`]=-1}),s.removeAllArrays()},e.removeArrayByIndex=i=>(i!==-1&&n.forEach(c=>{i===t[`active${c}`]?t[`active${c}`]=-1:i<t[`active${c}`]&&(t[`active${c}`]-=1)}),s.removeArrayByIndex(i)),n.forEach(i=>{const c=`active${i}`;e[`get${i}`]=()=>e.getArrayByIndex(t[c]),e[`set${i}`]=o=>e.setAttribute(o,i),e[`setActive${i}`]=o=>e.setActiveAttributeByIndex(e.getArrayWithIndex(o).index,i),e[`copy${i}Off`]=()=>{const o=i.toUpperCase();t.copyAttributeFlags[nt.PASSDATA][P[o]]=!1},e[`copy${i}On`]=()=>{const o=i.toUpperCase();t.copyAttributeFlags[nt.PASSDATA][P[o]]=!0}}),e.initializeAttributeCopyFlags=()=>{t.copyAttributeFlags=[],Object.keys(nt).filter(i=>i!=="ALLCOPY").forEach(i=>{t.copyAttributeFlags[nt[i]]=Object.keys(P).filter(c=>c!=="NUM_ATTRIBUTES").reduce((c,o)=>(c[P[o]]=!0,c),[])}),t.copyAttributeFlags[nt.COPYTUPLE][P.GLOBALIDS]=!1,t.copyAttributeFlags[nt.INTERPOLATE][P.GLOBALIDS]=!1,t.copyAttributeFlags[nt.COPYTUPLE][P.PEDIGREEIDS]=!1},e.initialize=N.chain(e.initialize,e.initializeAttributeCopyFlags),t.dataArrays&&Object.keys(t.dataArrays).length&&Object.keys(t.dataArrays).forEach(i=>{!t.dataArrays[i].ref&&t.dataArrays[i].type==="vtkDataArray"&&e.addArray(Q.newInstance(t.dataArrays[i]))});const a=e.shallowCopy;e.shallowCopy=(i,c)=>{a(i,c),t.arrays=i.getArrays().map(o=>{const u=o.newClone();return u.shallowCopy(o,c),{data:u}})},e.initializeAttributeCopyFlags()}const _i={activeScalars:-1,activeVectors:-1,activeTensors:-1,activeNormals:-1,activeTCoords:-1,activeGlobalIds:-1,activePedigreeIds:-1};function Pr(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(t,_i,n),Ei.extend(e,t,n),N.setGet(e,t,["activeScalars","activeNormals","activeTCoords","activeVectors","activeTensors","activeGlobalIds","activePedigreeIds"]),t.arrays||(t.arrays={}),Vi(e,t)}const Fi=N.newInstance(Pr,"vtkDataSetAttributes");var mn={newInstance:Fi,extend:Pr,...Zr};const Ui={UNIFORM:0,DATA_OBJECT_FIELD:0,COORDINATE:1,POINT_DATA:1,POINT:2,POINT_FIELD_DATA:2,CELL:3,CELL_FIELD_DATA:3,VERTEX:4,VERTEX_FIELD_DATA:4,EDGE:5,EDGE_FIELD_DATA:5,ROW:6,ROW_DATA:6},Ri={FIELD_ASSOCIATION_POINTS:0,FIELD_ASSOCIATION_CELLS:1,FIELD_ASSOCIATION_NONE:2,FIELD_ASSOCIATION_POINTS_THEN_CELLS:3,FIELD_ASSOCIATION_VERTICES:4,FIELD_ASSOCIATION_EDGES:5,FIELD_ASSOCIATION_ROWS:6,NUMBER_OF_ASSOCIATIONS:7};var ji={FieldDataTypes:Ui,FieldAssociations:Ri};const Te=["pointData","cellData","fieldData"];function Ii(e,t){t.classHierarchy.push("vtkDataSet"),Te.forEach(r=>{t[r]?t[r]=H(t[r]):t[r]=mn.newInstance()});const n=e.shallowCopy;e.shallowCopy=function(r){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;n(r,s),Te.forEach(a=>{t[a]=mn.newInstance(),t[a].shallowCopy(r.getReferenceByName(a))})}}const zi={};function ts(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(t,zi,n),N.obj(e,t),N.setGet(e,t,Te),Ii(e,t)}const Ai=N.newInstance(ts,"vtkDataSet");var es={newInstance:Ai,extend:ts,...ji};const G={UNCHANGED:0,SINGLE_POINT:1,X_LINE:2,Y_LINE:3,Z_LINE:4,XY_PLANE:5,YZ_PLANE:6,XZ_PLANE:7,XYZ_GRID:8,EMPTY:9};var ns={StructuredType:G};const{StructuredType:J}=ns;function bi(e){let t=0;for(let n=0;n<3;++n)e[n*2]<e[n*2+1]&&t++;return e[0]>e[1]||e[2]>e[3]||e[4]>e[5]?J.EMPTY:t===3?J.XYZ_GRID:t===2?e[0]===e[1]?J.YZ_PLANE:e[2]===e[3]?J.XZ_PLANE:J.XY_PLANE:t===1?e[0]<e[1]?J.X_LINE:e[2]<e[3]?J.Y_LINE:J.Z_LINE:J.SINGLE_POINT}var Bi={getDataDescriptionFromExtent:bi,...ns};const{vtkErrorMacro:rt}=N;function Ki(e,t){t.classHierarchy.push("vtkImageData"),e.setExtent=function(){if(t.deleted)return rt("instance deleted - cannot call any method"),!1;for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];const a=r.length===1?r[0]:r;if(a.length!==6)return!1;const i=t.extent.some((c,o)=>c!==a[o]);return i&&(t.extent=a.slice(),t.dataDescription=Bi.getDataDescriptionFromExtent(t.extent),e.modified()),i},e.setDimensions=function(){let n,r,s;if(t.deleted){rt("instance deleted - cannot call any method");return}if(arguments.length===1){const a=arguments.length<=0?void 0:arguments[0];n=a[0],r=a[1],s=a[2]}else if(arguments.length===3)n=arguments.length<=0?void 0:arguments[0],r=arguments.length<=1?void 0:arguments[1],s=arguments.length<=2?void 0:arguments[2];else{rt("Bad dimension specification");return}e.setExtent(0,n-1,0,r-1,0,s-1)},e.getDimensions=()=>[t.extent[1]-t.extent[0]+1,t.extent[3]-t.extent[2]+1,t.extent[5]-t.extent[4]+1],e.getNumberOfCells=()=>{const n=e.getDimensions();let r=1;for(let s=0;s<3;s++){if(n[s]===0)return 0;n[s]>1&&(r*=n[s]-1)}return r},e.getNumberOfPoints=()=>{const n=e.getDimensions();return n[0]*n[1]*n[2]},e.getPoint=n=>{const r=e.getDimensions();if(r[0]===0||r[1]===0||r[2]===0)return rt("Requesting a point from an empty image."),null;const s=new Float64Array(3);switch(t.dataDescription){case G.EMPTY:return null;case G.SINGLE_POINT:break;case G.X_LINE:s[0]=n;break;case G.Y_LINE:s[1]=n;break;case G.Z_LINE:s[2]=n;break;case G.XY_PLANE:s[0]=n%r[0],s[1]=n/r[0];break;case G.YZ_PLANE:s[1]=n%r[1],s[2]=n/r[1];break;case G.XZ_PLANE:s[0]=n%r[0],s[2]=n/r[0];break;case G.XYZ_GRID:s[0]=n%r[0],s[1]=n/r[0]%r[1],s[2]=n/(r[0]*r[1]);break;default:rt("Invalid dataDescription");break}const a=[0,0,0];return e.indexToWorld(s,a),a},e.getBounds=()=>e.extentToBounds(e.getSpatialExtent()),e.extentToBounds=n=>lt.transformBounds(n,t.indexToWorld),e.getSpatialExtent=()=>lt.inflate([...t.extent],.5),e.computeTransforms=()=>{Ha(t.indexToWorld,t.origin),t.indexToWorld[0]=t.direction[0],t.indexToWorld[1]=t.direction[1],t.indexToWorld[2]=t.direction[2],t.indexToWorld[4]=t.direction[3],t.indexToWorld[5]=t.direction[4],t.indexToWorld[6]=t.direction[5],t.indexToWorld[8]=t.direction[6],t.indexToWorld[9]=t.direction[7],t.indexToWorld[10]=t.direction[8],Wa(t.indexToWorld,t.indexToWorld,t.spacing),Ga(t.worldToIndex,t.indexToWorld)},e.indexToWorld=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return ve(r,n,t.indexToWorld),r},e.indexToWorldVec3=e.indexToWorld,e.worldToIndex=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return ve(r,n,t.worldToIndex),r},e.worldToIndexVec3=e.worldToIndex,e.indexToWorldBounds=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return lt.transformBounds(n,t.indexToWorld,r)},e.worldToIndexBounds=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return lt.transformBounds(n,t.worldToIndex,r)},e.onModified(e.computeTransforms),e.computeTransforms(),e.getCenter=()=>lt.getCenter(e.getBounds()),e.computeHistogram=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const s=[0,0,0,0,0,0];e.worldToIndexBounds(n,s);const a=[0,0,0],i=[0,0,0];lt.computeCornerPoints(s,a,i),ln(a,a),ln(i,i);const c=e.getDimensions();gn(a,[0,0,0],[c[0]-1,c[1]-1,c[2]-1],a),gn(i,[0,0,0],[c[0]-1,c[1]-1,c[2]-1],i);const o=c[0],u=c[0]*c[1],f=e.getPointData().getScalars().getData();let l=-1/0,g=1/0,h=0,y=0,p=0;for(let v=a[2];v<=i[2];v++)for(let d=a[1];d<=i[1];d++){let O=a[0]+d*o+v*u;for(let w=a[0];w<=i[0];w++){if(!r||r([w,d,v],s)){const x=f[O];x>l&&(l=x),x<g&&(g=x),h+=x*x,y+=x,p+=1}++O}}const m=p>0?y/p:0,C=p?Math.abs(h/p-m*m):0,E=Math.sqrt(C);return{minimum:g,maximum:l,average:m,variance:C,sigma:E,count:p}},e.computeIncrements=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const s=[];let a=r;for(let i=0;i<3;++i)s[i]=a,a*=n[i*2+1]-n[i*2]+1;return s},e.computeOffsetIndex=n=>{let[r,s,a]=n;const i=e.getExtent(),c=e.getPointData().getScalars().getNumberOfComponents(),o=e.computeIncrements(i,c);return Math.floor((Math.round(r)-i[0])*o[0]+(Math.round(s)-i[2])*o[1]+(Math.round(a)-i[4])*o[2])},e.getOffsetIndexFromWorld=n=>{const r=e.getExtent(),s=e.worldToIndex(n);for(let a=0;a<3;++a)if(s[a]<r[a*2]||s[a]>r[a*2+1])return rt(`GetScalarPointer: Pixel ${s} is not in memory. Current extent = ${r}`),NaN;return e.computeOffsetIndex(s)},e.getScalarValueFromWorld=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const s=e.getPointData().getScalars().getNumberOfComponents();if(r<0||r>=s)return rt(`GetScalarPointer: Scalar Component ${r} is not within bounds. Current Scalar numberOfComponents: ${s}`),NaN;const a=e.getOffsetIndexFromWorld(n);return Number.isNaN(a)?a:e.getPointData().getScalars().getComponent(a,r)}}const Gi={direction:null,indexToWorld:null,worldToIndex:null,spacing:[1,1,1],origin:[0,0,0],extent:[0,-1,0,-1,0,-1],dataDescription:G.EMPTY};function rs(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(t,Gi,n),es.extend(e,t,n),t.direction?Array.isArray(t.direction)&&(t.direction=new Float64Array(t.direction.slice(0,9))):t.direction=Ka(new Float64Array(9)),t.indexToWorld=new Float64Array(16),t.worldToIndex=new Float64Array(16),N.get(e,t,["indexToWorld","worldToIndex"]),N.setGetArray(e,t,["origin","spacing"],3),N.setGetArray(e,t,["direction"],9),N.getArray(e,t,["extent"],6),Ki(e,t)}const Wi=N.newInstance(rs,"vtkImageData");var Ot={newInstance:Wi,extend:rs};class ce{static async createModule(){return console.warn("PolySeg WASM module is disabled"),null}}function ss(e,t,n){return Math.abs(e-t)<=n}function Hi(e,t,n=1e-5){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(!ss(e[r],t[r],n))return!1;return!0}function dn(e){return typeof e=="number"}function Tn(e){return"length"in e&&typeof e[0]=="number"}function Xi(e,t,n=1e-5){return typeof e!=typeof t||e===null||t===null?!1:dn(e)&&dn(t)?ss(e,t,n):Tn(e)&&Tn(t)?Hi(e,t,n):!1}const{vtkErrorMacro:Yi}=N,Ji=[1,-1,1,-1,1,-1];function qi(e,t){t.classHierarchy.push("vtkPoints"),e.getNumberOfPoints=e.getNumberOfTuples,e.setNumberOfPoints=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:3;e.getNumberOfPoints()!==n&&(t.size=n*r,t.values=N.newTypedArray(t.dataType,t.size),e.setNumberOfComponents(r),e.modified())},e.setPoint=function(n){for(var r=arguments.length,s=new Array(r>1?r-1:0),a=1;a<r;a++)s[a-1]=arguments[a];e.setTuple(n,s)},e.getPoint=e.getTuple,e.findPoint=e.findTuple,e.insertNextPoint=(n,r,s)=>e.insertNextTuple([n,r,s]),e.getBounds=()=>{if(e.getNumberOfComponents()===3){const s=e.getRange(0);t.bounds[0]=s[0],t.bounds[1]=s[1];const a=e.getRange(1);t.bounds[2]=a[0],t.bounds[3]=a[1];const i=e.getRange(2);return t.bounds[4]=i[0],t.bounds[5]=i[1],t.bounds}if(e.getNumberOfComponents()!==2)return Yi(`getBounds called on an array with components of
        ${e.getNumberOfComponents()}`),Ji;const n=e.getRange(0);t.bounds[0]=n[0],t.bounds[1]=n[1];const r=e.getRange(1);return t.bounds[2]=r[0],t.bounds[3]=r[1],t.bounds[4]=0,t.bounds[5]=0,t.bounds},e.computeBounds=e.getBounds,e.setNumberOfComponents(t.numberOfComponents<2?3:t.numberOfComponents)}const Qi={empty:!0,numberOfComponents:3,dataType:Pt.FLOAT,bounds:[1,-1,1,-1,1,-1]};function as(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(t,Qi,n),Q.extend(e,t,n),qi(e,t)}const Zi=N.newInstance(as,"vtkPoints");var we={newInstance:Zi,extend:as};function is(e){let t=0;return e.filter((n,r)=>r===t?(t+=n+1,!0):!1)}function os(e){let t=0;for(let n=0;n<e.length;)n+=e[n]+1,t++;return t}const Pi={extractCellSizes:is,getNumberOfCells:os};function to(e,t){t.classHierarchy.push("vtkCellArray");const n={...e};e.getNumberOfCells=r=>(t.numberOfCells!==void 0&&!r||(t.cellSizes?t.numberOfCells=t.cellSizes.length:t.numberOfCells=os(e.getData())),t.numberOfCells),e.getCellSizes=r=>(t.cellSizes!==void 0&&!r||(t.cellSizes=is(e.getData())),t.cellSizes),e.resize=r=>{const s=e.getNumberOfTuples();n.resize(r);const a=e.getNumberOfTuples();a<s&&(a===0?(t.numberOfCells=0,t.cellSizes=[]):(t.numberOfCells=void 0,t.cellSizes=void 0))},e.setData=r=>{n.setData(r,1),t.numberOfCells=void 0,t.cellSizes=void 0},e.getCell=r=>{let s=r;const a=t.values[s++];return t.values.subarray(s,s+a)},e.insertNextCell=r=>{const s=e.getNumberOfCells();return e.insertNextTuples([r.length,...r]),++t.numberOfCells,t.cellSizes!=null&&t.cellSizes.push(r.length),s}}function eo(e){return{empty:!0,numberOfComponents:1,dataType:Pt.UNSIGNED_INT,...e}}function cs(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Q.extend(e,t,eo(n)),to(e,t)}const no=N.newInstance(cs,"vtkCellArray");var wn={newInstance:no,extend:cs,...Pi};function ro(e,t){t.classHierarchy.push("vtkCell"),e.initialize=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(r){t.pointsIds=r;let s=t.points.getData();s.length!==3*t.pointsIds.length&&(s=N.newTypedArray(n.getDataType(),3*t.pointsIds.length));const a=n.getData();t.pointsIds.forEach((i,c)=>{let o=3*i,u=3*c;s[u]=a[o],s[++u]=a[++o],s[++u]=a[++o]}),t.points.setData(s)}else{t.points=n,t.pointsIds=new Array(n.getNumberOfPoints());for(let s=n.getNumberOfPoints()-1;s>=0;--s)t.pointsIds[s]=s}},e.getBounds=()=>{const n=t.points.getNumberOfPoints(),r=[];if(n){t.points.getPoint(0,r),t.bounds[0]=r[0],t.bounds[1]=r[0],t.bounds[2]=r[1],t.bounds[3]=r[1],t.bounds[4]=r[2],t.bounds[5]=r[2];for(let s=1;s<n;s++)t.points.getPoint(s,r),t.bounds[0]=r[0]<t.bounds[0]?r[0]:t.bounds[0],t.bounds[1]=r[0]>t.bounds[1]?r[0]:t.bounds[1],t.bounds[2]=r[1]<t.bounds[2]?r[1]:t.bounds[2],t.bounds[3]=r[1]>t.bounds[3]?r[1]:t.bounds[3],t.bounds[4]=r[2]<t.bounds[4]?r[2]:t.bounds[4],t.bounds[5]=r[2]>t.bounds[5]?r[2]:t.bounds[5]}else Aa(t.bounds);return t.bounds},e.getLength2=()=>{e.getBounds();let n=0,r=0;for(let s=0;s<3;s++)r=t.bounds[2*s+1]-t.bounds[2*s],n+=r*r;return n},e.getParametricDistance=n=>{let r,s=0;for(let a=0;a<3;a++)n[a]<0?r=-n[a]:n[a]>1?r=n[a]-1:r=0,r>s&&(s=r);return s},e.getNumberOfPoints=()=>t.points.getNumberOfPoints(),e.deepCopy=n=>{n.initialize(t.points,t.pointsIds)},e.getCellDimension=()=>{},e.intersectWithLine=(n,r,s,a,i,c,o)=>{},e.evaluatePosition=(n,r,s,a,i,c)=>{N.vtkErrorMacro("vtkCell.evaluatePosition is not implemented.")}}const so={bounds:[-1,-1,-1,-1,-1,-1],pointsIds:[]};function us(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(t,so,n),N.obj(e,t),t.points||(t.points=we.newInstance()),N.get(e,t,["points","pointsIds"]),ro(e,t)}const ao=N.newInstance(us,"vtkCell");var Bt={newInstance:ao,extend:us};function io(e,t){let n=t;for(t>=e.array.length&&(n+=e.array.length);n>e.array.length;)e.array.push({ncells:0,cells:null});e.array.length=n}function oo(e,t){t.classHierarchy.push("vtkCellLinks"),e.buildLinks=n=>{const r=n.getPoints().getNumberOfPoints(),s=n.getNumberOfCells(),a=new Uint32Array(r);if(n.isA("vtkPolyData")){for(let i=0;i<s;++i){const{cellPointIds:c}=n.getCellPoints(i);c.forEach(o=>{e.incrementLinkCount(o)})}e.allocateLinks(r),t.maxId=r-1;for(let i=0;i<s;++i){const{cellPointIds:c}=n.getCellPoints(i);c.forEach(o=>{e.insertCellReference(o,a[o]++,i)})}}else{for(let i=0;i<s;i++)Bt.newInstance().getPointsIds().forEach(o=>{e.incrementLinkCount(o)});e.allocateLinks(r),t.maxId=r-1;for(let i=0;i<s;++i)Bt.newInstance().getPointsIds().forEach(o=>{e.insertCellReference(o,a[o]++,i)})}},e.allocate=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e3;t.array=Array(n).fill().map(()=>({ncells:0,cells:null})),t.extend=r,t.maxId=-1},e.initialize=()=>{t.array=null},e.getLink=n=>t.array[n],e.getNcells=n=>t.array[n].ncells,e.getCells=n=>t.array[n].cells,e.insertNextPoint=n=>{t.array.push({ncells:n,cells:Array(n)}),++t.maxId},e.insertNextCellReference=(n,r)=>{t.array[n].cells[t.array[n].ncells++]=r},e.deletePoint=n=>{t.array[n].ncells=0,t.array[n].cells=null},e.removeCellReference=(n,r)=>{t.array[r].cells=t.array[r].cells.filter(s=>s!==n),t.array[r].ncells=t.array[r].cells.length},e.addCellReference=(n,r)=>{t.array[r].cells[t.array[r].ncells++]=n},e.resizeCellList=(n,r)=>{t.array[n].cells.length=r},e.squeeze=()=>{io(t,t.maxId+1)},e.reset=()=>{t.maxId=-1},e.deepCopy=n=>{t.array=[...n.array],t.extend=n.extend,t.maxId=n.maxId},e.incrementLinkCount=n=>{++t.array[n].ncells},e.allocateLinks=n=>{for(let r=0;r<n;++r)t.array[r].cells=new Array(t.array[r].ncells)},e.insertCellReference=(n,r,s)=>{t.array[n].cells[r]=s}}const co={array:null,maxId:0,extend:0};function fs(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(t,co,n),N.obj(e,t),oo(e,t)}const uo=N.newInstance(fs,"vtkCellLinks");var fo={newInstance:uo,extend:fs};const U={VTK_EMPTY_CELL:0,VTK_VERTEX:1,VTK_POLY_VERTEX:2,VTK_LINE:3,VTK_POLY_LINE:4,VTK_TRIANGLE:5,VTK_TRIANGLE_STRIP:6,VTK_POLYGON:7,VTK_QUAD:9,VTK_QUADRATIC_EDGE:21,VTK_CONVEX_POINT_SET:41,VTK_POLYHEDRON:42},Ce=["vtkEmptyCell","vtkVertex","vtkPolyVertex","vtkLine","vtkPolyLine","vtkTriangle","vtkTriangleStrip","vtkPolygon","vtkPixel","vtkQuad","vtkTetra","vtkVoxel","vtkHexahedron","vtkWedge","vtkPyramid","vtkPentagonalPrism","vtkHexagonalPrism","UnknownClass","UnknownClass","UnknownClass","UnknownClass","vtkQuadraticEdge","vtkQuadraticTriangle","vtkQuadraticQuad","vtkQuadraticTetra","vtkQuadraticHexahedron","vtkQuadraticWedge","vtkQuadraticPyramid","vtkBiQuadraticQuad","vtkTriQuadraticHexahedron","vtkQuadraticLinearQuad","vtkQuadraticLinearWedge","vtkBiQuadraticQuadraticWedge","vtkBiQuadraticQuadraticHexahedron","vtkBiQuadraticTriangle","vtkCubicLine","vtkQuadraticPolygon","UnknownClass","UnknownClass","UnknownClass","UnknownClass","vtkConvexPointSet","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","vtkParametricCurve","vtkParametricSurface","vtkParametricTriSurface","vtkParametricQuadSurface","vtkParametricTetraRegion","vtkParametricHexRegion","UnknownClass","UnknownClass","UnknownClass","vtkHigherOrderEdge","vtkHigherOrderTriangle","vtkHigherOrderQuad","vtkHigherOrderPolygon","vtkHigherOrderTetrahedron","vtkHigherOrderWedge","vtkHigherOrderPyramid","vtkHigherOrderHexahedron"];function lo(e){return e<Ce.length?Ce[e]:"UnknownClass"}function go(e){return Ce.findIndex(e)}function ho(e){return e<U.VTK_QUADRATIC_EDGE||e===U.VTK_CONVEX_POINT_SET||e===U.VTK_POLYHEDRON}function yo(e){return e===U.VTK_TRIANGLE_STRIP||e===U.VTK_POLY_LINE||e===U.VTK_POLY_VERTEX}const po={getClassNameFromTypeId:lo,getTypeIdFromClassName:go,isLinear:ho,hasSubCells:yo};function vo(e,t){t.classHierarchy.push("vtkCellTypes"),e.allocate=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:512,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e3;t.size=n>0?n:1,t.extend=r>0?r:1,t.maxId=-1,t.typeArray=new Uint8Array(n),t.locationArray=new Uint32Array(n)},e.insertCell=(n,r,s)=>{t.typeArray[n]=r,t.locationArray[n]=s,n>t.maxId&&(t.maxId=n)},e.insertNextCell=(n,r)=>(e.insertCell(++t.maxId,n,r),t.maxId),e.setCellTypes=(n,r,s)=>{t.size=n,t.typeArray=r,t.locationArray=s,t.maxId=n-1},e.getCellLocation=n=>t.locationArray[n],e.deleteCell=n=>{t.typeArray[n]=U.VTK_EMPTY_CELL},e.getNumberOfTypes=()=>t.maxId+1,e.isType=n=>{const r=e.getNumberOfTypes();for(let s=0;s<r;++s)if(n===e.getCellType(s))return!0;return!1},e.insertNextType=n=>e.insertNextCell(n,-1),e.getCellType=n=>t.typeArray[n],e.reset=()=>{t.maxId=-1},e.deepCopy=n=>{e.allocate(n.getSize(),n.getExtend()),t.typeArray.set(n.getTypeArray()),t.locationArray.set(n.getLocationArray()),t.maxId=n.getMaxId()}}const mo={size:0,maxId:-1,extend:1e3};function ls(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(t,mo,n),N.obj(e,t),N.get(e,t,["size","maxId","extend"]),N.getArray(e,t,["typeArray","locationArray"]),vo(e,t)}const To=N.newInstance(ls,"vtkCellTypes");var wo={newInstance:To,extend:ls,...po};const Co={NO_INTERSECTION:0,YES_INTERSECTION:1,ON_LINE:2};var gs={IntersectionState:Co};const{IntersectionState:_t}=gs;function ht(e,t,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;const s={t:Number.MIN_VALUE,distance:0},a=[];let i;a[0]=n[0]-t[0],a[1]=n[1]-t[1],a[2]=n[2]-t[2];const c=a[0]*(e[0]-t[0])+a[1]*(e[1]-t[1])+a[2]*(e[2]-t[2]),o=V(a,a);let u=1e-5*c;return o!==0&&(s.t=c/o),u<0&&(u=-u),-u<o&&o<u||o<=0||s.t<0?i=t:s.t>1?i=n:(i=a,a[0]=t[0]+s.t*a[0],a[1]=t[1]+s.t*a[1],a[2]=t[2]+s.t*a[2]),r&&(r[0]=i[0],r[1]=i[1],r[2]=i[2]),s.distance=q(i,e),s}function hs(e,t,n,r,s,a){const i=[],c=[],o=[];s[0]=0,a[0]=0,tt(t,e,i),tt(r,n,c),tt(n,e,o);const u=[V(i,i),-V(i,c),-V(i,c),V(c,c)],f=[];if(f[0]=V(i,o),f[1]=-V(c,o),za(u,f,2)===0){let l=Number.MAX_VALUE;const g=[e,t,n,r],h=[n,n,e,e],y=[r,r,t,t];a[0],a[0],s[0],s[0],s[0],s[0],a[0],a[0];let p;for(let m=0;m<4;m++)p=ht(g[m],h[m],y[m]),p.distance<l&&(l=p.distance);return _t.ON_LINE}return s[0]=f[0],a[0]=f[1],s[0]>=0&&s[0]<=1&&a[0]>=0&&a[0]<=1?_t.YES_INTERSECTION:_t.NO_INTERSECTION}const Oo={distanceToLine:ht,intersection:hs};function xo(e,t){t.classHierarchy.push("vtkLine");function n(r){return r>=0&&r<=1}e.getCellDimension=()=>1,e.intersectWithLine=(r,s,a,i,c)=>{const o={intersect:0,t:Number.MAX_VALUE,subId:0,betweenPoints:null};c[1]=0,c[2]=0;const u=[],f=[],l=[];t.points.getPoint(0,f),t.points.getPoint(1,l);const g=[],h=[],y=hs(r,s,f,l,g,h);if(o.t=g[0],o.betweenPoints=n(o.t),c[0]=h[0],y===_t.YES_INTERSECTION){for(let p=0;p<3;p++)i[p]=f[p]+c[0]*(l[p]-f[p]),u[p]=r[p]+o.t*(s[p]-r[p]);if(q(i,u)<=a*a)return o.intersect=1,o}else{let p;if(o.t<0)return p=ht(r,f,l,i),p.distance<=a*a&&(o.t=0,o.intersect=1,o.betweenPoints=!0),o;if(o.t>1)return p=ht(s,f,l,i),p.distance<=a*a&&(o.t=1,o.intersect=1,o.betweenPoints=!0),o;if(c[0]<0)return c[0]=0,p=ht(f,r,s,i),o.t=p.t,p.distance<=a*a&&(o.intersect=1),o;if(c[0]>1)return c[0]=1,p=ht(l,r,s,i),o.t=p.t,p.distance<=a*a&&(o.intersect=1),o}return o},e.evaluateLocation=(r,s,a)=>{const i=[],c=[];t.points.getPoint(0,i),t.points.getPoint(1,c);for(let o=0;o<3;o++)s[o]=i[o]+r[0]*(c[o]-i[o]);a[0]=1-r[0],a[1]=r[0]},e.evaluateOrientation=(r,s,a)=>t.orientations?(Vt(s,t.orientations[0],t.orientations[1],r[0]),a[0]=1-r[0],a[1]=r[0],!0):!1}const Eo={orientations:null};function ys(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(t,Eo,n),Bt.extend(e,t,n),N.setGet(e,t,["orientations"]),xo(e,t)}const So=N.newInstance(ys,"vtkLine");var B={newInstance:So,extend:ys,...Oo,...gs};function Do(e,t){t.classHierarchy.push("vtkPointSet"),t.points?t.points=H(t.points):t.points=we.newInstance(),e.getNumberOfPoints=()=>t.points.getNumberOfPoints(),e.getBounds=()=>t.points.getBounds(),e.computeBounds=()=>{e.getBounds()};const n=e.shallowCopy;e.shallowCopy=function(r){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;n(r,s),t.points=we.newInstance(),t.points.shallowCopy(r.getPoints())}}const Lo={};function ps(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(t,Lo,n),es.extend(e,t,n),N.setGet(e,t,["points"]),Do(e,t)}const Mo=N.newInstance(ps,"vtkPointSet");var ko={newInstance:Mo,extend:ps};function Xe(e,t,n,r){const s=n[0]-t[0],a=n[1]-t[1],i=n[2]-t[2],c=e[0]-t[0],o=e[1]-t[1],u=e[2]-t[2];r[0]=a*u-i*o,r[1]=i*c-s*u,r[2]=s*o-a*c}function Kt(e,t,n,r){Xe(e,t,n,r);const s=Math.sqrt(r[0]*r[0]+r[1]*r[1]+r[2]*r[2]);s!==0&&(r[0]/=s,r[1]/=s,r[2]/=s)}function No(e,t,n,r,s,a){let i=arguments.length>6&&arguments[6]!==void 0?arguments[6]:1e-6,c=!1;const o=[],u=[],f=[],l=[],g=[];Kt(e,t,n,l),Kt(r,s,a,g);const h=-V(l,e),y=-V(g,r),p=[V(g,e)+y,V(g,t)+y,V(g,n)+y];if(p[0]*p[1]>i&&p[0]*p[2]>i)return{intersect:!1,coplanar:c,pt1:o,pt2:u,surfaceId:f};const m=[V(l,r)+h,V(l,s)+h,V(l,a)+h];if(m[0]*m[1]>i&&m[0]*m[2]>i)return{intersect:!1,coplanar:c,pt1:o,pt2:u,surfaceId:f};if(Math.abs(l[0]-g[0])<1e-9&&Math.abs(l[1]-g[1])<1e-9&&Math.abs(l[2]-g[2])<1e-9&&Math.abs(h-y)<1e-9)return c=!0,{intersect:!1,coplanar:c,pt1:o,pt2:u,surfaceId:f};const C=[e,t,n],E=[r,s,a],v=V(l,g),d=(h-y*v)/(v*v-1),O=(y-h*v)/(v*v-1),w=[d*l[0]+O*g[0],d*l[1]+O*g[1],d*l[2]+O*g[2]],x=pr(l,g,[]);Ra(x);let T=0,L=0;const S=[],M=[];let k=50,$=50;for(let F=0;F<3;F++){const b=F,ct=(F+1)%3,K=it.intersectWithLine(C[b],C[ct],r,g);K.intersection&&K.t>0-i&&K.t<1+i&&(K.t<1+i&&K.t>1-i&&(k=T),S[T++]=V(K.x,x)-V(w,x));const X=it.intersectWithLine(E[b],E[ct],e,l);X.intersection&&X.t>0-i&&X.t<1+i&&(X.t<1+i&&X.t>1-i&&($=L),M[L++]=V(X.x,x)-V(w,x))}if(T>2){T--;const F=S[2];S[2]=S[k],S[k]=F}if(L>2){L--;const F=M[2];M[2]=M[$],M[$]=F}if(T!==2||L!==2)return{intersect:!1,coplanar:c,pt1:o,pt2:u,surfaceId:f};if(Number.isNaN(S[0])||Number.isNaN(S[1])||Number.isNaN(M[0])||Number.isNaN(M[1]))return{intersect:!1,coplanar:c,pt1:o,pt2:u,surfaceId:f};if(S[0]>S[1]){const F=S[1];S[1]=S[0],S[0]=F}if(M[0]>M[1]){const F=M[1];M[1]=M[0],M[0]=F}let D,_;return S[1]<M[0]||M[1]<S[0]?{intersect:!1,coplanar:c,pt1:o,pt2:u,surfaceId:f}:(S[0]<M[0]?S[1]<M[1]?(f[0]=2,f[1]=1,D=M[0],_=S[1]):(f[0]=2,f[1]=2,D=M[0],_=M[1]):S[1]<M[1]?(f[0]=1,f[1]=1,D=S[0],_=S[1]):(f[0]=1,f[1]=2,D=S[0],_=M[1]),fn(w,x,D,o),fn(w,x,_,u),{intersect:!0,coplanar:c,pt1:o,pt2:u,surfaceId:f})}const $o={computeNormalDirection:Xe,computeNormal:Kt,intersectWithTriangle:No};function Vo(e,t){t.classHierarchy.push("vtkTriangle"),e.getCellDimension=()=>2,e.intersectWithLine=(n,r,s,a,i)=>{const c={subId:0,t:Number.MAX_VALUE,intersect:0,betweenPoints:!1};i[2]=0;const o=[],u=s*s,f=[],l=[],g=[];t.points.getPoint(0,f),t.points.getPoint(1,l),t.points.getPoint(2,g);const h=[],y=[];if(Kt(f,l,g,h),h[0]!==0||h[1]!==0||h[2]!==0){const v=it.intersectWithLine(n,r,f,h);if(c.betweenPoints=v.betweenPoints,c.t=v.t,a[0]=v.x[0],a[1]=v.x[1],a[2]=v.x[2],!v.intersection)return i[0]=0,i[1]=0,c.intersect=0,c;const d=e.evaluatePosition(a,o,i,y);if(d.evaluation>=0)return d.dist2<=u?(c.intersect=1,c):(c.intersect=d.evaluation,c)}const p=q(f,l),m=q(l,g),C=q(g,f);t.line||(t.line=B.newInstance()),p>m&&p>C?(t.line.getPoints().setPoint(0,f),t.line.getPoints().setPoint(1,l)):m>C&&m>p?(t.line.getPoints().setPoint(0,l),t.line.getPoints().setPoint(1,g)):(t.line.getPoints().setPoint(0,g),t.line.getPoints().setPoint(1,f));const E=t.line.intersectWithLine(n,r,s,a,i);if(c.betweenPoints=E.betweenPoints,c.t=E.t,E.intersect){const v=[],d=[],O=[];for(let w=0;w<3;w++)v[w]=f[w]-g[w],d[w]=l[w]-g[w],O[w]=a[w]-g[w];return i[0]=V(O,v)/C,i[1]=V(O,d)/m,c.intersect=1,c}return i[0]=0,i[1]=0,c.intersect=0,c},e.evaluatePosition=(n,r,s,a)=>{const i={subId:0,dist2:0,evaluation:-1};let c,o;const u=[],f=[],l=[],g=[];let h;const y=[],p=[],m=[];let C=0,E=0;const v=[];let d,O,w,x=[];const T=[],L=[],S=[];i.subId=0,s[2]=0,t.points.getPoint(1,u),t.points.getPoint(2,f),t.points.getPoint(0,l),Xe(u,f,l,g),it.generalizedProjectPoint(n,u,g,S);let M=0;for(c=0;c<3;c++)g[c]<0?h=-g[c]:h=g[c],h>M&&(M=h,E=c);for(o=0,c=0;c<3;c++)c!==E&&(v[o++]=c);for(c=0;c<2;c++)y[c]=S[v[c]]-l[v[c]],p[c]=u[v[c]]-l[v[c]],m[c]=f[v[c]]-l[v[c]];if(C=$t(p,m),C===0)return s[0]=0,s[1]=0,i.evaluation=-1,i;if(s[0]=$t(y,m)/C,s[1]=$t(p,y)/C,a[0]=1-(s[0]+s[1]),a[1]=s[0],a[2]=s[1],a[0]>=0&&a[0]<=1&&a[1]>=0&&a[1]<=1&&a[2]>=0&&a[2]<=1)r&&(i.dist2=q(S,n),r[0]=S[0],r[1]=S[1],r[2]=S[2]),i.evaluation=1;else{let k;if(r){if(a[1]<0&&a[2]<0)for(d=q(n,l),O=B.distanceToLine(n,u,l,k,T),w=B.distanceToLine(n,l,f,k,L),d<O?(i.dist2=d,x=l):(i.dist2=O,x=T),w<i.dist2&&(i.dist2=w,x=L),c=0;c<3;c++)r[c]=x[c];else if(a[2]<0&&a[0]<0)for(d=q(n,u),O=B.distanceToLine(n,u,l,k,T),w=B.distanceToLine(n,u,f,k,L),d<O?(i.dist2=d,x=u):(i.dist2=O,x=T),w<i.dist2&&(i.dist2=w,x=L),c=0;c<3;c++)r[c]=x[c];else if(a[1]<0&&a[0]<0)for(d=q(n,f),O=B.distanceToLine(n,f,l,k,T),w=B.distanceToLine(n,u,f,k,L),d<O?(i.dist2=d,x=f):(i.dist2=O,x=T),w<i.dist2&&(i.dist2=w,x=L),c=0;c<3;c++)r[c]=x[c];else if(a[0]<0){const $=B.distanceToLine(n,u,f,r);i.dist2=$.distance}else if(a[1]<0){const $=B.distanceToLine(n,f,l,r);i.dist2=$.distance}else if(a[2]<0){const $=B.distanceToLine(n,u,l,r);i.dist2=$.distance}}i.evaluation=0}return i},e.evaluateLocation=(n,r,s)=>{const a=[],i=[],c=[];t.points.getPoint(0,a),t.points.getPoint(1,i),t.points.getPoint(2,c);const o=1-n[0]-n[1];for(let u=0;u<3;u++)r[u]=a[u]*o+i[u]*n[0]+c[u]*n[1];s[0]=o,s[1]=n[0],s[2]=n[1]},e.getParametricDistance=n=>{let r,s=0;const a=[];a[0]=n[0],a[1]=n[1],a[2]=1-n[0]-n[1];for(let i=0;i<3;i++)a[i]<0?r=-a[i]:a[i]>1?r=a[i]-1:r=0,r>s&&(s=r);return s}}const _o={};function vs(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(t,_o,n),Bt.extend(e,t,n),Vo(e,t)}const Fo=N.newInstance(vs,"vtkTriangle");var Uo={newInstance:Fo,extend:vs,...$o};const ue=["verts","lines","polys","strips"],{vtkWarningMacro:Cn}=N,Ro={[U.VTK_LINE]:B,[U.VTK_POLY_LINE]:B,[U.VTK_TRIANGLE]:Uo};function jo(e,t){t.classHierarchy.push("vtkPolyData");function n(s){return s.replace(/(?:^\w|[A-Z]|\b\w)/g,a=>a.toUpperCase()).replace(/\s+/g,"")}ue.forEach(s=>{e[`getNumberOf${n(s)}`]=()=>t[s].getNumberOfCells(),t[s]?t[s]=H(t[s]):t[s]=wn.newInstance()}),e.getNumberOfCells=()=>ue.reduce((s,a)=>s+t[a].getNumberOfCells(),0);const r=e.shallowCopy;e.shallowCopy=function(s){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;r(s,a),ue.forEach(i=>{t[i]=wn.newInstance(),t[i].shallowCopy(s.getReferenceByName(i))})},e.buildCells=()=>{const s=e.getNumberOfVerts(),a=e.getNumberOfLines(),i=e.getNumberOfPolys(),c=e.getNumberOfStrips(),o=s+a+i+c,u=new Uint8Array(o);let f=u;const l=new Uint32Array(o);let g=l;if(s){let h=0;t.verts.getCellSizes().forEach((y,p)=>{g[p]=h,f[p]=y>1?U.VTK_POLY_VERTEX:U.VTK_VERTEX,h+=y+1}),g=g.subarray(s),f=f.subarray(s)}if(a){let h=0;t.lines.getCellSizes().forEach((y,p)=>{g[p]=h,f[p]=y>2?U.VTK_POLY_LINE:U.VTK_LINE,y===1&&Cn("Building VTK_LINE ",p," with only one point, but VTK_LINE needs at least two points. Check the input."),h+=y+1}),g=g.subarray(a),f=f.subarray(a)}if(i){let h=0;t.polys.getCellSizes().forEach((y,p)=>{switch(g[p]=h,y){case 3:f[p]=U.VTK_TRIANGLE;break;case 4:f[p]=U.VTK_QUAD;break;default:f[p]=U.VTK_POLYGON;break}y<3&&Cn("Building VTK_TRIANGLE ",p," with less than three points, but VTK_TRIANGLE needs at least three points. Check the input."),h+=y+1}),g+=g.subarray(i),f+=f.subarray(i)}if(c){let h=0;f.fill(U.VTK_TRIANGLE_STRIP,0,c),t.strips.getCellSizes().forEach((y,p)=>{g[p]=h,h+=y+1})}t.cells=wo.newInstance(),t.cells.setCellTypes(o,u,l)},e.buildLinks=function(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;t.cells===void 0&&e.buildCells(),t.links=fo.newInstance(),s>0?t.links.allocate(s):t.links.allocate(e.getPoints().getNumberOfPoints()),t.links.buildLinks(e)},e.getCellType=s=>t.cells.getCellType(s),e.getCellPoints=s=>{const a=e.getCellType(s);let i=null;switch(a){case U.VTK_VERTEX:case U.VTK_POLY_VERTEX:i=t.verts;break;case U.VTK_LINE:case U.VTK_POLY_LINE:i=t.lines;break;case U.VTK_TRIANGLE:case U.VTK_QUAD:case U.VTK_POLYGON:i=t.polys;break;case U.VTK_TRIANGLE_STRIP:i=t.strips;break;default:return i=null,{type:0,cellPointIds:null}}const c=t.cells.getCellLocation(s),o=i.getCell(c);return{cellType:a,cellPointIds:o}},e.getPointCells=s=>t.links.getCells(s),e.getCellEdgeNeighbors=(s,a,i)=>{const c=t.links.getLink(a),o=t.links.getLink(i);return c.cells.filter(u=>u!==s&&o.cells.indexOf(u)!==-1)},e.getCell=function(s){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const i=e.getCellPoints(s),c=a||Ro[i.cellType].newInstance();return c.initialize(e.getPoints(),i.cellPointIds),c}}const Io={};function ms(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(t,Io,n),ko.extend(e,t,n),N.get(e,t,["cells","links"]),N.setGet(e,t,["verts","lines","polys","strips"]),jo(e,t)}const zo=N.newInstance(ms,"vtkPolyData");var Ye={newInstance:zo,extend:ms};const{vtkErrorMacro:On}=hr;function Ao(e){const t=e.getPolys().getData(),n=e.getStrips().getData(),r={cellSize:0,cell:[],done:!1,polyIdx:0,stripIdx:0,remainingStripLength:0,next(){if(r.polyIdx<t.length){r.cellSize=t[r.polyIdx];const s=r.polyIdx+1,a=s+r.cellSize;r.polyIdx=a;let i=0;for(let c=s;c<a;++c)r.cell[i++]=t[c]}else if(r.stripIdx<n.length){r.cellSize=3,r.remainingStripLength===0&&(r.remainingStripLength=n[r.stripIdx]-2,r.stripIdx+=3);const s=r.stripIdx-2,a=r.stripIdx+1;r.stripIdx++,r.remainingStripLength--;let i=0;for(let c=s;c<a;++c)r.cell[i++]=n[c]}else if(!r.done)r.done=!0;else throw new Error("Iterator is done")}};return r.next(),r}function bo(e,t){t.classHierarchy.push("vtkCutter");const n={...e};e.getMTime=()=>{let s=n.getMTime();return t.cutFunction&&(s=Math.max(s,t.cutFunction.getMTime())),s};function r(s,a){const i=s.getPoints(),c=i.getData(),o=i.getNumberOfPoints(),u=[],f=[],l=[];(!t.cutScalars||t.cutScalars.length<o)&&(t.cutScalars=new Float32Array(o));let g=0,h=0;for(;g<c.length;)t.cutScalars[h++]=t.cutFunction.evaluateFunction(c[g++],c[g++],c[g++]);const y=[],p=new Array(3),m=new Array(3),C=[];for(const v=Ao(s);!v.done;v.next()){if(v.cellSize<=2)continue;for(let T=0;T<v.cellSize;)C[T]=t.cutScalars[v.cell[T++]];const d=C[0]>0;let O=!0;for(let T=1;T<v.cell.length;T++)if(C[T]>0!==d){O=!1;break}if(O)continue;const w=[];for(let T=0;T<v.cellSize;T++){const L=T+1===v.cellSize?0:T+1,S=C[T]>0;if(C[L]>0===S)continue;let k=T,$=L,D=C[$]-C[k];D<=0&&(k=L,$=T,D*=-1);let _=0;D!==0&&(_=(t.cutValue-C[k])/D);const F=v.cell[k],b=v.cell[$];p[0]=c[F*3],p[1]=c[F*3+1],p[2]=c[F*3+2],m[0]=c[b*3],m[1]=c[b*3+1],m[2]=c[b*3+2];const ct=[p[0]+_*(m[0]-p[0]),p[1]+_*(m[1]-p[1]),p[2]+_*(m[2]-p[2])];w.push({pointEdge1:F,pointEdge2:b,intersectedPoint:ct,newPointID:-1})}for(let T=0;T<w.length;T++){const L=w[T];let S=!1;for(let M=0;M<y.length;M++){const k=y[M],$=L.pointEdge1===k.pointEdge1&&L.pointEdge2===k.pointEdge2,D=L.intersectedPoint[0]===k.intersectedPoint[0]&&L.intersectedPoint[1]===k.intersectedPoint[1]&&L.intersectedPoint[2]===k.intersectedPoint[2];if($||D){S=!0,w[T].newPointID=y[M].newPointID;break}}S||(u.push(L.intersectedPoint[0]),u.push(L.intersectedPoint[1]),u.push(L.intersectedPoint[2]),w[T].newPointID=u.length/3-1,y.push(w[T]))}const x=w.length;x===2?f.push(x,w[0].newPointID,w[1].newPointID):x>2&&(l.push(x),w.forEach(T=>{l.push(T.newPointID)}))}a.getPoints().setData(Wt(i.getDataType(),u),3),f.length!==0&&a.getLines().setData(Uint16Array.from(f)),l.length!==0&&a.getPolys().setData(Uint16Array.from(l))}e.requestData=(s,a)=>{const i=s[0];if(!i){On("Invalid or missing input");return}if(!t.cutFunction){On("Missing cut function");return}const c=Ye.newInstance();r(i,c),a[0]=c}}const Bo={cutFunction:null,cutScalars:null,cutValue:0};function ds(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(t,Bo,n),Xt(e,t),Me(e,t,1,1),Jt(e,t,["cutFunction","cutValue"]),bo(e,t)}const Ko=qt(ds,"vtkCutter");var Go={newInstance:Ko,extend:ds};function xt(e,t){return e.worldToIndex(t).map(Math.round)}class Wo{constructor(t,n,r=1){this.rows=new Map,this.height=1,this.width=1,this.depth=1,this.jMultiple=1,this.kMultiple=1,this.numComps=1,this.defaultValue=0,this.pixelDataConstructor=Uint8Array,this.get=s=>{const a=s%this.jMultiple,i=(s-a)/this.jMultiple;return this.getRLE(a,i)?.value||this.defaultValue},this.getRun=(s,a)=>{const i=s+a*this.height;return this.rows.get(i)},this.set=(s,a)=>{if(a===void 0)throw new Error(`Can't set undefined at ${s%this.width}`);const i=s%this.width,c=(s-i)/this.width,o=this.rows.get(c);if(!o){this.rows.set(c,[{start:i,end:i+1,value:a}]);return}const u=this.findIndex(o,i),f=o[u],l=o[u-1];if(!f){if(!l||l.value!==a||l.end!==i){o[u]={start:i,end:i+1,value:a};return}l.end++;return}const{start:g,end:h,value:y}=f;if(a===y&&i>=g)return;const p={start:i,end:i+1,value:a},m=i>g,C=m?u+1:u,E=m?f:l;let v=m?o[u+1]:f;if(E?.value===a&&E?.end===i){E.end++,v?.value===a&&v.start===i+1?(E.end=v.end,o.splice(u,1)):v?.start===i&&(v.start++,v.start===v.end&&(o.splice(u,1),v=o[u],v?.start===i+1&&v.value===a&&(E.end=v.end,o.splice(u,1))));return}if(v?.value===a&&v.start===i+1){v.start--,E?.end>i&&(E.end=i,E.end===E.start&&o.splice(u,1));return}if(v?.start===i&&v.end===i+1){v.value=a;const d=o[u+1];d?.start==i+1&&d.value===a&&(o.splice(u+1,1),v.end=d.end);return}i===v?.start&&v.start++,m&&h>i+1?o.splice(C,0,p,{start:i+1,end:E.end,value:E.value}):o.splice(C,0,p),E?.end>i&&(E.end=i)},this.width=t,this.height=n,this.depth=r,this.jMultiple=t,this.kMultiple=this.jMultiple*n}getRLE(t,n,r=0){const s=this.rows.get(n+r*this.height);if(!s)return;const a=this.findIndex(s,t),i=s[a];return t>=i?.start?i:void 0}findIndex(t,n){for(let r=0;r<t.length;r++){const{end:s}=t[r];if(n<s)return r}return t.length}clear(){this.rows.clear()}keys(){return[...this.rows.keys()]}getPixelData(t=0,n){n?n.fill(0):n=new this.pixelDataConstructor(this.width*this.height*this.numComps);const{width:r,height:s,numComps:a}=this;for(let i=0;i<s;i++){const c=this.getRun(i,t);if(c)if(a===1)for(const o of c){const u=i*r,{start:f,end:l,value:g}=o;for(let h=f;h<l;h++)n[u+h]=g}else for(const o of c){const u=i*r*a,{start:f,end:l,value:g}=o;for(let h=f;h<l;h+=a)for(let y=0;y<a;y++)n[u+h+y]=g[y]}}return n}}const Ho=5*1024;class I{constructor(t,n,r){this.modifiedSlices=new Set,this.boundsIJK=[[1/0,-1/0],[1/0,-1/0],[1/0,-1/0]],this.numComps=1,this.getAtIJK=(s,a,i)=>{const c=s+a*this.width+i*this.frameSize;return this._get(c)},this.setAtIJK=(s,a,i,c)=>{const o=s+a*this.width+i*this.frameSize;this._set(o,c)!==!1&&(this.modifiedSlices.add(i),I.addBounds(this.boundsIJK,[s,a,i]))},this.getAtIJKPoint=([s,a,i])=>this.getAtIJK(s,a,i),this.setAtIJKPoint=([s,a,i],c)=>this.setAtIJK(s,a,i,c),this.getAtIndex=s=>this._get(s),this.setAtIndex=(s,a)=>{if(this._set(s,a)!==!1){const i=this.toIJK(s);this.modifiedSlices.add(i[2]),I.addBounds(this.boundsIJK,i)}},this.forEach=(s,a)=>{const i=a?.boundsIJK||this.getBoundsIJK(),{isWithinObject:c}=a||{};if(this.map)for(const o of this.map.keys()){const u=this.toIJK(o),l={value:this._get(o),index:o,pointIJK:u};c?.(l)!==!1&&s(l)}else for(let o=i[2][0];o<=i[2][1];o++){const u=o*this.frameSize;for(let f=i[1][0];f<=i[1][1];f++){const l=u+f*this.width;for(let g=i[0][0],h=l+g;g<=i[0][1];g++,h++){const p={value:this.getAtIndex(h),index:h,pointIJK:[g,f,o]};c?.(p)!==!1&&s(p)}}}},this.dimensions=t,this.width=t[0],this.frameSize=this.width*t[1],this._get=n,this._set=r}addPoint(t){const n=Array.isArray(t)?t[0]+this.width*t[1]+this.frameSize*t[2]:t;this.points||(this.points=new Set),this.points.add(n)}getPoints(){return this.points?[...this.points].map(t=>this.toIJK(t)):[]}getPointIndices(){return this.points?[...this.points]:[]}toIJK(t){return[t%this.width,Math.floor(t%this.frameSize/this.width),Math.floor(t/this.frameSize)]}toIndex(t){return t[0]+t[1]*this.width+t[2]*this.frameSize}getBoundsIJK(){return this.boundsIJK[0][0]<this.dimensions[0]?this.boundsIJK:this.dimensions.map(t=>[0,t-1])}clear(){this.map&&this.map.clear(),this.boundsIJK.map(t=>{t[0]=1/0,t[1]=-1/0}),this.modifiedSlices.clear(),this.points?.clear()}getArrayOfSlices(){return Array.from(this.modifiedSlices)}static addBounds(t,n){t||(t=[[1/0,-1/0],[1/0,-1/0],[1/0,-1/0]]),t[0][0]=Math.min(n[0],t[0][0]),t[0][1]=Math.max(n[0],t[0][1]),t[1][0]=Math.min(n[1],t[1][0]),t[1][1]=Math.max(n[1],t[1][1]),t[2][0]=Math.min(n[2],t[2][0]),t[2][1]=Math.max(n[2],t[2][1])}static createRGBVolumeVoxelManager(t,n,r){const s=new I(t,a=>(a*=r,[n[a++],n[a++],n[a++]]),(a,i)=>{a*=3;const c=!Xi(n[a],i);return n[a++]=i[0],n[a++]=i[1],n[a++]=i[2],c});return s.numComps=r,s.scalarData=n,s}static createVolumeVoxelManager(t,n,r=0){if(t.length!==3)throw new Error("Dimensions must be provided as [number, number, number] for [width, height, depth]");if(!r&&(r=n.length/t[0]/t[1]/t[2],r>4||r<1||r===2))throw new Error(`Number of components ${r} must be 1, 3 or 4`);return r>1?I.createRGBVolumeVoxelManager(t,n,r):I.createNumberVolumeVoxelManager(t,n)}static createNumberVolumeVoxelManager(t,n){const r=new I(t,s=>n[s],(s,a)=>{const i=n[s]!==a;return n[s]=a,i});return r.scalarData=n,r}static createMapVoxelManager(t){const n=new Map,r=new I(t,n.get.bind(n),(s,a)=>n.set(s,a)&&!0);return r.map=n,r}static createHistoryVoxelManager(t){const n=new Map,{dimensions:r}=t,s=new I(r,a=>n.get(a),function(a,i){if(n.has(a))i===n.get(a)&&n.delete(a);else{const c=this.sourceVoxelManager.getAtIndex(a);if(c===i)return!1;n.set(a,c)}this.sourceVoxelManager.setAtIndex(a,i)});return s.map=n,s.scalarData=t.scalarData,s.sourceVoxelManager=t,s}static createLazyVoxelManager(t,n){const r=new Map,[s,a,i]=t,c=s*a,o=new I(t,u=>r.get(Math.floor(u/c))?.[u%c],(u,f)=>{const l=Math.floor(u/c);let g=r.get(l);g||(g=n(s,a),r.set(l,g)),g[u%c]=f});return o.map=r,o}static createRLEVoxelManager(t){const[n,r,s]=t,a=new Wo(n,r,s),i=new I(t,c=>a.get(c),(c,o)=>a.set(c,o));return i.map=a,i.getPixelData=a.getPixelData.bind(a),i}static addInstanceToImage(t){const{width:n,height:r}=t,s=t.getPixelData();if(s?.length>=n*r){t.voxelManager=I.createVolumeVoxelManager([n,r,1],s);return}t.voxelManager=I.createRLEVoxelManager([n,r,1]),t.getPixelData=t.voxelManager.getPixelData,t.sizeInBytes=Ho}}function Xo(e,t){const n=[...e];return t>=n.length?(xn(n),n):(xn(n),n.slice(0,t))}function xn(e){for(let t=e.length-1;t>0;t--){const n=Math.floor(Math.random()*(t+1));[e[t],e[n]]=[e[n],e[t]]}}const En={Forward:1,Backward:-1},Et=new Set;function Yo(e,t){e.requestData=(n,r)=>{const[s]=n;r[0]||(r[0]=Ye.newInstance());const[a]=r;e.extractContours(s,a),a.modified()},e.traverseLoop=(n,r,s,a,i)=>{let c=s,o=a,u=!1,f=0;for(;!u;){const{cellPointIds:l}=n.getCellPoints(c);if(!l)continue;o=l[0]!==o?l[0]:l[1],f++;const g=r*f;i.push({t:g,ptId:o});const h=n.getPointCells(o);if(h.length!==2||o===a)return o;h.length===2?(c=h[0]!==c?h[0]:h[1],Et.add(c)):u=!0}return o},e.extractContours=(n,r)=>{const s=[];Et.clear();const a=n.getLines();r.getPoints().setData(Float32Array.from(n.getPoints().getData()));for(let c=0;c<a.getNumberOfCells();c++){if(Et.has(c))continue;const{cellPointIds:o}=n.getCellPoints(c);if(!o)continue;Et.add(c);const u=o[0],f=[];f.push({t:0,ptId:u});const l=e.traverseLoop(n,En.Forward,c,u,f);u!==l&&(e.traverseLoop(n,En.Backward,c,u,f),f.sort((g,h)=>g.t<h.t?-1:1),f.length&&f[0].ptId!==f[f.length-1]?.ptId&&f.push({...f[f.length-1]})),f.length&&s.push(f)}const i=r.getLines();i.resize(0),s.forEach(c=>{i.insertNextCell(c.map(o=>o.ptId))})}}const Jo={};function Ts(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(t,Jo,n),N.obj(e,t),N.algo(e,t,1,1),Yo(e)}const qo=N.newInstance(Ts,"vtkContourLoopExtraction");var Qo={newInstance:qo,extend:Ts};function Zo(e,t,n=!1){let r=1/0,s=n?-1/0:0,a=1/0,i=n?-1/0:0,c=1/0,o=n?-1/0:0;const u=e[0]?.length===3;for(let f=0;f<e.length;f++){const l=e[f];r=Math.min(l[0],r),s=Math.max(l[0],s),a=Math.min(l[1],a),i=Math.max(l[1],i),u&&(c=Math.min(l[2]??c,c),o=Math.max(l[2]??o,o))}return n||(r=Math.max(0,r),s=Math.min(1/0,s),a=Math.max(0,a),i=Math.min(1/0,i),u&&(c=Math.max(0,c),o=Math.min(1/0,o))),u?[[r,s],[a,i],[c,o]]:[[r,s],[a,i],null]}function Sn(e,t){return Zo(e,t,!0)}function fe(e,t,n,r){let s,a,i,c,o,u,f;const{numComps:l}=e;if(e.getScalarData?f=e.getScalarData():f=e.getPointData().getScalars().getData(),!f){console.warn("No scalar data found for imageData",e);return}const g=e.getDimensions();r?[[s,a],[i,c],[o,u]]=r:(s=0,a=g[0],i=0,c=g[1],o=0,u=g[2]);const h=z(s,i,o),y=e.getDirection(),p=y.slice(0,3),m=y.slice(3,6),C=y.slice(6,9),E=e.getSpacing(),[v,d,O]=E,w=e.indexToWorld(h),x=z(p[0]*v,p[1]*v,p[2]*v),T=z(m[0]*d,m[1]*d,m[2]*d),L=z(C[0]*O,C[1]*O,C[2]*O),S=l||f.length/g[2]/g[1]/g[0],M=g[0]*S,k=g[1]*M,$=[],D=ae(w);for(let _=o;_<=u;_++){const F=ae(D);for(let b=i;b<=c;b++){const ct=ae(D);for(let K=s;K<=a;K++){const X=[K,b,_];if(t(D,X)){const ut=_*k+b*M+K*S;let mt;S>2?mt=[f[ut],f[ut+1],f[ut+2]]:mt=f[ut],$.push({value:mt,index:ut,pointIJK:X,pointLPS:D.slice()}),n&&n({value:mt,index:ut,pointIJK:X,pointLPS:D})}ie(D,D,x)}hn(D,ct),ie(D,D,T)}hn(D,F),ie(D,D,L)}return $}function Po(e,t){if(e.length!==t.length)throw Error("Both points should have the same dimensionality");const[n,r,s=0]=e,[a,i,c=0]=t,o=a-n,u=i-r,f=c-s;return o*o+u*u+f*f}function tc(e){if(e.length<3)return!1;const t=e.length,n=e[0],r=e[t-1],s=Po(n,r);return ba(0,s)}function Oe(e,t,n={closed:void 0}){if(e.length<3)return!1;const r=e.length;let s=0;const{closed:a,holes:i}=n;if(i?.length){for(const u of i)if(Oe(u,t))return!1}const c=!(a===void 0?tc(e):a),o=e.length-(c?1:2);for(let u=0;u<=o;u++){const f=e[u],l=u===r-1?0:u+1,g=e[l],h=f[0]>=g[0]?f[0]:g[0],y=f[1]>=g[1]?f[1]:g[1],p=f[1]<=g[1]?f[1]:g[1];if(t[0]<=h&&t[1]>=p&&t[1]<y){let E=f[0]===g[0];if(!E){const v=(t[1]-f[1])*(g[0]-f[0])/(g[1]-f[1])+f[0];E=t[0]<=v}s+=E?1:0}}return!!(s%2)}function Dn(e,t){let n=e;const r=t?.numDimensions||2,s=r===3;if(!Array.isArray(e[0])){const l=e,g=l.length/r;n=new Array(l.length/r);for(let h=0,y=g;h<y;h++)n[h]=[l[h*r],l[h*r+1]],s&&n[h].push(l[h*r+2])}let a=1/0,i=1/0,c=-1/0,o=-1/0,u=1/0,f=-1/0;n=n;for(let l=0,g=n.length;l<g;l++){const[h,y,p]=n[l];a=a<h?a:h,i=i<y?i:y,c=c>h?c:h,o=o>y?o:y,s&&(u=u<p?u:p,f=f>p?f:p)}return s?{minX:a,maxX:c,minY:i,maxY:o,minZ:u,maxZ:f}:{minX:a,maxX:c,minY:i,maxY:o}}const ec=1e-6;function St(e){let t;const n=Xo(e,50);for(let i=0;i<3;i++)if(n.every((c,o,u)=>Math.abs(c[i]-u[0][i])<ec)){t=i;break}if(t===void 0)throw new Error("Cannot find a shared dimension index for polyline, probably oblique plane");const r=[],s=(t+1)%3,a=(t+2)%3;for(let i=0;i<e.length;i++)r.push([e[i][s],e[i][a]]);return{sharedDimensionIndex:t,projectedPolyline:r}}const nc=(e,t,n,r,s,a,i,c)=>{const o=[z(n,r,s),z(a,r,s),z(n,i,s),z(a,i,s),z(n,r,c),z(a,r,c),z(n,i,c),z(a,i,c)],u=z(t[0],t[1],t[2]),f=z(e[0],e[1],e[2]),l=-pe(u,f);let g=null;for(const h of o){const y=pe(u,h)+l;if(g===null)g=Math.sign(y);else if(Math.sign(y)!==g)return!0}return!1},rc={polySeg:null,polySegInitializing:!1,polySegInitializingPromise:null,async initializePolySeg(e){if(this.polySegInitializing){await this.polySegInitializingPromise;return}this.polySeg?.instance||(this.polySegInitializing=!0,this.polySegInitializingPromise=new Promise(t=>{this.polySeg=new ce,this.polySeg.initialize({updateProgress:e}).then(()=>{this.polySegInitializing=!1,t()})}),await this.polySegInitializingPromise)},async convertContourToSurface(e,...t){const{polylines:n,numPointsArray:r}=e,[s]=t;return await this.initializePolySeg(s),await this.polySeg.instance.convertContourRoiToSurface(n,r)},async convertLabelmapToSurface(e,...t){const[n]=t;return await this.initializePolySeg(n),this.polySeg.instance.convertLabelmapToSurface(e.scalarData,e.dimensions,e.spacing,e.direction,e.origin,[e.segmentIndex])},async convertContourToVolumeLabelmap(e,...t){const[n]=t;await(await new ce).initialize({updateProgress:n});const{segmentIndices:s,scalarData:a,annotationUIDsInSegmentMap:i,dimensions:c,origin:o,direction:u,spacing:f}=e,l=I.createVolumeVoxelManager(c,a),g=Ot.newInstance();g.setDimensions(c),g.setOrigin(o),g.setDirection(u),g.setSpacing(f);const h=Q.newInstance({name:"Pixels",numberOfComponents:1,values:a});g.getPointData().setScalars(h),g.modified();for(const y of s){const p=i.get(y);for(const m of p){if(!m.polyline)continue;const{polyline:C,holesPolyline:E}=m,v=Sn(C),[d,O,w]=xt(g,[v[0][0],v[1][0],v[2][0]]),[x,T,L]=xt(g,[v[0][1],v[1][1],v[2][1]]),{projectedPolyline:S,sharedDimensionIndex:M}=St(C),k=E?.map(_=>{const{projectedPolyline:F}=St(_);return F}),$=(M+1)%3,D=(M+2)%3;fe(g,_=>{const F=[_[$],_[D]];return Oe(S,F,{holes:k})},({pointIJK:_})=>{l.setAtIJKPoint(_,y)},[[d,x],[O,T],[w,L]])}}return l.scalarData},async convertContourToStackLabelmap(e,...t){const[n]=t;await(await new ce).initialize({updateProgress:n});const{segmentationsInfo:s,annotationUIDsInSegmentMap:a,segmentIndices:i}=e,c=new Map;s.forEach((o,u)=>{const{dimensions:f,scalarData:l,direction:g,spacing:h,origin:y}=o,p=I.createVolumeVoxelManager(f,l),m=Ot.newInstance();m.setDimensions(f),m.setOrigin(y),m.setDirection(g),m.setSpacing(h);const C=Q.newInstance({name:"Pixels",numberOfComponents:1,values:l});m.getPointData().setScalars(C),m.modified(),c.set(u,{manager:p,imageData:m})});for(const o of i){const u=a.get(o);for(const f of u){if(!f.polyline)continue;const{polyline:l,holesPolyline:g,referencedImageId:h}=f,y=Sn(l),{manager:p,imageData:m}=c.get(h),[C,E,v]=xt(m,[y[0][0],y[1][0],y[2][0]]),[d,O,w]=xt(m,[y[0][1],y[1][1],y[2][1]]),{projectedPolyline:x,sharedDimensionIndex:T}=St(l),L=g?.map(k=>{const{projectedPolyline:$}=St(k);return $}),S=(T+1)%3,M=(T+2)%3;fe(m,k=>{const $=[k[S],k[M]];return Oe(x,$,{holes:L})},({pointIJK:k})=>{p.setAtIJKPoint(k,o)},[[C,d],[E,O],[v,w]])}}return s.forEach((o,u)=>{const{manager:f}=c.get(u);o.scalarData=f.scalarData}),s},async convertSurfaceToVolumeLabelmap(e,...t){const[n]=t;return await this.initializePolySeg(n),this.polySeg.instance.convertSurfaceToLabelmap(e.points,e.polys,e.dimensions,e.spacing,e.direction,e.origin)},async convertSurfacesToVolumeLabelmap(e,...t){const[n]=t;await this.initializePolySeg(n);const{segmentsInfo:r}=e,s=Array.from(r.keys()).map(l=>{const{points:g,polys:h}=r.get(l);return{...this.polySeg.instance.convertSurfaceToLabelmap(g,h,e.dimensions,e.spacing,e.direction,e.origin),segmentIndex:l}}),a=await Promise.all(s),i=Ot.newInstance();i.setDimensions(e.dimensions),i.setOrigin(e.origin),i.setSpacing(e.spacing),i.setDirection(e.direction);const c=e.dimensions[0]*e.dimensions[1]*e.dimensions[2],o=Q.newInstance({name:"Pixels",numberOfComponents:1,values:new Uint8Array(c)});i.getPointData().setScalars(o),i.modified();const u=I.createVolumeVoxelManager(e.dimensions,i.getPointData().getScalars().getData()),f=a.map(l=>{const{data:g,dimensions:h,direction:y,origin:p,spacing:m}=l,C=Ot.newInstance();C.setDimensions(h),C.setOrigin(p),C.setSpacing(m),C.setDirection(y);const E=Q.newInstance({name:"Pixels",numberOfComponents:1,values:g});C.getPointData().setScalars(E),C.modified();const v=I.createVolumeVoxelManager(h,g),d=C.getExtent();return{volume:C,voxelManager:v,extent:d,scalarData:g,segmentIndex:l.segmentIndex}});return fe(i,()=>!0,({pointIJK:l,pointLPS:g})=>{try{for(const h of f){const{volume:y,extent:p,voxelManager:m,segmentIndex:C}=h,E=y.worldToIndex(g);if(E[0]<p[0]||E[0]>p[1]||E[1]<p[2]||E[1]>p[3]||E[2]<p[4]||E[2]>p[5])continue;const v=E.map(Math.round);if(m.getAtIJK(...v)>0){u.setAtIJKPoint(l,C);break}}}catch{}}),u.scalarData},getSurfacesAABBs({surfacesInfo:e}){const t=new Map;for(const{points:n,id:r}of e){const s=Dn(n,{numDimensions:3});t.set(r,s)}return t},cutSurfacesIntoPlanes({planesInfo:e,surfacesInfo:t,surfacesAABB:n=new Map},r,s){const a=e.length,i=Go.newInstance(),c=it.newInstance();i.setCutFunction(c);const o=Ye.newInstance();try{for(const[u,f]of e.entries()){const{sliceIndex:l,planes:g}=f,h=new Map;for(const y of t){const{points:p,polys:m,id:C}=y,E=n.get(C)||Dn(p,{numDimensions:3});n.has(C)||n.set(C,E);const{minX:v,minY:d,minZ:O,maxX:w,maxY:x,maxZ:T}=E,{origin:L,normal:S}=g[0];if(!nc(L,S,v,d,O,w,x,T))continue;o.getPoints().setData(p,3),o.getPolys().setData(m,3),o.modified(),i.setInputData(o),c.setOrigin(L),c.setNormal(S);try{i.update()}catch(_){console.warn("Error during clipping",_);continue}const M=i.getOutputData(),k=M;k.buildLinks();const $=Qo.newInstance();$.setInputData(k);const D=$.getOutputData();M&&h.set(C,{points:D.getPoints().getData(),lines:D.getLines().getData(),numberOfCells:D.getLines().getNumberOfCells()})}r({progress:(u+1)/a}),s({sliceIndex:l,polyDataResults:h})}}catch(u){console.warn("Error during processing",u)}finally{t=null,c.delete()}}};xe(rc);
