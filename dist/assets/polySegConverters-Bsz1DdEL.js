var Ks=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var dc=Ks((Cc,Gs)=>{/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const er=Symbol("Comlink.proxy"),Hs=Symbol("Comlink.endpoint"),Ws=Symbol("Comlink.releaseProxy"),se=Symbol("Comlink.finalizer"),Mt=Symbol("Comlink.thrown"),nr=e=>typeof e=="object"&&e!==null||typeof e=="function",qs={canHandle:e=>nr(e)&&e[er],serialize(e){const{port1:t,port2:n}=new MessageChannel;return Ae(e,t),[n,[n]]},deserialize(e){return e.start(),Js(e)}},Xs={canHandle:e=>nr(e)&&Mt in e,serialize({value:e}){let t;return e instanceof Error?t={isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:t={isError:!1,value:e},[t,[]]},deserialize(e){throw e.isError?Object.assign(new Error(e.value.message),e.value):e.value}},rr=new Map([["proxy",qs],["throw",Xs]]);function Ys(e,t){for(const n of e)if(t===n||n==="*"||n instanceof RegExp&&n.test(t))return!0;return!1}function Ae(e,t=globalThis,n=["*"]){t.addEventListener("message",function r(s){if(!s||!s.data)return;if(!Ys(n,s.origin)){console.warn(`Invalid origin '${s.origin}' for comlink proxy`);return}const{id:a,type:i,path:c}=Object.assign({path:[]},s.data),o=(s.data.argumentList||[]).map(at);let u;try{const f=c.slice(0,-1).reduce((l,h)=>l[h],e),g=c.reduce((l,h)=>l[h],e);switch(i){case"GET":u=g;break;case"SET":f[c.slice(-1)[0]]=at(s.data.value),u=!0;break;case"APPLY":u=g.apply(f,o);break;case"CONSTRUCT":{const l=new g(...o);u=na(l)}break;case"ENDPOINT":{const{port1:l,port2:h}=new MessageChannel;Ae(e,h),u=ea(l,[l])}break;case"RELEASE":u=void 0;break;default:return}}catch(f){u={value:f,[Mt]:0}}Promise.resolve(u).catch(f=>({value:f,[Mt]:0})).then(f=>{const[g,l]=At(f);t.postMessage(Object.assign(Object.assign({},g),{id:a}),l),i==="RELEASE"&&(t.removeEventListener("message",r),sr(t),se in e&&typeof e[se]=="function"&&e[se]())}).catch(f=>{const[g,l]=At({value:new TypeError("Unserializable return value"),[Mt]:0});t.postMessage(Object.assign(Object.assign({},g),{id:a}),l)})}),t.start&&t.start()}function Ps(e){return e.constructor.name==="MessagePort"}function sr(e){Ps(e)&&e.close()}function Js(e,t){const n=new Map;return e.addEventListener("message",function(s){const{data:a}=s;if(!a||!a.id)return;const i=n.get(a.id);if(i)try{i(a)}finally{n.delete(a.id)}}),ke(e,n,[],t)}function dt(e){if(e)throw new Error("Proxy has been released and is not useable")}function ar(e){return lt(e,new Map,{type:"RELEASE"}).then(()=>{sr(e)})}const jt=new WeakMap,zt="FinalizationRegistry"in globalThis&&new FinalizationRegistry(e=>{const t=(jt.get(e)||0)-1;jt.set(e,t),t===0&&ar(e)});function Qs(e,t){const n=(jt.get(t)||0)+1;jt.set(t,n),zt&&zt.register(e,t,e)}function Zs(e){zt&&zt.unregister(e)}function ke(e,t,n=[],r=function(){}){let s=!1;const a=new Proxy(r,{get(i,c){if(dt(s),c===Ws)return()=>{Zs(a),ar(e),t.clear(),s=!0};if(c==="then"){if(n.length===0)return{then:()=>a};const o=lt(e,t,{type:"GET",path:n.map(u=>u.toString())}).then(at);return o.then.bind(o)}return ke(e,t,[...n,c])},set(i,c,o){dt(s);const[u,f]=At(o);return lt(e,t,{type:"SET",path:[...n,c].map(g=>g.toString()),value:u},f).then(at)},apply(i,c,o){dt(s);const u=n[n.length-1];if(u===Hs)return lt(e,t,{type:"ENDPOINT"}).then(at);if(u==="bind")return ke(e,t,n.slice(0,-1));const[f,g]=on(o);return lt(e,t,{type:"APPLY",path:n.map(l=>l.toString()),argumentList:f},g).then(at)},construct(i,c){dt(s);const[o,u]=on(c);return lt(e,t,{type:"CONSTRUCT",path:n.map(f=>f.toString()),argumentList:o},u).then(at)}});return Qs(a,e),a}function ta(e){return Array.prototype.concat.apply([],e)}function on(e){const t=e.map(At);return[t.map(n=>n[0]),ta(t.map(n=>n[1]))]}const ir=new WeakMap;function ea(e,t){return ir.set(e,t),e}function na(e){return Object.assign(e,{[er]:!0})}function At(e){for(const[t,n]of rr)if(n.canHandle(e)){const[r,s]=n.serialize(e);return[{type:"HANDLER",name:t,value:r},s]}return[{type:"RAW",value:e},ir.get(e)||[]]}function at(e){switch(e.type){case"HANDLER":return rr.get(e.name).deserialize(e.value);case"RAW":return e.value}}function lt(e,t,n,r){return new Promise(s=>{const a=ra();t.set(a,s),e.start&&e.start(),e.postMessage(Object.assign({id:a},n),r)})}function ra(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}function or(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function sa(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var t=e.default;if(typeof t=="function"){var n=function r(){var s=!1;try{s=this instanceof r}catch{}return s?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var s=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(n,r,s.get?s:{enumerable:!0,get:function(){return e[r]}})}),n}var ae,cn;function aa(){return cn||(cn=1,ae=function e(t,n){if(t===n)return!0;if(t&&n&&typeof t=="object"&&typeof n=="object"){if(t.constructor!==n.constructor)return!1;var r,s,a;if(Array.isArray(t)){if(r=t.length,r!=n.length)return!1;for(s=r;s--!==0;)if(!e(t[s],n[s]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if(a=Object.keys(t),r=a.length,r!==Object.keys(n).length)return!1;for(s=r;s--!==0;)if(!Object.prototype.hasOwnProperty.call(n,a[s]))return!1;for(s=r;s--!==0;){var i=a[s];if(!e(t[i],n[i]))return!1}return!0}return t!==t&&n!==n}),ae}var ia=aa(),oa=or(ia),ie,un;function cr(){if(un)return ie;un=1;var e=Object.prototype.toString;return ie=function(n){var r=e.call(n),s=r==="[object Arguments]";return s||(s=r!=="[object Array]"&&n!==null&&typeof n=="object"&&typeof n.length=="number"&&n.length>=0&&e.call(n.callee)==="[object Function]"),s},ie}var oe,fn;function ca(){if(fn)return oe;fn=1;var e;if(!Object.keys){var t=Object.prototype.hasOwnProperty,n=Object.prototype.toString,r=cr(),s=Object.prototype.propertyIsEnumerable,a=!s.call({toString:null},"toString"),i=s.call(function(){},"prototype"),c=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],o=function(l){var h=l.constructor;return h&&h.prototype===l},u={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},f=function(){if(typeof window>"u")return!1;for(var l in window)try{if(!u["$"+l]&&t.call(window,l)&&window[l]!==null&&typeof window[l]=="object")try{o(window[l])}catch{return!0}}catch{return!0}return!1}(),g=function(l){if(typeof window>"u"||!f)return o(l);try{return o(l)}catch{return!1}};e=function(h){var y=h!==null&&typeof h=="object",p=n.call(h)==="[object Function]",m=r(h),C=y&&n.call(h)==="[object String]",E=[];if(!y&&!p&&!m)throw new TypeError("Object.keys called on a non-object");var v=i&&p;if(C&&h.length>0&&!t.call(h,0))for(var d=0;d<h.length;++d)E.push(String(d));if(m&&h.length>0)for(var x=0;x<h.length;++x)E.push(String(x));else for(var w in h)!(v&&w==="prototype")&&t.call(h,w)&&E.push(String(w));if(a)for(var O=g(h),T=0;T<c.length;++T)!(O&&c[T]==="constructor")&&t.call(h,c[T])&&E.push(c[T]);return E}}return oe=e,oe}var ce,ln;function ua(){if(ln)return ce;ln=1;var e=Array.prototype.slice,t=cr(),n=Object.keys,r=n?function(i){return n(i)}:ca(),s=Object.keys;return r.shim=function(){if(Object.keys){var i=function(){var c=Object.keys(arguments);return c&&c.length===arguments.length}(1,2);i||(Object.keys=function(o){return t(o)?s(e.call(o)):s(o)})}else Object.keys=r;return Object.keys||r},ce=r,ce}var ue,gn;function ur(){if(gn)return ue;gn=1;var e=Object.defineProperty||!1;if(e)try{e({},"a",{value:1})}catch{e=!1}return ue=e,ue}var fe,hn;function fa(){return hn||(hn=1,fe=SyntaxError),fe}var le,yn;function la(){return yn||(yn=1,le=TypeError),le}var ge,pn;function ga(){return pn||(pn=1,ge=Object.getOwnPropertyDescriptor),ge}var he,mn;function ha(){if(mn)return he;mn=1;var e=ga();if(e)try{e([],"length")}catch{e=null}return he=e,he}var ye,vn;function ya(){if(vn)return ye;vn=1;var e=ur(),t=fa(),n=la(),r=ha();return ye=function(a,i,c){if(!a||typeof a!="object"&&typeof a!="function")throw new n("`obj` must be an object or a function`");if(typeof i!="string"&&typeof i!="symbol")throw new n("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new n("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new n("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new n("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new n("`loose`, if provided, must be a boolean");var o=arguments.length>3?arguments[3]:null,u=arguments.length>4?arguments[4]:null,f=arguments.length>5?arguments[5]:null,g=arguments.length>6?arguments[6]:!1,l=!!r&&r(a,i);if(e)e(a,i,{configurable:f===null&&l?l.configurable:!f,enumerable:o===null&&l?l.enumerable:!o,value:c,writable:u===null&&l?l.writable:!u});else if(g||!o&&!u&&!f)a[i]=c;else throw new t("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},ye}var pe,dn;function pa(){if(dn)return pe;dn=1;var e=ur(),t=function(){return!!e};return t.hasArrayLengthDefineBug=function(){if(!e)return null;try{return e([],"length",{value:1}).length!==1}catch{return!0}},pe=t,pe}var me,Tn;function fr(){if(Tn)return me;Tn=1;var e=ua(),t=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",n=Object.prototype.toString,r=Array.prototype.concat,s=ya(),a=function(u){return typeof u=="function"&&n.call(u)==="[object Function]"},i=pa()(),c=function(u,f,g,l){if(f in u){if(l===!0){if(u[f]===g)return}else if(!a(l)||!l())return}i?s(u,f,g,!0):s(u,f,g)},o=function(u,f){var g=arguments.length>2?arguments[2]:{},l=e(f);t&&(l=r.call(l,Object.getOwnPropertySymbols(f)));for(var h=0;h<l.length;h+=1)c(u,l[h],f[l[h]],g[l[h]])};return o.supportsDescriptors=!!i,me=o,me}var yt={exports:{}},wn;function lr(){return wn||(wn=1,typeof self<"u"?yt.exports=self:typeof window<"u"?yt.exports=window:yt.exports=Function("return this")()),yt.exports}var ve,Cn;function gr(){if(Cn)return ve;Cn=1;var e=lr();return ve=function(){return typeof globalThis!="object"||!globalThis||globalThis.Math!==Math||globalThis.Array!==Array?e:globalThis},ve}var de,xn;function ma(){if(xn)return de;xn=1;var e=fr(),t=gr();return de=function(){var r=t();if(e.supportsDescriptors){var s=Object.getOwnPropertyDescriptor(r,"globalThis");(!s||s.configurable&&(s.enumerable||!s.writable||globalThis!==r))&&Object.defineProperty(r,"globalThis",{configurable:!0,enumerable:!1,value:r,writable:!0})}else(typeof globalThis!="object"||globalThis!==r)&&(r.globalThis=r);return r},de}var Te,On;function va(){if(On)return Te;On=1;var e=fr(),t=lr(),n=gr(),r=ma(),s=n(),a=function(){return s};return e(a,{getPolyfill:n,implementation:t,shim:r}),Te=a,Te}var da=va(),Ta=or(da);const H=Ta(),hr={vtkObject:()=>null};function W(e){if(e==null||e.isA)return e;if(!e.vtkClass)return H.console&&H.console.error&&H.console.error("Invalid VTK object"),null;const t=hr[e.vtkClass];if(!t)return H.console&&H.console.error&&H.console.error(`No vtk class found for Object of type ${e.vtkClass}`),null;const n={...e};Object.keys(n).forEach(s=>{n[s]&&typeof n[s]=="object"&&n[s].vtkClass&&(n[s]=W(n[s]))});const r=t(n);return r&&r.modified&&r.modified(),r}function wa(e,t){hr[e]=t}W.register=wa;class we extends Array{push(){for(let t=0;t<arguments.length;t++)this.includes(arguments[t])||super.push(arguments[t]);return this.length}}let Ne=0;const yr=Symbol("void");function Ca(){return Ne}const pr={};function it(){}const xa=["log","debug","info","warn","error","time","timeEnd","group","groupEnd"];xa.forEach(e=>{pr[e]=it});H.console=console.hasOwnProperty("log")?console:pr;const nt={debug:it,error:H.console.error||it,info:H.console.info||it,log:H.console.log||it,warn:H.console.warn||it};function mr(e,t){nt[e]&&(nt[e]=t||it)}function vr(){nt.log(...arguments)}function dr(){nt.info(...arguments)}function bt(){nt.debug(...arguments)}function U(){nt.error(...arguments)}function be(){nt.warn(...arguments)}const En={};function Tr(e){En[e]||(nt.error(e),En[e]=!0)}const A=Object.create(null);A.Float32Array=Float32Array;A.Float64Array=Float64Array;A.Uint8Array=Uint8Array;A.Int8Array=Int8Array;A.Uint16Array=Uint16Array;A.Int16Array=Int16Array;A.Uint32Array=Uint32Array;A.Int32Array=Int32Array;A.Uint8ClampedArray=Uint8ClampedArray;try{A.BigInt64Array=BigInt64Array,A.BigUint64Array=BigUint64Array}catch{}function Xt(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return new(A[e]||Float64Array)(...n)}function Yt(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return(A[e]||Float64Array).from(...n)}function Pt(e){return e.charAt(0).toUpperCase()+e.slice(1)}function F(e){return Pt(e[0]==="_"?e.slice(1):e)}function wr(e){return e.charAt(0).toLowerCase()+e.slice(1)}function Cr(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1e3;const r=["TB","GB","MB","KB"];let s=Number(e),a="B";for(;s>n;)s/=n,a=r.pop();return`${s.toFixed(t)} ${a}`}function xr(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";const n=[];let r=e;for(;r>1e3;)n.push(`000${r%1e3}`.slice(-3)),r=Math.floor(r/1e3);return r>0&&n.push(r),n.reverse(),n.join(t)}function Or(e){Object.keys(e).forEach(t=>{Array.isArray(e[t])&&(e[t]=[].concat(e[t]))})}function Oa(e){return Object.values(A).some(t=>e instanceof t)}function Ea(e,t){if(e===t)return!0;if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}return!1}function Sa(e,t){return Object.keys(e).find(n=>e[n]===t)}function Er(e){return e&&e.isA?e.getState():e}function Be(e){setTimeout(e,0)}function Sr(e,t){const n=performance.now();e.finally(()=>{const r=performance.now()-n;t(r)})}function Jt(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Or(t);const n=[];if(Number.isInteger(t.mtime)||(t.mtime=++Ne),!("classHierarchy"in t))t.classHierarchy=new we("vtkObject");else if(!(t.classHierarchy instanceof we)){const a=new we;for(let i=0;i<t.classHierarchy.length;i++)a.push(t.classHierarchy[i]);t.classHierarchy=a}function r(a){n[a]=null}function s(a){function i(){r(a)}return Object.freeze({unsubscribe:i})}return e.isDeleted=()=>!!t.deleted,e.modified=a=>{if(t.deleted){U("instance deleted - cannot call any method");return}a&&a<e.getMTime()||(t.mtime=++Ne,n.forEach(i=>i&&i(e)))},e.onModified=a=>{if(t.deleted)return U("instance deleted - cannot call any method"),null;const i=n.length;return n.push(a),s(i)},e.getMTime=()=>t.mtime,e.isA=a=>{let i=t.classHierarchy.length;for(;i--;)if(t.classHierarchy[i]===a)return!0;return!1},e.getClassName=function(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return t.classHierarchy[t.classHierarchy.length-1-a]},e.set=function(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=!1;return Object.keys(a).forEach(u=>{const f=c?null:e[`set${Pt(u)}`];f&&Array.isArray(a[u])&&f.length>1?o=f(...a[u])||o:f?o=f(a[u])||o:(["mtime"].indexOf(u)===-1&&!i&&be(`Warning: Set value to model directly ${u}, ${a[u]}`),o=t[u]!==a[u]||o,t[u]=a[u])}),o},e.get=function(){for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];if(!i.length)return t;const o={};return i.forEach(u=>{o[u]=t[u]}),o},e.getReferenceByName=a=>t[a],e.delete=()=>{Object.keys(t).forEach(a=>delete t[a]),n.forEach((a,i)=>r(i)),t.deleted=!0},e.getState=()=>{if(t.deleted)return null;const a={...t,vtkClass:e.getClassName()};Object.keys(a).forEach(c=>{a[c]===null||a[c]===void 0||c[0]==="_"?delete a[c]:a[c].isA?a[c]=a[c].getState():Array.isArray(a[c])?a[c]=a[c].map(Er):Oa(a[c])&&(a[c]=Array.from(a[c]))});const i={};return Object.keys(a).sort().forEach(c=>{i[c]=a[c]}),i.mtime&&delete i.mtime,i},e.shallowCopy=function(a){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(a.getClassName()!==e.getClassName())throw new Error(`Cannot ShallowCopy ${a.getClassName()} into ${e.getClassName()}`);const c=a.get(),o=Object.keys(t).sort();Object.keys(c).sort().forEach(f=>{const g=o.indexOf(f);g===-1?i&&bt(`add ${f} in shallowCopy`):o.splice(g,1),t[f]=c[f]}),o.length&&i&&bt(`Untouched keys: ${o.join(", ")}`),e.modified()},e.toJSON=function(){return e.getState()},e}const Da={object(e,t,n){return function(){return{...t[n.name]}}}};function mt(e,t,n){n.forEach(r=>{if(typeof r=="object"){const s=Da[r.type];s?e[`get${F(r.name)}`]=s(e,t,r):e[`get${F(r.name)}`]=()=>t[r.name]}else e[`get${F(r)}`]=()=>t[r]})}const Ma={enum(e,t,n){const r=`_on${F(n.name)}Changed`;return s=>{if(typeof s=="string"){if(n.enum[s]!==void 0)return t[n.name]!==n.enum[s]?(t[n.name]=n.enum[s],e.modified(),!0):!1;throw U(`Set Enum with invalid argument ${n}, ${s}`),new RangeError("Set Enum with invalid string argument")}if(typeof s=="number"){if(t[n.name]!==s){if(Object.keys(n.enum).map(a=>n.enum[a]).indexOf(s)!==-1){const a=t[n.name];return t[n.name]=s,t[r]?.(e,t,s,a),e.modified(),!0}throw U(`Set Enum outside numeric range ${n}, ${s}`),new RangeError("Set Enum outside numeric range")}return!1}throw U(`Set Enum with invalid argument (String/Number) ${n}, ${s}`),new TypeError("Set Enum with invalid argument (String/Number)")}},object(e,t,n){const r=`_on${F(n.name)}Changed`;return s=>{if(!oa(t[n.name],s)){const a=t[n.name];return t[n.name]=s,t[r]?.(e,t,s,a),e.modified(),!0}return!1}}};function Sn(e){if(typeof e=="object"){const t=Ma[e.type];if(t)return(n,r)=>t(n,r,e);throw U(`No setter for field ${e}`),new TypeError("No setter for field")}return function(n,r){const s=`_on${F(e)}Changed`;return function(i){if(r.deleted)return U("instance deleted - cannot call any method"),!1;if(r[e]!==i){const c=r[e.name];return r[e]=i,r[s]?.(n,r,i,c),n.modified(),!0}return!1}}}function Qt(e,t,n){n.forEach(r=>{typeof r=="object"?e[`set${F(r.name)}`]=Sn(r)(e,t):e[`set${F(r)}`]=Sn(r)(e,t)})}function Zt(e,t,n){mt(e,t,n),Qt(e,t,n)}function Ge(e,t,n){n.forEach(r=>{e[`get${F(r)}`]=()=>t[r]?Array.from(t[r]):t[r],e[`get${F(r)}ByReference`]=()=>t[r]})}function Ke(e,t,n,r){let s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:void 0;n.forEach(a=>{if(t[a]&&r&&t[a].length!==r)throw new RangeError(`Invalid initial number of values for array (${a})`);const i=`_on${F(a)}Changed`;e[`set${F(a)}`]=function(){if(t.deleted)return U("instance deleted - cannot call any method"),!1;for(var c=arguments.length,o=new Array(c),u=0;u<c;u++)o[u]=arguments[u];let f=o,g,l=!1;if(f.length===1&&(f[0]==null||f[0].length>=0)&&(f=f[0],l=!0),f==null)g=t[a]!==f;else{if(r&&f.length!==r)if(f.length<r&&s!==void 0)for(f=Array.from(f),l=!1;f.length<r;)f.push(s);else throw new RangeError(`Invalid number of values for array setter (${a})`);g=t[a]==null||t[a].length!==f.length;for(let h=0;!g&&h<f.length;++h)g=t[a][h]!==f[h];g&&l&&(f=Array.from(f))}if(g){const h=t[a.name];t[a]=f,t[i]?.(e,t,f,h),e.modified()}return g},e[`set${F(a)}From`]=c=>{const o=t[a];c.forEach((u,f)=>{o[f]=u})}})}function Dr(e,t,n,r){let s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:void 0;Ge(e,t,n),Ke(e,t,n,r,s)}function Mr(e,t,n){for(let r=0;r<n.length;r++){const s=n[r];t[s]!==void 0&&(t[`_${s}`]=t[s],delete t[s])}}function He(e,t,n,r){t.inputData?t.inputData=t.inputData.map(W):t.inputData=[],t.inputConnection?t.inputConnection=t.inputConnection.map(W):t.inputConnection=[],t.output?t.output=t.output.map(W):t.output=[],t.inputArrayToProcess?t.inputArrayToProcess=t.inputArrayToProcess.map(W):t.inputArrayToProcess=[],t.numberOfInputs=n;function s(h){let y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(t.deleted){U("instance deleted - cannot call any method");return}if(y>=t.numberOfInputs){U(`algorithm ${e.getClassName()} only has ${t.numberOfInputs} input ports. To add more input ports, use addInputData()`);return}(t.inputData[y]!==h||t.inputConnection[y])&&(t.inputData[y]=h,t.inputConnection[y]=null,e.modified&&e.modified())}function a(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return t.inputConnection[h]&&(t.inputData[h]=t.inputConnection[h]()),t.inputData[h]}function i(h){let y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(t.deleted){U("instance deleted - cannot call any method");return}if(y>=t.numberOfInputs){let p=`algorithm ${e.getClassName()} only has `;p+=`${t.numberOfInputs}`,p+=" input ports. To add more input ports, use addInputConnection()",U(p);return}t.inputData[y]=null,t.inputConnection[y]=h}function c(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return t.inputConnection[h]}function o(){let h=t.numberOfInputs;for(;h&&!t.inputData[h-1]&&!t.inputConnection[h-1];)h--;return h===t.numberOfInputs&&t.numberOfInputs++,h}function u(h){if(t.deleted){U("instance deleted - cannot call any method");return}i(h,o())}function f(h){if(t.deleted){U("instance deleted - cannot call any method");return}s(h,o())}function g(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return t.deleted?(U("instance deleted - cannot call any method"),null):(e.shouldUpdate()&&e.update(),t.output[h])}e.shouldUpdate=()=>{const h=e.getMTime();let y=1/0,p=r;for(;p--;){if(!t.output[p]||t.output[p].isDeleted())return!0;const m=t.output[p].getMTime();if(m<h)return!0;m<y&&(y=m)}for(p=t.numberOfInputs;p--;)if(t.inputConnection[p]?.filter.shouldUpdate()||e.getInputData(p)?.getMTime()>y)return!0;return!1};function l(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;const y=()=>g(h);return y.filter=e,y}if(t.numberOfInputs){let h=t.numberOfInputs;for(;h--;)t.inputData.push(null),t.inputConnection.push(null);e.setInputData=s,e.setInputConnection=i,e.addInputData=f,e.addInputConnection=u,e.getInputData=a,e.getInputConnection=c}r&&(e.getOutputData=g,e.getOutputPort=l),e.update=()=>{const h=[];if(t.numberOfInputs){let y=0;for(;y<t.numberOfInputs;)h[y]=e.getInputData(y),y++}e.shouldUpdate()&&e.requestData&&e.requestData(h,t.output)},e.getNumberOfInputPorts=()=>t.numberOfInputs,e.getNumberOfOutputPorts=()=>r||t.output.length,e.getInputArrayToProcess=h=>{const y=t.inputArrayToProcess[h],p=t.inputData[h];return y&&p?p[`get${y.fieldAssociation}`]().getArray(y.arrayName):null},e.setInputArrayToProcess=function(h,y,p){let m=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"Scalars";for(;t.inputArrayToProcess.length<h;)t.inputArrayToProcess.push(null);t.inputArrayToProcess[h]={arrayName:y,fieldAssociation:p,attributeType:m}}}const We=Symbol("Event abort");function Lr(e,t,n){const r=[],s=e.delete;let a=1;function i(u){for(let f=0;f<r.length;++f){const[g]=r[f];if(g===u){r.splice(f,1);return}}}function c(u){function f(){i(u)}return Object.freeze({unsubscribe:f})}function o(){if(t.deleted){U("instance deleted - cannot call any method");return}const u=r.slice();for(let f=0;f<u.length;++f){const[,g,l]=u[f];if(g){if(l<0)setTimeout(()=>g.apply(e,arguments),1-l);else if(g.apply(e,arguments)===We)break}}}e[`invoke${F(n)}`]=o,e[`on${F(n)}`]=function(u){let f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(!u.apply)return console.error(`Invalid callback for event ${n}`),null;if(t.deleted)return U("instance deleted - cannot call any method"),null;const g=a++;return r.push([g,u,f]),r.sort((l,h)=>h[2]-l[2]),c(g)},e.delete=()=>{s(),r.forEach(u=>{let[f]=u;return i(f)})}}function te(e,t){const n=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const s={},a={};return e(a,s,r),Object.freeze(a)};return t&&W.register(t,n),n}function kr(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(){for(var r=arguments.length,s=new Array(r),a=0;a<r;a++)s[a]=arguments[a];return t.filter(i=>!!i).map(i=>i(...s))}}function qe(e){return e&&e.isA&&e.isA("vtkObject")}function Bt(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[];if(qe(e)){if(r.indexOf(e)>=0)return n;r.push(e);const s=t(e);s!==void 0&&n.push(s);const a=e.get();Object.keys(a).forEach(i=>{const c=a[i];Array.isArray(c)?c.forEach(o=>{Bt(o,t,n,r)}):Bt(c,t,n,r)})}return n}function Nr(e,t,n){var r=this;let s;const a=function(){for(var i=arguments.length,c=new Array(i),o=0;o<i;o++)c[o]=arguments[o];const u=r,f=()=>{s=null,n||e.apply(u,c)},g=n&&!s;clearTimeout(s),s=setTimeout(f,t),g&&e.apply(u,c)};return a.cancel=()=>clearTimeout(s),a}function $r(e,t){let n=!1,r=null;function s(){n=!1,r!==null&&(a(...r),r=null)}function a(){for(var i=arguments.length,c=new Array(i),o=0;o<i;o++)c[o]=arguments[o];if(n){r=c;return}n=!0,e(...c),setTimeout(s,t)}return a}function Xe(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};t.keystore=Object.assign(t.keystore||{},n),e.setKey=(r,s)=>{t.keystore[r]=s},e.getKey=r=>t.keystore[r],e.getAllKeys=()=>Object.keys(t.keystore),e.deleteKey=r=>delete t.keystore[r],e.clearKeystore=()=>e.getAllKeys().forEach(r=>delete t.keystore[r])}let La=1;const Tt="__root__";function Rr(e,t){Xe(e,t);const n=e.delete;t.proxyId=`${La++}`,t.ui=JSON.parse(JSON.stringify(t.ui||[])),mt(e,t,["proxyId","proxyGroup","proxyName"]),Zt(e,t,["proxyManager"]);const r={},s={};function a(u,f){s[f]||(s[f]=[]);const g=s[f];for(let l=0;l<u.length;l++)g.push(u[l].name),r[u[l].name]=u[l],u[l].children&&u[l].children.length&&a(u[l].children,u[l].name)}a(t.ui,Tt),e.updateUI=u=>{t.ui=JSON.parse(JSON.stringify(u||[])),Object.keys(r).forEach(f=>delete r[f]),Object.keys(s).forEach(f=>delete s[f]),a(t.ui,Tt),e.modified()};function i(){let u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Tt;return s[u]}e.updateProxyProperty=(u,f)=>{const g=r[u];g?Object.assign(g,f):r[u]={...f}},e.activate=()=>{if(t.proxyManager){const u=`setActive${F(e.getProxyGroup().slice(0,-1))}`;t.proxyManager[u]&&t.proxyManager[u](e)}},t.propertyLinkSubscribers={},e.registerPropertyLinkForGC=(u,f)=>{f in t.propertyLinkSubscribers||(t.propertyLinkSubscribers[f]=[]),t.propertyLinkSubscribers[f].push(u)},e.gcPropertyLinks=u=>{const f=t.propertyLinkSubscribers[u]||[];for(;f.length;)f.pop().unbind(e)},t.propertyLinkMap={},e.getPropertyLink=function(u){let f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(t.propertyLinkMap[u])return t.propertyLinkMap[u];let g=null;const l=[];let h=0,y=!1;function p(d){let x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(y)return null;const w=[];let O=null;for(h=l.length;h--;){const M=l[h];M.instance===d?O=M:w.push(M)}if(!O)return null;const T=O.instance[`get${F(O.propertyName)}`]();if(!Ea(T,g)||x){for(g=T,y=!0;w.length;){const M=w.pop();M.instance.set({[M.propertyName]:g})}y=!1}return t.propertyLinkMap[u].persistent&&(t.propertyLinkMap[u].value=T),T}function m(d,x){const w=[];for(h=l.length;h--;){const O=l[h];O.instance===d&&(O.propertyName===x||x===void 0)&&(O.subscription.unsubscribe(),w.push(h))}for(;w.length;)l.splice(w.pop(),1)}function C(d,x){let w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const O=d.onModified(p),T=l[0];return l.push({instance:d,propertyName:x,subscription:O}),w&&(t.propertyLinkMap[u].persistent&&t.propertyLinkMap[u].value!==void 0?d.set({[x]:t.propertyLinkMap[u].value}):T&&p(T.instance,!0)),{unsubscribe:()=>m(d,x)}}function E(){for(;l.length;)l.pop().subscription.unsubscribe()}const v={bind:C,unbind:m,unsubscribe:E,persistent:f};return t.propertyLinkMap[u]=v,v};function c(){let u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Tt;const f=[],g=t.proxyId,l=i(u)||[];for(let h=0;h<l.length;h++){const y=l[h],p=e[`get${F(y)}`],m=p?p():void 0,C={id:g,name:y,value:m},E=c(y);E.length&&(C.children=E),f.push(C)}return f}e.listPropertyNames=()=>c().map(u=>u.name),e.getPropertyByName=u=>c().find(f=>f.name===u),e.getPropertyDomainByName=u=>(r[u]||{}).domain,e.getProxySection=()=>({id:t.proxyId,name:t.proxyGroup,ui:t.ui,properties:c()}),e.delete=()=>{const u=Object.keys(t.propertyLinkMap);let f=u.length;for(;f--;)t.propertyLinkMap[u[f]].unsubscribe();Object.keys(t.propertyLinkSubscribers).forEach(e.gcPropertyLinks),n()},e.getState=()=>null;function o(){if(t.links)for(let u=0;u<t.links.length;u++){const{link:f,property:g,persistent:l,updateOnBind:h,type:y}=t.links[u];if(y==="application"){const p=t.proxyManager.getPropertyLink(f,l);e.registerPropertyLinkForGC(p,"application"),p.bind(e,g,h)}}}Be(o)}function Vr(e,t,n){const r=e.delete,s=[],a=Object.keys(n);let i=a.length;for(;i--;){const c=a[i],{modelKey:o,property:u,modified:f=!0}=n[c],g=F(u),l=F(c);e[`get${l}`]=t[o][`get${g}`],e[`set${l}`]=t[o][`set${g}`],f&&s.push(t[o].onModified(e.modified))}e.delete=()=>{for(;s.length;)s.pop().unsubscribe();r()}}function _r(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};t.this=e;function s(c){const o=Object.keys(c);let u=o.length;for(;u--;){const f=o[u];t[f].set(c[f])}}const a=Object.keys(r);let i=a.length;for(;i--;){const c=a[i];t[c]=r[c];const o=n[c];e[`set${F(c)}`]=u=>{if(u!==t[c]){t[c]=u;const f=o[u];s(f),e.modified()}}}a.length&&mt(e,t,a)}const Dn=10,Mn=40,Ln=800;function Ir(e){let t=0,n=0,r=0,s=0;return"detail"in e&&(n=e.detail),"wheelDelta"in e&&(n=-e.wheelDelta/120),"wheelDeltaY"in e&&(n=-e.wheelDeltaY/120),"wheelDeltaX"in e&&(t=-e.wheelDeltaX/120),"axis"in e&&e.axis===e.HORIZONTAL_AXIS&&(t=n,n=0),r=t*Dn,s=n*Dn,"deltaY"in e&&(s=e.deltaY),"deltaX"in e&&(r=e.deltaX),(r||s)&&e.deltaMode&&(e.deltaMode===1?(r*=Mn,s*=Mn):(r*=Ln,s*=Ln)),r&&!t&&(t=r<1?-1:1),s&&!n&&(n=s<1?-1:1),{spinX:t,spinY:n||t,pixelX:r,pixelY:s||r}}var N={algo:He,capitalize:Pt,chain:kr,debounce:Nr,enumToString:Sa,event:Lr,EVENT_ABORT:We,formatBytesToProperUnit:Cr,formatNumbersWithThousandSeparator:xr,get:mt,getArray:Ge,getCurrentGlobalMTime:Ca,getStateArrayMapFunc:Er,isVtkObject:qe,keystore:Xe,measurePromiseExecution:Sr,moveToProtected:Mr,newInstance:te,newTypedArray:Xt,newTypedArrayFrom:Yt,normalizeWheel:Ir,obj:Jt,proxy:Rr,proxyPropertyMapping:Vr,proxyPropertyState:_r,safeArrays:Or,set:Qt,setArray:Ke,setGet:Zt,setGetArray:Dr,setImmediate:Be,setLoggerFunction:mr,throttle:$r,traverseInstanceTree:Bt,TYPED_ARRAYS:A,uncapitalize:wr,VOID:yr,vtkDebugMacro:bt,vtkErrorMacro:U,vtkInfoMacro:dr,vtkLogMacro:vr,vtkOnceErrorMacro:Tr,vtkWarningMacro:be},Fr=Object.freeze({__proto__:null,VOID:yr,setLoggerFunction:mr,vtkLogMacro:vr,vtkInfoMacro:dr,vtkDebugMacro:bt,vtkErrorMacro:U,vtkWarningMacro:be,vtkOnceErrorMacro:Tr,TYPED_ARRAYS:A,newTypedArray:Xt,newTypedArrayFrom:Yt,capitalize:Pt,_capitalize:F,uncapitalize:wr,formatBytesToProperUnit:Cr,formatNumbersWithThousandSeparator:xr,setImmediateVTK:Be,measurePromiseExecution:Sr,obj:Jt,get:mt,set:Qt,setGet:Zt,getArray:Ge,setArray:Ke,setGetArray:Dr,moveToProtected:Mr,algo:He,EVENT_ABORT:We,event:Lr,newInstance:te,chain:kr,isVtkObject:qe,traverseInstanceTree:Bt,debounce:Nr,throttle:$r,keystore:Xe,proxy:Rr,proxyPropertyMapping:Vr,proxyPropertyState:_r,normalizeWheel:Ir,default:N}),Lt={exports:{}},ka=Lt.exports,kn;function Na(){return kn||(kn=1,function(e){(function(t,n,r){function s(o){var u=this,f=c();u.next=function(){var g=2091639*u.s0+u.c*23283064365386963e-26;return u.s0=u.s1,u.s1=u.s2,u.s2=g-(u.c=g|0)},u.c=1,u.s0=f(" "),u.s1=f(" "),u.s2=f(" "),u.s0-=f(o),u.s0<0&&(u.s0+=1),u.s1-=f(o),u.s1<0&&(u.s1+=1),u.s2-=f(o),u.s2<0&&(u.s2+=1),f=null}function a(o,u){return u.c=o.c,u.s0=o.s0,u.s1=o.s1,u.s2=o.s2,u}function i(o,u){var f=new s(o),g=u&&u.state,l=f.next;return l.int32=function(){return f.next()*4294967296|0},l.double=function(){return l()+(l()*2097152|0)*11102230246251565e-32},l.quick=l,g&&(typeof g=="object"&&a(g,f),l.state=function(){return a(f,{})}),l}function c(){var o=4022871197,u=function(f){f=String(f);for(var g=0;g<f.length;g++){o+=f.charCodeAt(g);var l=.02519603282416938*o;o=l>>>0,l-=o,l*=o,o=l>>>0,l-=o,o+=l*4294967296}return(o>>>0)*23283064365386963e-26};return u}n&&n.exports?n.exports=i:this.alea=i})(ka,e)}(Lt)),Lt.exports}var kt={exports:{}},$a=kt.exports,Nn;function Ra(){return Nn||(Nn=1,function(e){(function(t,n,r){function s(c){var o=this,u="";o.x=0,o.y=0,o.z=0,o.w=0,o.next=function(){var g=o.x^o.x<<11;return o.x=o.y,o.y=o.z,o.z=o.w,o.w^=o.w>>>19^g^g>>>8},c===(c|0)?o.x=c:u+=c;for(var f=0;f<u.length+64;f++)o.x^=u.charCodeAt(f)|0,o.next()}function a(c,o){return o.x=c.x,o.y=c.y,o.z=c.z,o.w=c.w,o}function i(c,o){var u=new s(c),f=o&&o.state,g=function(){return(u.next()>>>0)/4294967296};return g.double=function(){do var l=u.next()>>>11,h=(u.next()>>>0)/4294967296,y=(l+h)/(1<<21);while(y===0);return y},g.int32=u.next,g.quick=g,f&&(typeof f=="object"&&a(f,u),g.state=function(){return a(u,{})}),g}n&&n.exports?n.exports=i:this.xor128=i})($a,e)}(kt)),kt.exports}var Nt={exports:{}},Va=Nt.exports,$n;function _a(){return $n||($n=1,function(e){(function(t,n,r){function s(c){var o=this,u="";o.next=function(){var g=o.x^o.x>>>2;return o.x=o.y,o.y=o.z,o.z=o.w,o.w=o.v,(o.d=o.d+362437|0)+(o.v=o.v^o.v<<4^(g^g<<1))|0},o.x=0,o.y=0,o.z=0,o.w=0,o.v=0,c===(c|0)?o.x=c:u+=c;for(var f=0;f<u.length+64;f++)o.x^=u.charCodeAt(f)|0,f==u.length&&(o.d=o.x<<10^o.x>>>4),o.next()}function a(c,o){return o.x=c.x,o.y=c.y,o.z=c.z,o.w=c.w,o.v=c.v,o.d=c.d,o}function i(c,o){var u=new s(c),f=o&&o.state,g=function(){return(u.next()>>>0)/4294967296};return g.double=function(){do var l=u.next()>>>11,h=(u.next()>>>0)/4294967296,y=(l+h)/(1<<21);while(y===0);return y},g.int32=u.next,g.quick=g,f&&(typeof f=="object"&&a(f,u),g.state=function(){return a(u,{})}),g}n&&n.exports?n.exports=i:this.xorwow=i})(Va,e)}(Nt)),Nt.exports}var $t={exports:{}},Ia=$t.exports,Rn;function Fa(){return Rn||(Rn=1,function(e){(function(t,n,r){function s(c){var o=this;o.next=function(){var f=o.x,g=o.i,l,h;return l=f[g],l^=l>>>7,h=l^l<<24,l=f[g+1&7],h^=l^l>>>10,l=f[g+3&7],h^=l^l>>>3,l=f[g+4&7],h^=l^l<<7,l=f[g+7&7],l=l^l<<13,h^=l^l<<9,f[g]=h,o.i=g+1&7,h};function u(f,g){var l,h=[];if(g===(g|0))h[0]=g;else for(g=""+g,l=0;l<g.length;++l)h[l&7]=h[l&7]<<15^g.charCodeAt(l)+h[l+1&7]<<13;for(;h.length<8;)h.push(0);for(l=0;l<8&&h[l]===0;++l);for(l==8?h[7]=-1:h[l],f.x=h,f.i=0,l=256;l>0;--l)f.next()}u(o,c)}function a(c,o){return o.x=c.x.slice(),o.i=c.i,o}function i(c,o){c==null&&(c=+new Date);var u=new s(c),f=o&&o.state,g=function(){return(u.next()>>>0)/4294967296};return g.double=function(){do var l=u.next()>>>11,h=(u.next()>>>0)/4294967296,y=(l+h)/(1<<21);while(y===0);return y},g.int32=u.next,g.quick=g,f&&(f.x&&a(f,u),g.state=function(){return a(u,{})}),g}n&&n.exports?n.exports=i:this.xorshift7=i})(Ia,e)}($t)),$t.exports}var Rt={exports:{}},Ua=Rt.exports,Vn;function ja(){return Vn||(Vn=1,function(e){(function(t,n,r){function s(c){var o=this;o.next=function(){var f=o.w,g=o.X,l=o.i,h,y;return o.w=f=f+1640531527|0,y=g[l+34&127],h=g[l=l+1&127],y^=y<<13,h^=h<<17,y^=y>>>15,h^=h>>>12,y=g[l]=y^h,o.i=l,y+(f^f>>>16)|0};function u(f,g){var l,h,y,p,m,C=[],E=128;for(g===(g|0)?(h=g,g=null):(g=g+"\0",h=0,E=Math.max(E,g.length)),y=0,p=-32;p<E;++p)g&&(h^=g.charCodeAt((p+32)%g.length)),p===0&&(m=h),h^=h<<10,h^=h>>>15,h^=h<<4,h^=h>>>13,p>=0&&(m=m+1640531527|0,l=C[p&127]^=h+m,y=l==0?y+1:0);for(y>=128&&(C[(g&&g.length||0)&127]=-1),y=127,p=512;p>0;--p)h=C[y+34&127],l=C[y=y+1&127],h^=h<<13,l^=l<<17,h^=h>>>15,l^=l>>>12,C[y]=h^l;f.w=m,f.X=C,f.i=y}u(o,c)}function a(c,o){return o.i=c.i,o.w=c.w,o.X=c.X.slice(),o}function i(c,o){c==null&&(c=+new Date);var u=new s(c),f=o&&o.state,g=function(){return(u.next()>>>0)/4294967296};return g.double=function(){do var l=u.next()>>>11,h=(u.next()>>>0)/4294967296,y=(l+h)/(1<<21);while(y===0);return y},g.int32=u.next,g.quick=g,f&&(f.X&&a(f,u),g.state=function(){return a(u,{})}),g}n&&n.exports?n.exports=i:this.xor4096=i})(Ua,e)}(Rt)),Rt.exports}var Vt={exports:{}},za=Vt.exports,_n;function Aa(){return _n||(_n=1,function(e){(function(t,n,r){function s(c){var o=this,u="";o.next=function(){var g=o.b,l=o.c,h=o.d,y=o.a;return g=g<<25^g>>>7^l,l=l-h|0,h=h<<24^h>>>8^y,y=y-g|0,o.b=g=g<<20^g>>>12^l,o.c=l=l-h|0,o.d=h<<16^l>>>16^y,o.a=y-g|0},o.a=0,o.b=0,o.c=-1640531527,o.d=1367130551,c===Math.floor(c)?(o.a=c/4294967296|0,o.b=c|0):u+=c;for(var f=0;f<u.length+20;f++)o.b^=u.charCodeAt(f)|0,o.next()}function a(c,o){return o.a=c.a,o.b=c.b,o.c=c.c,o.d=c.d,o}function i(c,o){var u=new s(c),f=o&&o.state,g=function(){return(u.next()>>>0)/4294967296};return g.double=function(){do var l=u.next()>>>11,h=(u.next()>>>0)/4294967296,y=(l+h)/(1<<21);while(y===0);return y},g.int32=u.next,g.quick=g,f&&(typeof f=="object"&&a(f,u),g.state=function(){return a(u,{})}),g}n&&n.exports?n.exports=i:this.tychei=i})(za,e)}(Vt)),Vt.exports}var _t={exports:{}},ba={},Ba=Object.freeze({__proto__:null,default:ba}),Ga=sa(Ba),Ka=_t.exports,In;function Ha(){return In||(In=1,function(e){(function(t,n,r){var s=256,a=6,i=52,c="random",o=r.pow(s,a),u=r.pow(2,i),f=u*2,g=s-1,l;function h(d,x,w){var O=[];x=x==!0?{entropy:!0}:x||{};var T=C(m(x.entropy?[d,v(n)]:d??E(),3),O),M=new y(O),S=function(){for(var L=M.g(a),k=o,$=0;L<u;)L=(L+$)*s,k*=s,$=M.g(1);for(;L>=f;)L/=2,k/=2,$>>>=1;return(L+$)/k};return S.int32=function(){return M.g(4)|0},S.quick=function(){return M.g(4)/4294967296},S.double=S,C(v(M.S),n),(x.pass||w||function(L,k,$,D){return D&&(D.S&&p(D,M),L.state=function(){return p(M,{})}),$?(r[c]=L,k):L})(S,T,"global"in x?x.global:this==r,x.state)}function y(d){var x,w=d.length,O=this,T=0,M=O.i=O.j=0,S=O.S=[];for(w||(d=[w++]);T<s;)S[T]=T++;for(T=0;T<s;T++)S[T]=S[M=g&M+d[T%w]+(x=S[T])],S[M]=x;(O.g=function(L){for(var k,$=0,D=O.i,V=O.j,_=O.S;L--;)k=_[D=g&D+1],$=$*s+_[g&(_[D]=_[V=g&V+k])+(_[V]=k)];return O.i=D,O.j=V,$})(s)}function p(d,x){return x.i=d.i,x.j=d.j,x.S=d.S.slice(),x}function m(d,x){var w=[],O=typeof d,T;if(x&&O=="object")for(T in d)try{w.push(m(d[T],x-1))}catch{}return w.length?w:O=="string"?d:d+"\0"}function C(d,x){for(var w=d+"",O,T=0;T<w.length;)x[g&T]=g&(O^=x[g&T]*19)+w.charCodeAt(T++);return v(x)}function E(){try{var d;return l&&(d=l.randomBytes)?d=d(s):(d=new Uint8Array(s),(t.crypto||t.msCrypto).getRandomValues(d)),v(d)}catch{var x=t.navigator,w=x&&x.plugins;return[+new Date,t,w,t.screen,v(n)]}}function v(d){return String.fromCharCode.apply(0,d)}if(C(r.random(),n),e.exports){e.exports=h;try{l=Ga}catch{}}else r["seed"+c]=h})(typeof self<"u"?self:Ka,[],Math)}(_t)),_t.exports}var Ce,Fn;function Wa(){if(Fn)return Ce;Fn=1;var e=Na(),t=Ra(),n=_a(),r=Fa(),s=ja(),a=Aa(),i=Ha();return i.alea=e,i.xor128=t,i.xorwow=n,i.xorshift7=r,i.xor4096=s,i.tychei=a,Ce=i,Ce}Wa();const qa=1e-12,{vtkErrorMacro:wc,vtkWarningMacro:Un}=N;function $e(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:3;const t=Array(e);for(let n=0;n<e;++n)t[n]=0;return t}function Xa(e,t,n){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n}function et(e,t,n){return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n}function jn(e,t,n,r){return r[0]=e[0]+t[0]*n,r[1]=e[1]+t[1]*n,r[2]=e[2]+t[2]*n,r}function R(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Ur(e,t,n){const r=e[1]*t[2]-e[2]*t[1],s=e[2]*t[0]-e[0]*t[2],a=e[0]*t[1]-e[1]*t[0];return n[0]=r,n[1]=s,n[2]=a,n}function jr(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:3;switch(t){case 1:return Math.abs(e);case 2:return Math.sqrt(e[0]*e[0]+e[1]*e[1]);case 3:return Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);default:{let n=0;for(let r=0;r<t;r++)n+=e[r]*e[r];return Math.sqrt(n)}}}function Ya(e){const t=jr(e);return t!==0&&(e[0]/=t,e[1]/=t,e[2]/=t),t}function J(e,t){return(e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1])+(e[2]-t[2])*(e[2]-t[2])}function It(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.length===2?t[0][0]*t[1][1]-t[1][0]*t[0][1]:t.length===4?t[0]*t[3]-t[1]*t[2]:Number.NaN}function xe(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(!`${e}`.includes("e"))return+`${Math.round(`${e}e+${t}`)}e-${t}`;const n=`${e}`.split("e");let r="";return+n[1]+t>0&&(r="+"),+`${Math.round(`${+n[0]}e${r}${+n[1]+t}`)}e-${t}`}function zn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return t[0]=xe(e[0],n),t[1]=xe(e[1],n),t[2]=xe(e[2],n),t}function Pa(e,t,n){let r,s,a,i,c=0,o,u,f;const g=$e(n);for(r=0;r<n;r++){for(i=0,s=0;s<n;s++)(f=Math.abs(e[r*n+s]))>i&&(i=f);if(i===0)return Un("Unable to factor linear system"),0;g[r]=1/i}for(s=0;s<n;s++){for(r=0;r<s;r++){for(o=e[r*n+s],a=0;a<r;a++)o-=e[r*n+a]*e[a*n+s];e[r*n+s]=o}for(i=0,r=s;r<n;r++){for(o=e[r*n+s],a=0;a<s;a++)o-=e[r*n+a]*e[a*n+s];e[r*n+s]=o,(u=g[r]*Math.abs(o))>=i&&(i=u,c=r)}if(s!==c){for(a=0;a<n;a++)u=e[c*n+a],e[c*n+a]=e[s*n+a],e[s*n+a]=u;g[c]=g[s]}if(t[s]=c,Math.abs(e[s*n+s])<=qa)return Un("Unable to factor linear system"),0;if(s!==n-1)for(u=1/e[s*n+s],r=s+1;r<n;r++)e[r*n+s]*=u}return 1}function Ja(e,t,n,r){let s,a,i,c,o;for(i=-1,s=0;s<r;s++){if(c=t[s],o=n[c],n[c]=n[s],i>=0)for(a=i;a<=s-1;a++)o-=e[s*r+a]*n[a];else o!==0&&(i=s);n[s]=o}for(s=r-1;s>=0;s--){for(o=n[s],a=s+1;a<r;a++)o-=e[s*r+a]*n[a];n[s]=o/e[s*r+s]}}function Qa(e,t,n){if(n===2){const s=$e(2),a=It(e[0],e[1],e[2],e[3]);return a===0?0:(s[0]=(e[3]*t[0]-e[1]*t[1])/a,s[1]=(-(e[2]*t[0])+e[0]*t[1])/a,t[0]=s[0],t[1]=s[1],1)}if(n===1)return e[0]===0?0:(t[0]/=e[0],1);const r=$e(n);return Pa(e,r,n)===0?0:(Ja(e,r,t,n),1)}function Za(e){return e[0]=1,e[1]=-1,e[2]=1,e[3]=-1,e[4]=1,e[5]=-1,e}function Oe(e,t,n){return e<t?t:e>n?n:e}function An(e,t,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[0,0,0];return r[0]=Oe(e[0],t[0],n[0]),r[1]=Oe(e[1],t[1],n[1]),r[2]=Oe(e[2],t[2],n[2]),r}var zr=1e-6,Y=typeof Float32Array<"u"?Float32Array:Array;function ti(e,t){return Math.abs(e-t)<=zr*Math.max(1,Math.abs(e),Math.abs(t))}Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});function ei(){var e=new Y(9);return Y!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function ni(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function ri(e,t){var n=t[0],r=t[1],s=t[2],a=t[3],i=t[4],c=t[5],o=t[6],u=t[7],f=t[8],g=t[9],l=t[10],h=t[11],y=t[12],p=t[13],m=t[14],C=t[15],E=n*c-r*i,v=n*o-s*i,d=n*u-a*i,x=r*o-s*c,w=r*u-a*c,O=s*u-a*o,T=f*p-g*y,M=f*m-l*y,S=f*C-h*y,L=g*m-l*p,k=g*C-h*p,$=l*C-h*m,D=E*$-v*k+d*L+x*S-w*M+O*T;return D?(D=1/D,e[0]=(c*$-o*k+u*L)*D,e[1]=(s*k-r*$-a*L)*D,e[2]=(p*O-m*w+C*x)*D,e[3]=(l*w-g*O-h*x)*D,e[4]=(o*S-i*$-u*M)*D,e[5]=(n*$-s*S+a*M)*D,e[6]=(m*d-y*O-C*v)*D,e[7]=(f*O-l*d+h*v)*D,e[8]=(i*k-c*S+u*T)*D,e[9]=(r*S-n*k-a*T)*D,e[10]=(y*w-p*d+C*E)*D,e[11]=(g*d-f*w-h*E)*D,e[12]=(c*M-i*L-o*T)*D,e[13]=(n*L-r*M+s*T)*D,e[14]=(p*v-y*x-m*E)*D,e[15]=(f*x-g*v+l*E)*D,e):null}function si(e,t,n){var r=n[0],s=n[1],a=n[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*s,e[5]=t[5]*s,e[6]=t[6]*s,e[7]=t[7]*s,e[8]=t[8]*a,e[9]=t[9]*a,e[10]=t[10]*a,e[11]=t[11]*a,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function ai(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function Ar(){var e=new Y(3);return Y!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function Ee(e){var t=new Y(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function ii(e){var t=e[0],n=e[1],r=e[2];return Math.hypot(t,n,r)}function z(e,t,n){var r=new Y(3);return r[0]=e,r[1]=t,r[2]=n,r}function bn(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function Se(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e}function oi(e,t){var n=t[0],r=t[1],s=t[2],a=n*n+r*r+s*s;return a>0&&(a=1/Math.sqrt(a)),e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a,e}function Re(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function De(e,t,n){var r=t[0],s=t[1],a=t[2],i=n[0],c=n[1],o=n[2];return e[0]=s*o-a*c,e[1]=a*i-r*o,e[2]=r*c-s*i,e}function Ve(e,t,n){var r=t[0],s=t[1],a=t[2],i=n[3]*r+n[7]*s+n[11]*a+n[15];return i=i||1,e[0]=(n[0]*r+n[4]*s+n[8]*a+n[12])/i,e[1]=(n[1]*r+n[5]*s+n[9]*a+n[13])/i,e[2]=(n[2]*r+n[6]*s+n[10]*a+n[14])/i,e}var ci=ii;(function(){var e=Ar();return function(t,n,r,s,a,i){var c,o;for(n||(n=3),r||(r=0),s?o=Math.min(s*n+r,t.length):o=t.length,c=r;c<o;c+=n)e[0]=t[c],e[1]=t[c+1],e[2]=t[c+2],a(e,e,i),t[c]=e[0],t[c+1]=e[1],t[c+2]=e[2];return t}})();function ui(){var e=new Y(4);return Y!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function fi(e,t){var n=t[0],r=t[1],s=t[2],a=t[3],i=n*n+r*r+s*s+a*a;return i>0&&(i=1/Math.sqrt(i)),e[0]=n*i,e[1]=r*i,e[2]=s*i,e[3]=a*i,e}(function(){var e=ui();return function(t,n,r,s,a,i){var c,o;for(n||(n=4),r||(r=0),s?o=Math.min(s*n+r,t.length):o=t.length,c=r;c<o;c+=n)e[0]=t[c],e[1]=t[c+1],e[2]=t[c+2],e[3]=t[c+3],a(e,e,i),t[c]=e[0],t[c+1]=e[1],t[c+2]=e[2],t[c+3]=e[3];return t}})();function Bn(){var e=new Y(4);return Y!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function li(e,t,n){n=n*.5;var r=Math.sin(n);return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=Math.cos(n),e}function Ft(e,t,n,r){var s=t[0],a=t[1],i=t[2],c=t[3],o=n[0],u=n[1],f=n[2],g=n[3],l,h,y,p,m;return h=s*o+a*u+i*f+c*g,h<0&&(h=-h,o=-o,u=-u,f=-f,g=-g),1-h>zr?(l=Math.acos(h),y=Math.sin(l),p=Math.sin((1-r)*l)/y,m=Math.sin(r*l)/y):(p=1-r,m=r),e[0]=p*s+m*o,e[1]=p*a+m*u,e[2]=p*i+m*f,e[3]=p*c+m*g,e}function gi(e,t){var n=t[0]+t[4]+t[8],r;if(n>0)r=Math.sqrt(n+1),e[3]=.5*r,r=.5/r,e[0]=(t[5]-t[7])*r,e[1]=(t[6]-t[2])*r,e[2]=(t[1]-t[3])*r;else{var s=0;t[4]>t[0]&&(s=1),t[8]>t[s*3+s]&&(s=2);var a=(s+1)%3,i=(s+2)%3;r=Math.sqrt(t[s*3+s]-t[a*3+a]-t[i*3+i]+1),e[s]=.5*r,r=.5/r,e[3]=(t[a*3+i]-t[i*3+a])*r,e[a]=(t[a*3+s]+t[s*3+a])*r,e[i]=(t[i*3+s]+t[s*3+i])*r}return e}var br=fi;(function(){var e=Ar(),t=z(1,0,0),n=z(0,1,0);return function(r,s,a){var i=Re(s,a);return i<-.999999?(De(e,t,s),ci(e)<1e-6&&De(e,n,s),oi(e,e),li(r,e,Math.PI),r):i>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(De(e,s,a),r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=1+i,br(r,r))}})();(function(){var e=Bn(),t=Bn();return function(n,r,s,a,i,c){return Ft(e,r,i,c),Ft(t,s,a,c),Ft(n,e,t,2*c*(1-c)),n}})();(function(){var e=ei();return function(t,n,r,s){return e[0]=r[0],e[3]=r[1],e[6]=r[2],e[1]=s[0],e[4]=s[1],e[7]=s[2],e[2]=-n[0],e[5]=-n[1],e[8]=-n[2],br(t,gi(t,e))}})();const _e=1e-6,Br="coincide",Gr="disjoint";function hi(e,t,n){return e[0]*(n[0]-t[0])+e[1]*(n[1]-t[1])+e[2]*(n[2]-t[2])}function Kr(e,t,n){const r=n[0]*(e[0]-t[0])+n[1]*(e[1]-t[1])+n[2]*(e[2]-t[2]);return Math.abs(r)}function Hr(e,t,n,r){const s=[];et(e,t,s);const a=R(n,s);r[0]=e[0]-a*n[0],r[1]=e[1]-a*n[1],r[2]=e[2]-a*n[2]}function Wr(e,t,n){const r=R(e,t);let s=R(t,t);return s===0&&(s=1),n[0]=e[0]-r*t[0]/s,n[1]=e[1]-r*t[1]/s,n[2]=e[2]-r*t[2]/s,n}function qr(e,t,n,r){const s=[];et(e,t,s);const a=R(n,s),i=R(n,n);i!==0?(r[0]=e[0]-a*n[0]/i,r[1]=e[1]-a*n[1]/i,r[2]=e[2]-a*n[2]/i):(r[0]=e[0],r[1]=e[1],r[2]=e[2])}function Xr(e,t,n,r){const s={intersection:!1,betweenPoints:!1,t:Number.MAX_VALUE,x:[]},a=[],i=[];et(t,e,a),et(n,e,i);const c=R(r,i),o=R(r,a);let u,f;return o<0?u=-o:u=o,c<0?f=-c*_e:f=c*_e,u<=f||(s.t=c/o,s.x[0]=e[0]+s.t*a[0],s.x[1]=e[1]+s.t*a[1],s.x[2]=e[2]+s.t*a[2],s.intersection=!0,s.betweenPoints=s.t>=0&&s.t<=1),s}function Yr(e,t,n,r){const s={intersection:!1,l0:[],l1:[],error:null},a=[];Ur(t,r,a);const i=a.map(g=>Math.abs(g));if(i[0]+i[1]+i[2]<_e){const g=[];return et(e,n,g),R(t,g)===0?s.error=Br:s.error=Gr,s}let c;i[0]>i[1]&&i[0]>i[2]?c="x":i[1]>i[2]?c="y":c="z";const o=[],u=-R(t,e),f=-R(r,n);switch(c){case"x":o[0]=0,o[1]=(f*t[2]-u*r[2])/a[0],o[2]=(u*r[1]-f*t[1])/a[0];break;case"y":o[0]=(u*r[2]-f*t[2])/a[1],o[1]=0,o[2]=(f*t[0]-u*r[0])/a[1];break;case"z":o[0]=(f*t[1]-u*r[1])/a[2],o[1]=(u*r[0]-f*t[0])/a[2],o[2]=0;break}return s.l0=o,Xa(o,a,s.l1),s.intersection=!0,s}const yi={evaluate:hi,distanceToPlane:Kr,projectPoint:Hr,projectVector:Wr,generalizedProjectPoint:qr,intersectWithLine:Xr,intersectWithPlane:Yr,DISJOINT:Gr,COINCIDE:Br};function pi(e,t){t.classHierarchy.push("vtkPlane"),e.distanceToPlane=n=>Kr(n,t.origin,t.normal),e.projectPoint=(n,r)=>{Hr(n,t.origin,t.normal,r)},e.projectVector=(n,r)=>Wr(n,t.normal,r),e.push=n=>{if(n!==0)for(let r=0;r<3;r++)t.origin[r]+=n*t.normal[r]},e.generalizedProjectPoint=(n,r)=>{qr(n,t.origin,t.normal,r)},e.evaluateFunction=(n,r,s)=>Array.isArray(n)?t.normal[0]*(n[0]-t.origin[0])+t.normal[1]*(n[1]-t.origin[1])+t.normal[2]*(n[2]-t.origin[2]):t.normal[0]*(n-t.origin[0])+t.normal[1]*(r-t.origin[1])+t.normal[2]*(s-t.origin[2]),e.evaluateGradient=n=>[t.normal[0],t.normal[1],t.normal[2]],e.intersectWithLine=(n,r)=>Xr(n,r,t.origin,t.normal),e.intersectWithPlane=(n,r)=>Yr(n,r,t.origin,t.normal)}const mi={normal:[0,0,1],origin:[0,0,0]};function Pr(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(t,mi,n),N.obj(e,t),N.setGetArray(e,t,["normal","origin"],3),pi(e,t)}const vi=N.newInstance(Pr,"vtkPlane");var ot={newInstance:vi,extend:Pr,...yi};const ee=[Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE];function Jr(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]}function Z(e){return e?.length>=6&&e[0]<=e[1]&&e[2]<=e[3]&&e[4]<=e[5]}function Ye(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function Pe(e){return Ye(e,ee)}function Gt(e,t,n,r){const[s,a,i,c,o,u]=e;return e[0]=s<t?s:t,e[1]=a>t?a:t,e[2]=i<n?i:n,e[3]=c>n?c:n,e[4]=o<r?o:r,e[5]=u>r?u:r,e}function Je(e,t){if(t.length===0)return e;if(Array.isArray(t[0]))for(let n=0;n<t.length;++n)Gt(e,...t[n]);else for(let n=0;n<t.length;n+=3)Gt(e,...t.slice(n,n+3));return e}function Qr(e,t,n,r,s,a,i){const[c,o,u,f,g,l]=e;return i===void 0?(e[0]=Math.min(t[0],c),e[1]=Math.max(t[1],o),e[2]=Math.min(t[2],u),e[3]=Math.max(t[3],f),e[4]=Math.min(t[4],g),e[5]=Math.max(t[5],l)):(e[0]=Math.min(t,c),e[1]=Math.max(n,o),e[2]=Math.min(r,u),e[3]=Math.max(s,f),e[4]=Math.min(a,g),e[5]=Math.max(i,l)),e}function Zr(e,t,n,r){const[s,a,i,c,o,u]=e;return e[0]=t,e[1]=t>a?t:a,e[2]=n,e[3]=n>c?n:c,e[4]=r,e[5]=r>u?r:u,s!==t||i!==n||o!==r}function ts(e,t,n,r){const[s,a,i,c,o,u]=e;return e[0]=t<s?t:s,e[1]=t,e[2]=n<i?n:i,e[3]=n,e[4]=r<o?r:o,e[5]=r,a!==t||c!==n||u!==r}function es(e,t){return e[0]-=t,e[1]+=t,e[2]-=t,e[3]+=t,e[4]-=t,e[5]+=t,e}function Qe(e,t,n,r){return Z(e)?(t>=0?(e[0]*=t,e[1]*=t):(e[0]=t*e[1],e[1]=t*e[0]),n>=0?(e[2]*=n,e[3]*=n):(e[2]=n*e[3],e[3]=n*e[2]),r>=0?(e[4]*=r,e[5]*=r):(e[4]=r*e[5],e[5]=r*e[4]),!0):!1}function Ze(e){return[.5*(e[0]+e[1]),.5*(e[2]+e[3]),.5*(e[4]+e[5])]}function di(e,t,n,r){if(!Z(e))return!1;const s=Ze(e);return e[0]-=s[0],e[1]-=s[0],e[2]-=s[1],e[3]-=s[1],e[4]-=s[2],e[5]-=s[2],Qe(e,t,n,r),e[0]+=s[0],e[1]+=s[0],e[2]+=s[1],e[3]+=s[1],e[4]+=s[2],e[5]+=s[2],!0}function pt(e,t){return e[t*2+1]-e[t*2]}function ne(e){return[pt(e,0),pt(e,1),pt(e,2)]}function ns(e){return e.slice(0,2)}function rs(e){return e.slice(2,4)}function ss(e){return e.slice(4,6)}function as(e){const t=ne(e);return t[0]>t[1]?t[0]>t[2]?t[0]:t[2]:t[1]>t[2]?t[1]:t[2]}function is(e){if(Z(e)){const t=ne(e);return Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2])}return null}function tn(e){return[e[0],e[2],e[4]]}function en(e){return[e[1],e[3],e[5]]}function wt(e,t){return e<=0&&t>=0||e>=0&&t<=0}function nn(e,t){let n=0;for(let r=0;r<2;r++)for(let s=2;s<4;s++)for(let a=4;a<6;a++)t[n++]=[e[r],e[s],e[a]];return t}function os(e,t,n){return t[0]=e[0],t[1]=e[2],t[2]=e[4],n[0]=e[1],n[1]=e[3],n[2]=e[5],t}function cs(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const r=nn(e,[]);for(let s=0;s<r.length;++s)Ve(r[s],r[s],t);return Pe(n),Je(n,r)}function us(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return t[0]=.5*(e[1]-e[0]),t[1]=.5*(e[3]-e[2]),t[2]=.5*(e[5]-e[4]),t}function fs(e,t,n,r){const s=[].concat(ee),a=e.getData();for(let i=0;i<a.length;i+=3){const c=[a[i],a[i+1],a[i+2]],o=R(c,t);s[0]=Math.min(o,s[0]),s[1]=Math.max(o,s[1]);const u=R(c,n);s[2]=Math.min(u,s[2]),s[3]=Math.max(u,s[3]);const f=R(c,r);s[4]=Math.min(f,s[4]),s[5]=Math.max(f,s[5])}return s}function ls(e,t,n,r,s){let a=!0;const i=[];let c=0;const o=[],u=[0,0,0],f=0,g=1,l=2;for(let h=0;h<3;h++)t[h]<e[2*h]?(i[h]=g,u[h]=e[2*h],a=!1):t[h]>e[2*h+1]?(i[h]=f,u[h]=e[2*h+1],a=!1):i[h]=l;if(a)return r[0]=t[0],r[1]=t[1],r[2]=t[2],s[0]=0,1;for(let h=0;h<3;h++)i[h]!==l&&n[h]!==0?o[h]=(u[h]-t[h])/n[h]:o[h]=-1;for(let h=0;h<3;h++)o[c]<o[h]&&(c=h);if(o[c]>1||o[c]<0)return 0;s[0]=o[c];for(let h=0;h<3;h++)if(c!==h){if(r[h]=t[h]+o[c]*n[h],r[h]<e[2*h]||r[h]>e[2*h+1])return 0}else r[h]=u[h];return 1}function gs(e,t,n){const r=[];let s=0,a=1,i=1;for(let c=4;c<=5;++c){r[2]=e[c];for(let o=2;o<=3;++o){r[1]=e[o];for(let u=0;u<=1;++u)if(r[0]=e[u],s=ot.evaluate(n,t,r),i&&(a=s>=0?1:-1,i=0),s===0||a>0&&s<0||a<0&&s>0)return 1}}return 0}function hs(e,t){if(!(Z(e)&&Z(t)))return!1;const n=[0,0,0,0,0,0];let r;for(let s=0;s<3;s++)if(r=!1,t[s*2]>=e[s*2]&&t[s*2]<=e[s*2+1]?(r=!0,n[s*2]=t[s*2]):e[s*2]>=t[s*2]&&e[s*2]<=t[s*2+1]&&(r=!0,n[s*2]=e[s*2]),t[s*2+1]>=e[s*2]&&t[s*2+1]<=e[s*2+1]?(r=!0,n[s*2+1]=t[2*s+1]):e[s*2+1]>=t[s*2]&&e[s*2+1]<=t[s*2+1]&&(r=!0,n[s*2+1]=e[s*2+1]),!r)return!1;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],!0}function Kt(e,t){if(!(Z(e)&&Z(t)))return!1;for(let n=0;n<3;n++)if(!(t[n*2]>=e[n*2]&&t[n*2]<=e[n*2+1])&&!(e[n*2]>=t[n*2]&&e[n*2]<=t[n*2+1])&&!(t[n*2+1]>=e[n*2]&&t[n*2+1]<=e[n*2+1])&&!(e[n*2+1]>=t[n*2]&&e[n*2+1]<=t[n*2+1]))return!1;return!0}function Ht(e,t,n,r){return!(t<e[0]||t>e[1]||n<e[2]||n>e[3]||r<e[4]||r>e[5])}function Ti(e,t){return!(!Kt(e,t)||!Ht(e,...tn(t))||!Ht(e,...en(t)))}function ys(e,t,n){const r=[[0,1,2,3,4,5,6,7],[0,1,4,5,2,3,6,7],[0,2,4,6,1,3,5,7]],s=[0,0,0,0,0,0,0,0];let a=0;for(let g=0;g<2;g++)for(let l=2;l<4;l++)for(let h=4;h<6;h++){const y=[e[g],e[l],e[h]];s[a++]=ot.evaluate(n,t,y)}let i=2;for(;i--&&!(wt(s[r[i][0]],s[r[i][4]])&&wt(s[r[i][1]],s[r[i][5]])&&wt(s[r[i][2]],s[r[i][6]])&&wt(s[r[i][3]],s[r[i][7]])););if(i<0)return!1;const c=Math.sign(n[i]),o=Math.abs((e[i*2+1]-e[i*2])*n[i]);let u=c>0?1:0;for(let g=0;g<4;g++){if(o===0)continue;const l=Math.abs(s[r[i][g]])/o;c>0&&l<u&&(u=l),c<0&&l>u&&(u=l)}const f=(1-u)*e[i*2]+u*e[i*2+1];return c>0?e[i*2]=f:e[i*2+1]=f,!0}class wi{constructor(t){this.bounds=t,this.bounds||(this.bounds=new Float64Array(ee))}getBounds(){return this.bounds}equals(t){return Jr(this.bounds,t)}isValid(){return Z(this.bounds)}setBounds(t){return Ye(this.bounds,t)}reset(){return Pe(this.bounds)}addPoint(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Gt(this.bounds,...n)}addPoints(t){return Je(this.bounds,t)}addBounds(t,n,r,s,a,i){return Qr(this.bounds,t,n,r,s,a,i)}setMinPoint(t,n,r){return Zr(this.bounds,t,n,r)}setMaxPoint(t,n,r){return ts(this.bounds,t,n,r)}inflate(t){return es(this.bounds,t)}scale(t,n,r){return Qe(this.bounds,t,n,r)}getCenter(){return Ze(this.bounds)}getLength(t){return pt(this.bounds,t)}getLengths(){return ne(this.bounds)}getMaxLength(){return as(this.bounds)}getDiagonalLength(){return is(this.bounds)}getMinPoint(){return tn(this.bounds)}getMaxPoint(){return en(this.bounds)}getXRange(){return ns(this.bounds)}getYRange(){return rs(this.bounds)}getZRange(){return ss(this.bounds)}getCorners(t){return nn(this.bounds,t)}computeCornerPoints(t,n){return os(this.bounds,t,n)}computeLocalBounds(t,n,r){return fs(this.bounds,t,n,r)}transformBounds(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return cs(this.bounds,t,n)}computeScale3(t){return us(this.bounds,t)}cutWithPlane(t,n){return ys(this.bounds,t,n)}intersectBox(t,n,r,s){return ls(this.bounds,t,n,r,s)}intersectPlane(t,n){return gs(this.bounds,t,n)}intersect(t){return hs(this.bounds,t)}intersects(t){return Kt(this.bounds,t)}containsPoint(t,n,r){return Ht(this.bounds,t,n,r)}contains(t){return Kt(this.bounds,t)}}function Ci(e){const t=e&&e.bounds;return new wi(t)}const xi={equals:Jr,isValid:Z,setBounds:Ye,reset:Pe,addPoint:Gt,addPoints:Je,addBounds:Qr,setMinPoint:Zr,setMaxPoint:ts,inflate:es,scale:Qe,scaleAboutCenter:di,getCenter:Ze,getLength:pt,getLengths:ne,getMaxLength:as,getDiagonalLength:is,getMinPoint:tn,getMaxPoint:en,getXRange:ns,getYRange:rs,getZRange:ss,getCorners:nn,computeCornerPoints:os,computeLocalBounds:fs,transformBounds:cs,computeScale3:us,cutWithPlane:ys,intersectBox:ls,intersectPlane:gs,intersect:hs,intersects:Kt,containsPoint:Ht,contains:Ti,INIT_BOUNDS:ee};var ft={newInstance:Ci,...xi};const Oi={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},re={VOID:"",CHAR:"Int8Array",SIGNED_CHAR:"Int8Array",UNSIGNED_CHAR:"Uint8Array",UNSIGNED_CHAR_CLAMPED:"Uint8ClampedArray",SHORT:"Int16Array",UNSIGNED_SHORT:"Uint16Array",INT:"Int32Array",UNSIGNED_INT:"Uint32Array",FLOAT:"Float32Array",DOUBLE:"Float64Array"},Ei=re.FLOAT;var ps={DefaultDataType:Ei,DataTypeByteSize:Oi,VtkDataTypes:re};const{vtkErrorMacro:Si}=Fr,{DefaultDataType:Di}=ps,Mi=1e-6;function Ie(e,t,n){const r=e.length;let s=Number.MAX_VALUE,a=-Number.MAX_VALUE,i,c;for(c=t;c<r;c+=n)if(!Number.isNaN(e[c])){s=e[c],a=s;break}for(;c<r;c+=n)i=e[c],i<s?s=i:i>a&&(a=i);return{min:s,max:a}}function Li(){let e=Number.MAX_VALUE,t=-Number.MAX_VALUE,n=0,r=0;return{add(s){e>s&&(e=s),t<s&&(t=s),n++,r+=s},get(){return{min:e,max:t,count:n,sum:r,mean:r/n}},getRange(){return{min:e,max:t}}}}function ms(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;if(t<0&&n>1){const s=e.length/n,a=new Float64Array(s);for(let i=0,c=0;i<s;++i){for(let o=c+n;c<o;++c)a[i]+=e[c]*e[c];a[i]**=.5}return Ie(a,0,1)}return Ie(e,t<0?0:t,n)}function Gn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=e||[];for(;n.length<=t;)n.push(null);return n}function rn(e){return Object.prototype.toString.call(e).slice(8,-1)}function ki(e){const t=e.getNumberOfComponents();let n=0;const r=new Array(t);for(let s=0;s<e.getNumberOfTuples();++s){e.getTuple(s,r);const a=jr(r,t);a>n&&(n=a)}return n}const Ni={computeRange:ms,createRangeHelper:Li,fastComputeRange:Ie,getDataType:rn,getMaxNorm:ki};function $i(e,t){t.classHierarchy.push("vtkDataArray");function n(r){if(r<0)return!1;const s=e.getNumberOfComponents(),a=t.values.length/(s>0?s:1);if(r===a)return!0;if(r>a){const i=t.values;return t.values=Xt(t.dataType,(r+a)*s),t.values.set(i),!0}return t.size>r*s&&(t.size=r*s,e.dataChange()),!0}e.dataChange=()=>{t.ranges=null,e.modified()},e.resize=r=>{n(r);const s=r*e.getNumberOfComponents();return t.size!==s?(t.size=s,e.dataChange(),!0):!1},e.initialize=()=>{e.resize(0)},e.getElementComponentSize=()=>t.values.BYTES_PER_ELEMENT,e.getComponent=function(r){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return t.values[r*t.numberOfComponents+s]},e.setComponent=(r,s,a)=>{a!==t.values[r*t.numberOfComponents+s]&&(t.values[r*t.numberOfComponents+s]=a,e.dataChange())},e.getValue=r=>{const s=r/t.numberOfComponents,a=r%t.numberOfComponents;return e.getComponent(s,a)},e.setValue=(r,s)=>{const a=r/t.numberOfComponents,i=r%t.numberOfComponents;e.setComponent(a,i,s)},e.getData=()=>t.size===t.values.length?t.values:t.values.subarray(0,t.size),e.getRange=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:-1,s=r;s<0&&(s=t.numberOfComponents===1?0:t.numberOfComponents);let a=null;return t.ranges||(t.ranges=Gn(t.ranges,t.numberOfComponents)),a=t.ranges[s],a?(t.rangeTuple[0]=a.min,t.rangeTuple[1]=a.max,t.rangeTuple):(a=ms(e.getData(),r,t.numberOfComponents),t.ranges[s]=a,t.rangeTuple[0]=a.min,t.rangeTuple[1]=a.max,t.rangeTuple)},e.setRange=(r,s)=>{t.ranges||(t.ranges=Gn(t.ranges,t.numberOfComponents));const a={min:r.min,max:r.max};return t.ranges[s]=a,t.rangeTuple[0]=a.min,t.rangeTuple[1]=a.max,t.rangeTuple},e.setTuple=(r,s)=>{const a=r*t.numberOfComponents;for(let i=0;i<t.numberOfComponents;i++)t.values[a+i]=s[i]},e.setTuples=(r,s)=>{let a=r*t.numberOfComponents;const i=Math.min(s.length,t.size-a);for(let c=0;c<i;)t.values[a++]=s[c++]},e.insertTuple=(r,s)=>(t.size<=r*t.numberOfComponents&&(t.size=(r+1)*t.numberOfComponents,n(r+1)),e.setTuple(r,s),r),e.insertTuples=(r,s)=>{const a=r+s.length/t.numberOfComponents;return t.size<a*t.numberOfComponents&&(t.size=a*t.numberOfComponents,n(a)),e.setTuples(r,s),a},e.insertNextTuple=r=>{const s=t.size/t.numberOfComponents;return e.insertTuple(s,r)},e.insertNextTuples=r=>{const s=t.size/t.numberOfComponents;return e.insertTuples(s,r)},e.findTuple=function(r){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Mi;for(let a=0;a<t.size;a+=t.numberOfComponents)if(Math.abs(r[0]-t.values[a])<=s){let i=!0;for(let c=1;c<t.numberOfComponents;++c)if(Math.abs(r[c]-t.values[a+c])>s){i=!1;break}if(i)return a/t.numberOfComponents}return-1},e.getTuple=function(r){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const a=t.numberOfComponents||1,i=r*a;switch(a){case 4:s[3]=t.values[i+3];case 3:s[2]=t.values[i+2];case 2:s[1]=t.values[i+1];case 1:s[0]=t.values[i];break;default:for(let c=a-1;c>=0;--c)s[c]=t.values[i+c]}return s},e.getTuples=(r,s)=>{const a=(r??0)*t.numberOfComponents,i=(s??e.getNumberOfTuples())*t.numberOfComponents,c=e.getData().subarray(a,i);return c.length>0?c:null},e.getTupleLocation=function(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:1)*t.numberOfComponents},e.getNumberOfComponents=()=>t.numberOfComponents,e.getNumberOfValues=()=>t.size,e.getNumberOfTuples=()=>t.size/t.numberOfComponents,e.getDataType=()=>t.dataType,e.newClone=()=>ds({empty:!0,name:t.name,dataType:t.dataType,numberOfComponents:t.numberOfComponents}),e.getName=()=>(t.name||(e.modified(),t.name=`vtkDataArray${e.getMTime()}`),t.name),e.setData=(r,s)=>{t.values=r,t.size=r.length,t.dataType=rn(r),s&&(t.numberOfComponents=s),t.size%t.numberOfComponents!==0&&(t.numberOfComponents=1),e.dataChange()},e.getState=()=>{if(t.deleted)return null;const r={...t,vtkClass:e.getClassName()};r.values=Array.from(r.values),delete r.buffer,Object.keys(r).forEach(a=>{r[a]||delete r[a]});const s={};return Object.keys(r).sort().forEach(a=>{s[a]=r[a]}),s.mtime&&delete s.mtime,s},e.deepCopy=r=>{const s=e.getDataType(),a=t.values;e.shallowCopy(r),a?.length>=r.getNumberOfValues()&&s===r.getDataType()?(a.set(r.getData()),t.values=a,e.dataChange()):e.setData(r.getData().slice())},e.interpolateTuple=(r,s,a,i,c,o)=>{const u=t.numberOfComponents||1;(u!==s.getNumberOfComponents()||u!==i.getNumberOfComponents())&&Si("numberOfComponents must match");const f=s.getTuple(a),g=i.getTuple(c),l=[];switch(l.length=u,u){case 4:l[3]=f[3]+(g[3]-f[3])*o;case 3:l[2]=f[2]+(g[2]-f[2])*o;case 2:l[1]=f[1]+(g[1]-f[1])*o;case 1:l[0]=f[0]+(g[0]-f[0])*o;break;default:for(let h=0;h<u;h++)l[h]=f[h]+(g[h]-f[h])*o}return e.insertTuple(r,l)}}const Ri={name:"",numberOfComponents:1,dataType:Di,rangeTuple:[0,0]};function vs(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(Object.assign(t,Ri,n),!t.empty&&!t.values&&!t.size)throw new TypeError("Cannot create vtkDataArray object without: size > 0, values");if(t.values?Array.isArray(t.values)&&(t.values=Yt(t.dataType,t.values)):t.values=Xt(t.dataType,t.size),t.values&&(t.size=t.size??t.values.length,t.dataType=rn(t.values)),Jt(e,t),Qt(e,t,["name","numberOfComponents"]),t.size%t.numberOfComponents!==0)throw new RangeError("model.size is not a multiple of model.numberOfComponents");$i(e,t)}const ds=te(vs,"vtkDataArray");var Q={newInstance:ds,extend:vs,...Ni,...ps};const{vtkErrorMacro:Kn,vtkWarningMacro:Vi}=N;function _i(e,t){t.classHierarchy.push("vtkFieldData");const n=e.getState;t.arrays&&(t.arrays=t.arrays.map(r=>({data:W(r.data)}))),e.initialize=()=>{e.initializeFields(),e.copyAllOn(),e.clearFieldFlags()},e.initializeFields=()=>{t.arrays=[],t.copyFieldFlags={},e.modified()},e.copyStructure=r=>{e.initializeFields(),t.copyFieldFlags=r.getCopyFieldFlags().map(s=>s),t.arrays=r.arrays().map(s=>({array:s}))},e.getNumberOfArrays=()=>t.arrays.length,e.getNumberOfActiveArrays=()=>t.arrays.length,e.addArray=r=>{const s=r.getName(),{array:a,index:i}=e.getArrayWithIndex(s);return a!=null?(t.arrays[i]={data:r},i):(t.arrays=[].concat(t.arrays,{data:r}),t.arrays.length-1)},e.removeAllArrays=()=>{t.arrays=[]},e.removeArray=r=>{const s=t.arrays.findIndex(a=>a.data.getName()===r);return e.removeArrayByIndex(s)},e.removeArrayByIndex=r=>r!==-1&&r<t.arrays.length?(t.arrays.splice(r,1),!0):!1,e.getArrays=()=>t.arrays.map(r=>r.data),e.getArray=r=>typeof r=="number"?e.getArrayByIndex(r):e.getArrayByName(r),e.getArrayByName=r=>t.arrays.reduce((s,a,i)=>a.data.getName()===r?a.data:s,null),e.getArrayWithIndex=r=>{const s=t.arrays.findIndex(a=>a.data.getName()===r);return{array:s!==-1?t.arrays[s].data:null,index:s}},e.getArrayByIndex=r=>r>=0&&r<t.arrays.length?t.arrays[r].data:null,e.hasArray=r=>e.getArrayWithIndex(r).index>=0,e.getArrayName=r=>{const s=t.arrays[r];return s?s.data.getName():""},e.getCopyFieldFlags=()=>t.copyFieldFlags,e.getFlag=r=>t.copyFieldFlags[r],e.passData=function(r){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1;r.getArrays().forEach(i=>{const c=e.getFlag(i.getName());if(c!==!1&&!(t.doCopyAllOff&&c!==!0)&&i){let o=e.getArrayByName(i.getName());if(o)if(i.getNumberOfComponents()===o.getNumberOfComponents())if(s>-1&&s<i.getNumberOfTuples()){const u=a>-1?a:s;o.insertTuple(u,i.getTuple(s))}else o.insertTuples(0,i.getTuples());else Kn("Unhandled case in passData");else if(s<0||s>i.getNumberOfTuples())e.addArray(i),r.getAttributes(i).forEach(u=>{e.setAttribute(i,u)});else{const u=i.getNumberOfComponents();let f=i.getNumberOfValues();const g=a>-1?a:s;f<=g*u&&(f=(g+1)*u),o=Q.newInstance({name:i.getName(),dataType:i.getDataType(),numberOfComponents:u,values:N.newTypedArray(i.getDataType(),f),size:0}),o.insertTuple(g,i.getTuple(s)),e.addArray(o),r.getAttributes(i).forEach(l=>{e.setAttribute(o,l)})}}})},e.interpolateData=function(r){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:-1,c=arguments.length>4&&arguments[4]!==void 0?arguments[4]:.5;r.getArrays().forEach(o=>{const u=e.getFlag(o.getName());if(u!==!1&&!(t.doCopyAllOff&&u!==!0)&&o){let f=e.getArrayByName(o.getName());if(f)if(o.getNumberOfComponents()===f.getNumberOfComponents())if(s>-1&&s<o.getNumberOfTuples()){const g=i>-1?i:s;f.interpolateTuple(g,o,s,o,a,c),Vi("Unexpected case in interpolateData")}else f.insertTuples(o.getTuples());else Kn("Unhandled case in interpolateData");else if(s<0||a<0||s>o.getNumberOfTuples())e.addArray(o),r.getAttributes(o).forEach(g=>{e.setAttribute(o,g)});else{const g=o.getNumberOfComponents();let l=o.getNumberOfValues();const h=i>-1?i:s;l<=h*g&&(l=(h+1)*g),f=Q.newInstance({name:o.getName(),dataType:o.getDataType(),numberOfComponents:g,values:N.newTypedArray(o.getDataType(),l),size:0}),f.interpolateTuple(h,o,s,o,a,c),e.addArray(f),r.getAttributes(o).forEach(y=>{e.setAttribute(f,y)})}}})},e.copyFieldOn=r=>{t.copyFieldFlags[r]=!0},e.copyFieldOff=r=>{t.copyFieldFlags[r]=!1},e.copyAllOn=()=>{(!t.doCopyAllOn||t.doCopyAllOff)&&(t.doCopyAllOn=!0,t.doCopyAllOff=!1,e.modified())},e.copyAllOff=()=>{(t.doCopyAllOn||!t.doCopyAllOff)&&(t.doCopyAllOn=!1,t.doCopyAllOff=!0,e.modified())},e.clearFieldFlags=()=>{t.copyFieldFlags={}},e.deepCopy=r=>{t.arrays=r.getArrays().map(s=>{const a=s.newClone();return a.deepCopy(s),{data:a}})},e.copyFlags=r=>r.getCopyFieldFlags().map(s=>s),e.reset=()=>t.arrays.forEach(r=>r.data.reset()),e.getMTime=()=>t.arrays.reduce((r,s)=>s.data.getMTime()>r?s.data.getMTime():r,t.mtime),e.getNumberOfComponents=()=>t.arrays.reduce((r,s)=>r+s.data.getNumberOfComponents(),0),e.getNumberOfTuples=()=>t.arrays.length>0?t.arrays[0].getNumberOfTuples():0,e.getState=()=>{const r=n();return r&&(r.arrays=t.arrays.map(s=>({data:s.data.getState()}))),r}}const Ii={arrays:[],copyFieldFlags:[],doCopyAllOn:!0,doCopyAllOff:!1};function Ts(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(t,Ii,n),N.obj(e,t),_i(e,t)}const Fi=N.newInstance(Ts,"vtkFieldData");var Ui={newInstance:Fi,extend:Ts};const ji={SCALARS:0,VECTORS:1,NORMALS:2,TCOORDS:3,TENSORS:4,GLOBALIDS:5,PEDIGREEIDS:6,EDGEFLAG:7,NUM_ATTRIBUTES:8},zi={MAX:0,EXACT:1,NOLIMIT:2},Ai={DUPLICATECELL:1,HIGHCONNECTIVITYCELL:2,LOWCONNECTIVITYCELL:4,REFINEDCELL:8,EXTERIORCELL:16,HIDDENCELL:32},bi={DUPLICATEPOINT:1,HIDDENPOINT:2},Bi={COPYTUPLE:0,INTERPOLATE:1,PASSDATA:2,ALLCOPY:3},Gi="vtkGhostType",Ki={DEFAULT:0,SINGLE:1,DOUBLE:2};var ws={AttributeCopyOperations:Bi,AttributeLimitTypes:zi,AttributeTypes:ji,CellGhostTypes:Ai,DesiredOutputPrecision:Ki,PointGhostTypes:bi,ghostArrayName:Gi};const{AttributeTypes:tt,AttributeCopyOperations:rt}=ws,{vtkWarningMacro:Ct}=N;function Hi(e,t){const n=["Scalars","Vectors","Normals","TCoords","Tensors","GlobalIds","PedigreeIds"];function r(i){let c=n.find(o=>tt[o.toUpperCase()]===i||typeof i!="number"&&o.toLowerCase()===i.toLowerCase());return typeof c>"u"&&(c=null),c}t.classHierarchy.push("vtkDataSetAttributes");const s={...e};e.checkNumberOfComponents=i=>!0,e.setAttribute=(i,c)=>{const o=r(c);if(i&&o.toUpperCase()==="PEDIGREEIDS"&&!i.isA("vtkDataArray"))return Ct(`Cannot set attribute ${o}. The attribute must be a vtkDataArray.`),-1;if(i&&!e.checkNumberOfComponents(i,o))return Ct(`Cannot set attribute ${o}. Incorrect number of components.`),-1;let u=t[`active${o}`];if(u>=0&&u<t.arrays.length){if(t.arrays[u]===i)return u;e.removeArrayByIndex(u)}return i?(u=e.addArray(i),t[`active${o}`]=u):t[`active${o}`]=-1,e.modified(),t[`active${o}`]},e.getAttributes=i=>n.filter(c=>e[`get${c}`]()===i),e.setActiveAttributeByName=(i,c)=>e.setActiveAttributeByIndex(e.getArrayWithIndex(i).index,c),e.setActiveAttributeByIndex=(i,c)=>{const o=r(c);if(i>=0&&i<t.arrays.length){if(o.toUpperCase()!=="PEDIGREEIDS"){const u=e.getArrayByIndex(i);if(!u.isA("vtkDataArray"))return Ct(`Cannot set attribute ${o}. Only vtkDataArray subclasses can be set as active attributes.`),-1;if(!e.checkNumberOfComponents(u,o))return Ct(`Cannot set attribute ${o}. Incorrect number of components.`),-1}return t[`active${o}`]=i,e.modified(),i}return i===-1&&(t[`active${o}`]=i,e.modified()),-1},e.getActiveAttribute=i=>{const c=r(i);return e[`get${c}`]()},e.removeAllArrays=()=>{n.forEach(i=>{t[`active${i}`]=-1}),s.removeAllArrays()},e.removeArrayByIndex=i=>(i!==-1&&n.forEach(c=>{i===t[`active${c}`]?t[`active${c}`]=-1:i<t[`active${c}`]&&(t[`active${c}`]-=1)}),s.removeArrayByIndex(i)),n.forEach(i=>{const c=`active${i}`;e[`get${i}`]=()=>e.getArrayByIndex(t[c]),e[`set${i}`]=o=>e.setAttribute(o,i),e[`setActive${i}`]=o=>e.setActiveAttributeByIndex(e.getArrayWithIndex(o).index,i),e[`copy${i}Off`]=()=>{const o=i.toUpperCase();t.copyAttributeFlags[rt.PASSDATA][tt[o]]=!1},e[`copy${i}On`]=()=>{const o=i.toUpperCase();t.copyAttributeFlags[rt.PASSDATA][tt[o]]=!0}}),e.initializeAttributeCopyFlags=()=>{t.copyAttributeFlags=[],Object.keys(rt).filter(i=>i!=="ALLCOPY").forEach(i=>{t.copyAttributeFlags[rt[i]]=Object.keys(tt).filter(c=>c!=="NUM_ATTRIBUTES").reduce((c,o)=>(c[tt[o]]=!0,c),[])}),t.copyAttributeFlags[rt.COPYTUPLE][tt.GLOBALIDS]=!1,t.copyAttributeFlags[rt.INTERPOLATE][tt.GLOBALIDS]=!1,t.copyAttributeFlags[rt.COPYTUPLE][tt.PEDIGREEIDS]=!1},e.initialize=N.chain(e.initialize,e.initializeAttributeCopyFlags),t.dataArrays&&Object.keys(t.dataArrays).length&&Object.keys(t.dataArrays).forEach(i=>{!t.dataArrays[i].ref&&t.dataArrays[i].type==="vtkDataArray"&&e.addArray(Q.newInstance(t.dataArrays[i]))});const a=e.shallowCopy;e.shallowCopy=(i,c)=>{a(i,c),t.arrays=i.getArrays().map(o=>{const u=o.newClone();return u.shallowCopy(o,c),{data:u}})},e.initializeAttributeCopyFlags()}const Wi={activeScalars:-1,activeVectors:-1,activeTensors:-1,activeNormals:-1,activeTCoords:-1,activeGlobalIds:-1,activePedigreeIds:-1};function Cs(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(t,Wi,n),Ui.extend(e,t,n),N.setGet(e,t,["activeScalars","activeNormals","activeTCoords","activeVectors","activeTensors","activeGlobalIds","activePedigreeIds"]),t.arrays||(t.arrays={}),Hi(e,t)}const qi=N.newInstance(Cs,"vtkDataSetAttributes");var Hn={newInstance:qi,extend:Cs,...ws};const Xi={UNIFORM:0,DATA_OBJECT_FIELD:0,COORDINATE:1,POINT_DATA:1,POINT:2,POINT_FIELD_DATA:2,CELL:3,CELL_FIELD_DATA:3,VERTEX:4,VERTEX_FIELD_DATA:4,EDGE:5,EDGE_FIELD_DATA:5,ROW:6,ROW_DATA:6},Yi={FIELD_ASSOCIATION_POINTS:0,FIELD_ASSOCIATION_CELLS:1,FIELD_ASSOCIATION_NONE:2,FIELD_ASSOCIATION_POINTS_THEN_CELLS:3,FIELD_ASSOCIATION_VERTICES:4,FIELD_ASSOCIATION_EDGES:5,FIELD_ASSOCIATION_ROWS:6,NUMBER_OF_ASSOCIATIONS:7};var Pi={FieldDataTypes:Xi,FieldAssociations:Yi};const Fe=["pointData","cellData","fieldData"];function Ji(e,t){t.classHierarchy.push("vtkDataSet"),Fe.forEach(r=>{t[r]?t[r]=W(t[r]):t[r]=Hn.newInstance()});const n=e.shallowCopy;e.shallowCopy=function(r){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;n(r,s),Fe.forEach(a=>{t[a]=Hn.newInstance(),t[a].shallowCopy(r.getReferenceByName(a))})}}const Qi={};function xs(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(t,Qi,n),N.obj(e,t),N.setGet(e,t,Fe),Ji(e,t)}const Zi=N.newInstance(xs,"vtkDataSet");var Os={newInstance:Zi,extend:xs,...Pi};const K={UNCHANGED:0,SINGLE_POINT:1,X_LINE:2,Y_LINE:3,Z_LINE:4,XY_PLANE:5,YZ_PLANE:6,XZ_PLANE:7,XYZ_GRID:8,EMPTY:9};var Es={StructuredType:K};const{StructuredType:P}=Es;function to(e){let t=0;for(let n=0;n<3;++n)e[n*2]<e[n*2+1]&&t++;return e[0]>e[1]||e[2]>e[3]||e[4]>e[5]?P.EMPTY:t===3?P.XYZ_GRID:t===2?e[0]===e[1]?P.YZ_PLANE:e[2]===e[3]?P.XZ_PLANE:P.XY_PLANE:t===1?e[0]<e[1]?P.X_LINE:e[2]<e[3]?P.Y_LINE:P.Z_LINE:P.SINGLE_POINT}var eo={getDataDescriptionFromExtent:to,...Es};const{vtkErrorMacro:st}=N;function no(e,t){t.classHierarchy.push("vtkImageData"),e.setExtent=function(){if(t.deleted)return st("instance deleted - cannot call any method"),!1;for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];const a=r.length===1?r[0]:r;if(a.length!==6)return!1;const i=t.extent.some((c,o)=>c!==a[o]);return i&&(t.extent=a.slice(),t.dataDescription=eo.getDataDescriptionFromExtent(t.extent),e.modified()),i},e.setDimensions=function(){let n,r,s;if(t.deleted){st("instance deleted - cannot call any method");return}if(arguments.length===1){const a=arguments.length<=0?void 0:arguments[0];n=a[0],r=a[1],s=a[2]}else if(arguments.length===3)n=arguments.length<=0?void 0:arguments[0],r=arguments.length<=1?void 0:arguments[1],s=arguments.length<=2?void 0:arguments[2];else{st("Bad dimension specification");return}e.setExtent(0,n-1,0,r-1,0,s-1)},e.getDimensions=()=>[t.extent[1]-t.extent[0]+1,t.extent[3]-t.extent[2]+1,t.extent[5]-t.extent[4]+1],e.getNumberOfCells=()=>{const n=e.getDimensions();let r=1;for(let s=0;s<3;s++){if(n[s]===0)return 0;n[s]>1&&(r*=n[s]-1)}return r},e.getNumberOfPoints=()=>{const n=e.getDimensions();return n[0]*n[1]*n[2]},e.getPoint=n=>{const r=e.getDimensions();if(r[0]===0||r[1]===0||r[2]===0)return st("Requesting a point from an empty image."),null;const s=new Float64Array(3);switch(t.dataDescription){case K.EMPTY:return null;case K.SINGLE_POINT:break;case K.X_LINE:s[0]=n;break;case K.Y_LINE:s[1]=n;break;case K.Z_LINE:s[2]=n;break;case K.XY_PLANE:s[0]=n%r[0],s[1]=n/r[0];break;case K.YZ_PLANE:s[1]=n%r[1],s[2]=n/r[1];break;case K.XZ_PLANE:s[0]=n%r[0],s[2]=n/r[0];break;case K.XYZ_GRID:s[0]=n%r[0],s[1]=n/r[0]%r[1],s[2]=n/(r[0]*r[1]);break;default:st("Invalid dataDescription");break}const a=[0,0,0];return e.indexToWorld(s,a),a},e.getBounds=()=>e.extentToBounds(e.getSpatialExtent()),e.extentToBounds=n=>ft.transformBounds(n,t.indexToWorld),e.getSpatialExtent=()=>ft.inflate([...t.extent],.5),e.computeTransforms=()=>{ai(t.indexToWorld,t.origin),t.indexToWorld[0]=t.direction[0],t.indexToWorld[1]=t.direction[1],t.indexToWorld[2]=t.direction[2],t.indexToWorld[4]=t.direction[3],t.indexToWorld[5]=t.direction[4],t.indexToWorld[6]=t.direction[5],t.indexToWorld[8]=t.direction[6],t.indexToWorld[9]=t.direction[7],t.indexToWorld[10]=t.direction[8],si(t.indexToWorld,t.indexToWorld,t.spacing),ri(t.worldToIndex,t.indexToWorld)},e.indexToWorld=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return Ve(r,n,t.indexToWorld),r},e.indexToWorldVec3=e.indexToWorld,e.worldToIndex=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return Ve(r,n,t.worldToIndex),r},e.worldToIndexVec3=e.worldToIndex,e.indexToWorldBounds=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return ft.transformBounds(n,t.indexToWorld,r)},e.worldToIndexBounds=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return ft.transformBounds(n,t.worldToIndex,r)},e.onModified(e.computeTransforms),e.computeTransforms(),e.getCenter=()=>ft.getCenter(e.getBounds()),e.computeHistogram=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const s=[0,0,0,0,0,0];e.worldToIndexBounds(n,s);const a=[0,0,0],i=[0,0,0];ft.computeCornerPoints(s,a,i),zn(a,a),zn(i,i);const c=e.getDimensions();An(a,[0,0,0],[c[0]-1,c[1]-1,c[2]-1],a),An(i,[0,0,0],[c[0]-1,c[1]-1,c[2]-1],i);const o=c[0],u=c[0]*c[1],f=e.getPointData().getScalars().getData();let g=-1/0,l=1/0,h=0,y=0,p=0;for(let v=a[2];v<=i[2];v++)for(let d=a[1];d<=i[1];d++){let x=a[0]+d*o+v*u;for(let w=a[0];w<=i[0];w++){if(!r||r([w,d,v],s)){const O=f[x];O>g&&(g=O),O<l&&(l=O),h+=O*O,y+=O,p+=1}++x}}const m=p>0?y/p:0,C=p?Math.abs(h/p-m*m):0,E=Math.sqrt(C);return{minimum:l,maximum:g,average:m,variance:C,sigma:E,count:p}},e.computeIncrements=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const s=[];let a=r;for(let i=0;i<3;++i)s[i]=a,a*=n[i*2+1]-n[i*2]+1;return s},e.computeOffsetIndex=n=>{let[r,s,a]=n;const i=e.getExtent(),c=e.getPointData().getScalars().getNumberOfComponents(),o=e.computeIncrements(i,c);return Math.floor((Math.round(r)-i[0])*o[0]+(Math.round(s)-i[2])*o[1]+(Math.round(a)-i[4])*o[2])},e.getOffsetIndexFromWorld=n=>{const r=e.getExtent(),s=e.worldToIndex(n);for(let a=0;a<3;++a)if(s[a]<r[a*2]||s[a]>r[a*2+1])return st(`GetScalarPointer: Pixel ${s} is not in memory. Current extent = ${r}`),NaN;return e.computeOffsetIndex(s)},e.getScalarValueFromWorld=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const s=e.getPointData().getScalars().getNumberOfComponents();if(r<0||r>=s)return st(`GetScalarPointer: Scalar Component ${r} is not within bounds. Current Scalar numberOfComponents: ${s}`),NaN;const a=e.getOffsetIndexFromWorld(n);return Number.isNaN(a)?a:e.getPointData().getScalars().getComponent(a,r)}}const ro={direction:null,indexToWorld:null,worldToIndex:null,spacing:[1,1,1],origin:[0,0,0],extent:[0,-1,0,-1,0,-1],dataDescription:K.EMPTY};function Ss(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(t,ro,n),Os.extend(e,t,n),t.direction?Array.isArray(t.direction)&&(t.direction=new Float64Array(t.direction.slice(0,9))):t.direction=ni(new Float64Array(9)),t.indexToWorld=new Float64Array(16),t.worldToIndex=new Float64Array(16),N.get(e,t,["indexToWorld","worldToIndex"]),N.setGetArray(e,t,["origin","spacing"],3),N.setGetArray(e,t,["direction"],9),N.getArray(e,t,["extent"],6),no(e,t)}const so=N.newInstance(Ss,"vtkImageData");var xt={newInstance:so,extend:Ss},Ds=(e=>(e[e.DEBUG=0]="DEBUG",e[e.INFO=1]="INFO",e[e.WARN=2]="WARN",e[e.ERROR=3]="ERROR",e[e.FATAL=4]="FATAL",e))(Ds||{});class ao{currentLevel=1;isProduction=!0;logs=[];maxLogHistory=1e3;setLevel(t){this.currentLevel=t}getLevel(){return this.currentLevel}debug(t,n){this.shouldLog(0)&&this.log(0,t,n)}info(t,n){this.shouldLog(1)&&this.log(1,t,n)}warn(t,n,r){this.shouldLog(2)&&this.log(2,t,n,r)}error(t,n,r){this.shouldLog(3)&&this.log(3,t,n,r)}fatal(t,n,r){this.shouldLog(4)&&this.log(4,t,n,r)}medical(t,n){this.info(`[MEDICAL] ${t}`,n)}performance(t,n,r){this.info(`[PERF] ${t} (${n.toFixed(2)}ms)`,{...r,metadata:{...r?.metadata,duration:n}})}security(t,n,r){this.warn(`[SECURITY] ${t}`,n,r)}interaction(t,n){this.debug(`[UI] ${t}`,n)}log(t,n,r,s){const a={timestamp:new Date().toISOString(),level:t,message:n,context:r,error:s};this.logs.push(a),this.logs.length>this.maxLogHistory&&this.logs.shift(),this.outputToConsole(a),this.isProduction&&t>=3&&this.sendToMonitoring(a)}shouldLog(t){return t>=this.currentLevel}outputToConsole(t){const n=Ds[t.level],r=this.getLevelEmoji(t.level),s=this.isProduction?t.timestamp:t.timestamp.split("T")[1].slice(0,8);let a=`${r} [${s}] ${n}: ${t.message}`;t.context?.component&&(a+=` (${t.context.component})`);const i=this.getConsoleMethod(t.level);t.error?i(a,t.context,t.error):t.context?i(a,t.context):i(a)}getLevelEmoji(t){switch(t){case 0:return"";case 1:return"";case 2:return"";case 3:return"";case 4:return"";default:return""}}getConsoleMethod(t){switch(t){case 0:return console.debug;case 1:return console.info;case 2:return console.warn;case 3:case 4:return console.error;default:return console.log}}sendToMonitoring(t){try{t.level>=4&&console.error(" CRITICAL ERROR - IMMEDIATE ATTENTION REQUIRED:",{message:t.message,context:t.context,error:t.error,timestamp:t.timestamp})}catch(n){console.error("Failed to send log to monitoring service:",n)}}getRecentLogs(t=50){return this.logs.slice(-t)}clearLogs(){this.logs=[]}exportLogs(){return JSON.stringify(this.logs,null,2)}}const X=new ao;X.setLevel(1);const Ot={debug:(e,t)=>X.debug(e,t),info:(e,t)=>X.info(e,t),warn:(e,t,n)=>X.warn(e,t,n),error:(e,t,n)=>X.error(e,t,n),fatal:(e,t,n)=>X.fatal(e,t,n),medical:(e,t)=>X.medical(e,t),performance:(e,t,n)=>X.performance(e,t,n),security:(e,t,n)=>X.security(e,t,n),interaction:(e,t)=>X.interaction(e,t)};class ht{initialized=!1;constructor(){Ot.info("Canvas-based polygon segmentation initialized",{component:"ICRPolySeg"})}static getInstance(){return new ht}async init(){return this.initialized=!0,Promise.resolve()}async process(t,n,r,s={}){if(!this.initialized)return Ot.warn("ICRPolySeg not initialized, call init() first",{component:"ICRPolySeg"}),null;const{threshold:a=128,minArea:i=100,smoothing:c=!0,tolerance:o=2}=s;try{const u=this.normalizeImageData(t,n,r),f=this.applyThreshold(u,n,r,a),l=this.findContours(f,n,r).filter(m=>this.calculatePolygonArea(m)>=i),h=c?l.map(m=>this.smoothContour(m,o)):l,y=h.map(m=>this.calculatePolygonArea(m)),p=h.map(m=>this.calculateBoundingBox(m));return Ot.info(`Found ${h.length} polygon segments`,{component:"ICRPolySeg",metadata:{segmentCount:h.length}}),{contours:h,areas:y,boundingBoxes:p}}catch(u){return Ot.error("Polygon segmentation failed",{component:"ICRPolySeg"},u),null}}normalizeImageData(t,n,r){if(t instanceof ImageData){const s=new Uint8Array(n*r);for(let a=0;a<s.length;a++){const i=a*4;s[a]=Math.round(t.data[i]*.299+t.data[i+1]*.587+t.data[i+2]*.114)}return s}if(t instanceof Uint16Array){const s=new Uint8Array(t.length),a=Math.max(...t),i=a>0?255/a:0;for(let c=0;c<t.length;c++)s[c]=Math.round(t[c]*i);return s}return t instanceof Uint8Array?t:new Uint8Array(t)}applyThreshold(t,n,r,s){const a=new Uint8Array(t.length);for(let i=0;i<t.length;i++)a[i]=t[i]>s?255:0;return a}findContours(t,n,r){const s=[],a=new Set,i=[[-1,-1],[-1,0],[-1,1],[0,1],[1,1],[1,0],[1,-1],[0,-1]];for(let c=0;c<r;c++)for(let o=0;o<n;o++){const u=c*n+o;if(t[u]===255&&!a.has(u)){const f=this.traceContour(t,n,r,o,c,i,a);f.length>3&&s.push(f)}}return s}traceContour(t,n,r,s,a,i,c){const o=[];let u=s,f=a,g=0;do{const l=f*n+u;c.add(l),o.push({x:u,y:f});let h=!1;for(let y=0;y<8;y++){const p=(g+y)%8,[m,C]=i[p],E=u+m,v=f+C;if(E>=0&&E<n&&v>=0&&v<r){const d=v*n+E;if(t[d]===255){u=E,f=v,g=(p+6)%8,h=!0;break}}}if(!h)break}while(!(u===s&&f===a)&&o.length<n*r);return o}smoothContour(t,n){return t.length<=2?t:this.douglasPeucker(t,n)}douglasPeucker(t,n){if(t.length<=2)return t;let r=0,s=0;const a=t[0],i=t[t.length-1];for(let c=1;c<t.length-1;c++){const o=this.pointToLineDistance(t[c],a,i);o>r&&(r=o,s=c)}if(r>n){const c=this.douglasPeucker(t.slice(0,s+1),n),o=this.douglasPeucker(t.slice(s),n);return[...c.slice(0,-1),...o]}return[a,i]}pointToLineDistance(t,n,r){const s=t.x-n.x,a=t.y-n.y,i=r.x-n.x,c=r.y-n.y,o=s*i+a*c,u=i*i+c*c;if(u===0)return Math.sqrt(s*s+a*a);const f=o/u;let g,l;f<0?(g=n.x,l=n.y):f>1?(g=r.x,l=r.y):(g=n.x+f*i,l=n.y+f*c);const h=t.x-g,y=t.y-l;return Math.sqrt(h*h+y*y)}calculatePolygonArea(t){if(t.length<3)return 0;let n=0;for(let r=0;r<t.length;r++){const s=(r+1)%t.length;n+=t[r].x*t[s].y,n-=t[s].x*t[r].y}return Math.abs(n)/2}calculateBoundingBox(t){if(t.length===0)return{x:0,y:0,width:0,height:0};let n=t[0].x,r=t[0].x,s=t[0].y,a=t[0].y;for(const i of t)n=Math.min(n,i.x),r=Math.max(r,i.x),s=Math.min(s,i.y),a=Math.max(a,i.y);return{x:n,y:s,width:r-n,height:a-s}}}Gs.exports=ht;function Ms(e,t,n){return Math.abs(e-t)<=n}function io(e,t,n=1e-5){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(!Ms(e[r],t[r],n))return!1;return!0}function Wn(e){return typeof e=="number"}function qn(e){return"length"in e&&typeof e[0]=="number"}function oo(e,t,n=1e-5){return typeof e!=typeof t||e===null||t===null?!1:Wn(e)&&Wn(t)?Ms(e,t,n):qn(e)&&qn(t)?io(e,t,n):!1}const{vtkErrorMacro:co}=N,uo=[1,-1,1,-1,1,-1];function fo(e,t){t.classHierarchy.push("vtkPoints"),e.getNumberOfPoints=e.getNumberOfTuples,e.setNumberOfPoints=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:3;e.getNumberOfPoints()!==n&&(t.size=n*r,t.values=N.newTypedArray(t.dataType,t.size),e.setNumberOfComponents(r),e.modified())},e.setPoint=function(n){for(var r=arguments.length,s=new Array(r>1?r-1:0),a=1;a<r;a++)s[a-1]=arguments[a];e.setTuple(n,s)},e.getPoint=e.getTuple,e.findPoint=e.findTuple,e.insertNextPoint=(n,r,s)=>e.insertNextTuple([n,r,s]),e.getBounds=()=>{if(e.getNumberOfComponents()===3){const s=e.getRange(0);t.bounds[0]=s[0],t.bounds[1]=s[1];const a=e.getRange(1);t.bounds[2]=a[0],t.bounds[3]=a[1];const i=e.getRange(2);return t.bounds[4]=i[0],t.bounds[5]=i[1],t.bounds}if(e.getNumberOfComponents()!==2)return co(`getBounds called on an array with components of
        ${e.getNumberOfComponents()}`),uo;const n=e.getRange(0);t.bounds[0]=n[0],t.bounds[1]=n[1];const r=e.getRange(1);return t.bounds[2]=r[0],t.bounds[3]=r[1],t.bounds[4]=0,t.bounds[5]=0,t.bounds},e.computeBounds=e.getBounds,e.setNumberOfComponents(t.numberOfComponents<2?3:t.numberOfComponents)}const lo={empty:!0,numberOfComponents:3,dataType:re.FLOAT,bounds:[1,-1,1,-1,1,-1]};function Ls(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(t,lo,n),Q.extend(e,t,n),fo(e,t)}const go=N.newInstance(Ls,"vtkPoints");var Ue={newInstance:go,extend:Ls};function ks(e){let t=0;return e.filter((n,r)=>r===t?(t+=n+1,!0):!1)}function Ns(e){let t=0;for(let n=0;n<e.length;)n+=e[n]+1,t++;return t}const ho={extractCellSizes:ks,getNumberOfCells:Ns};function yo(e,t){t.classHierarchy.push("vtkCellArray");const n={...e};e.getNumberOfCells=r=>(t.numberOfCells!==void 0&&!r||(t.cellSizes?t.numberOfCells=t.cellSizes.length:t.numberOfCells=Ns(e.getData())),t.numberOfCells),e.getCellSizes=r=>(t.cellSizes!==void 0&&!r||(t.cellSizes=ks(e.getData())),t.cellSizes),e.resize=r=>{const s=e.getNumberOfTuples();n.resize(r);const a=e.getNumberOfTuples();a<s&&(a===0?(t.numberOfCells=0,t.cellSizes=[]):(t.numberOfCells=void 0,t.cellSizes=void 0))},e.setData=r=>{n.setData(r,1),t.numberOfCells=void 0,t.cellSizes=void 0},e.getCell=r=>{let s=r;const a=t.values[s++];return t.values.subarray(s,s+a)},e.insertNextCell=r=>{const s=e.getNumberOfCells();return e.insertNextTuples([r.length,...r]),++t.numberOfCells,t.cellSizes!=null&&t.cellSizes.push(r.length),s}}function po(e){return{empty:!0,numberOfComponents:1,dataType:re.UNSIGNED_INT,...e}}function $s(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Q.extend(e,t,po(n)),yo(e,t)}const mo=N.newInstance($s,"vtkCellArray");var Xn={newInstance:mo,extend:$s,...ho};function vo(e,t){t.classHierarchy.push("vtkCell"),e.initialize=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(r){t.pointsIds=r;let s=t.points.getData();s.length!==3*t.pointsIds.length&&(s=N.newTypedArray(n.getDataType(),3*t.pointsIds.length));const a=n.getData();t.pointsIds.forEach((i,c)=>{let o=3*i,u=3*c;s[u]=a[o],s[++u]=a[++o],s[++u]=a[++o]}),t.points.setData(s)}else{t.points=n,t.pointsIds=new Array(n.getNumberOfPoints());for(let s=n.getNumberOfPoints()-1;s>=0;--s)t.pointsIds[s]=s}},e.getBounds=()=>{const n=t.points.getNumberOfPoints(),r=[];if(n){t.points.getPoint(0,r),t.bounds[0]=r[0],t.bounds[1]=r[0],t.bounds[2]=r[1],t.bounds[3]=r[1],t.bounds[4]=r[2],t.bounds[5]=r[2];for(let s=1;s<n;s++)t.points.getPoint(s,r),t.bounds[0]=r[0]<t.bounds[0]?r[0]:t.bounds[0],t.bounds[1]=r[0]>t.bounds[1]?r[0]:t.bounds[1],t.bounds[2]=r[1]<t.bounds[2]?r[1]:t.bounds[2],t.bounds[3]=r[1]>t.bounds[3]?r[1]:t.bounds[3],t.bounds[4]=r[2]<t.bounds[4]?r[2]:t.bounds[4],t.bounds[5]=r[2]>t.bounds[5]?r[2]:t.bounds[5]}else Za(t.bounds);return t.bounds},e.getLength2=()=>{e.getBounds();let n=0,r=0;for(let s=0;s<3;s++)r=t.bounds[2*s+1]-t.bounds[2*s],n+=r*r;return n},e.getParametricDistance=n=>{let r,s=0;for(let a=0;a<3;a++)n[a]<0?r=-n[a]:n[a]>1?r=n[a]-1:r=0,r>s&&(s=r);return s},e.getNumberOfPoints=()=>t.points.getNumberOfPoints(),e.deepCopy=n=>{n.initialize(t.points,t.pointsIds)},e.getCellDimension=()=>{},e.intersectWithLine=(n,r,s,a,i,c,o)=>{},e.evaluatePosition=(n,r,s,a,i,c)=>{N.vtkErrorMacro("vtkCell.evaluatePosition is not implemented.")}}const To={bounds:[-1,-1,-1,-1,-1,-1],pointsIds:[]};function Rs(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(t,To,n),N.obj(e,t),t.points||(t.points=Ue.newInstance()),N.get(e,t,["points","pointsIds"]),vo(e,t)}const wo=N.newInstance(Rs,"vtkCell");var Wt={newInstance:wo,extend:Rs};function Co(e,t){let n=t;for(t>=e.array.length&&(n+=e.array.length);n>e.array.length;)e.array.push({ncells:0,cells:null});e.array.length=n}function xo(e,t){t.classHierarchy.push("vtkCellLinks"),e.buildLinks=n=>{const r=n.getPoints().getNumberOfPoints(),s=n.getNumberOfCells(),a=new Uint32Array(r);if(n.isA("vtkPolyData")){for(let i=0;i<s;++i){const{cellPointIds:c}=n.getCellPoints(i);c.forEach(o=>{e.incrementLinkCount(o)})}e.allocateLinks(r),t.maxId=r-1;for(let i=0;i<s;++i){const{cellPointIds:c}=n.getCellPoints(i);c.forEach(o=>{e.insertCellReference(o,a[o]++,i)})}}else{for(let i=0;i<s;i++)Wt.newInstance().getPointsIds().forEach(o=>{e.incrementLinkCount(o)});e.allocateLinks(r),t.maxId=r-1;for(let i=0;i<s;++i)Wt.newInstance().getPointsIds().forEach(o=>{e.insertCellReference(o,a[o]++,i)})}},e.allocate=function(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e3;t.array=Array(n).fill().map(()=>({ncells:0,cells:null})),t.extend=r,t.maxId=-1},e.initialize=()=>{t.array=null},e.getLink=n=>t.array[n],e.getNcells=n=>t.array[n].ncells,e.getCells=n=>t.array[n].cells,e.insertNextPoint=n=>{t.array.push({ncells:n,cells:Array(n)}),++t.maxId},e.insertNextCellReference=(n,r)=>{t.array[n].cells[t.array[n].ncells++]=r},e.deletePoint=n=>{t.array[n].ncells=0,t.array[n].cells=null},e.removeCellReference=(n,r)=>{t.array[r].cells=t.array[r].cells.filter(s=>s!==n),t.array[r].ncells=t.array[r].cells.length},e.addCellReference=(n,r)=>{t.array[r].cells[t.array[r].ncells++]=n},e.resizeCellList=(n,r)=>{t.array[n].cells.length=r},e.squeeze=()=>{Co(t,t.maxId+1)},e.reset=()=>{t.maxId=-1},e.deepCopy=n=>{t.array=[...n.array],t.extend=n.extend,t.maxId=n.maxId},e.incrementLinkCount=n=>{++t.array[n].ncells},e.allocateLinks=n=>{for(let r=0;r<n;++r)t.array[r].cells=new Array(t.array[r].ncells)},e.insertCellReference=(n,r,s)=>{t.array[n].cells[r]=s}}const Oo={array:null,maxId:0,extend:0};function Vs(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(t,Oo,n),N.obj(e,t),xo(e,t)}const Eo=N.newInstance(Vs,"vtkCellLinks");var So={newInstance:Eo,extend:Vs};const I={VTK_EMPTY_CELL:0,VTK_VERTEX:1,VTK_POLY_VERTEX:2,VTK_LINE:3,VTK_POLY_LINE:4,VTK_TRIANGLE:5,VTK_TRIANGLE_STRIP:6,VTK_POLYGON:7,VTK_QUAD:9,VTK_QUADRATIC_EDGE:21,VTK_CONVEX_POINT_SET:41,VTK_POLYHEDRON:42},je=["vtkEmptyCell","vtkVertex","vtkPolyVertex","vtkLine","vtkPolyLine","vtkTriangle","vtkTriangleStrip","vtkPolygon","vtkPixel","vtkQuad","vtkTetra","vtkVoxel","vtkHexahedron","vtkWedge","vtkPyramid","vtkPentagonalPrism","vtkHexagonalPrism","UnknownClass","UnknownClass","UnknownClass","UnknownClass","vtkQuadraticEdge","vtkQuadraticTriangle","vtkQuadraticQuad","vtkQuadraticTetra","vtkQuadraticHexahedron","vtkQuadraticWedge","vtkQuadraticPyramid","vtkBiQuadraticQuad","vtkTriQuadraticHexahedron","vtkQuadraticLinearQuad","vtkQuadraticLinearWedge","vtkBiQuadraticQuadraticWedge","vtkBiQuadraticQuadraticHexahedron","vtkBiQuadraticTriangle","vtkCubicLine","vtkQuadraticPolygon","UnknownClass","UnknownClass","UnknownClass","UnknownClass","vtkConvexPointSet","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","UnknownClass","vtkParametricCurve","vtkParametricSurface","vtkParametricTriSurface","vtkParametricQuadSurface","vtkParametricTetraRegion","vtkParametricHexRegion","UnknownClass","UnknownClass","UnknownClass","vtkHigherOrderEdge","vtkHigherOrderTriangle","vtkHigherOrderQuad","vtkHigherOrderPolygon","vtkHigherOrderTetrahedron","vtkHigherOrderWedge","vtkHigherOrderPyramid","vtkHigherOrderHexahedron"];function Do(e){return e<je.length?je[e]:"UnknownClass"}function Mo(e){return je.findIndex(e)}function Lo(e){return e<I.VTK_QUADRATIC_EDGE||e===I.VTK_CONVEX_POINT_SET||e===I.VTK_POLYHEDRON}function ko(e){return e===I.VTK_TRIANGLE_STRIP||e===I.VTK_POLY_LINE||e===I.VTK_POLY_VERTEX}const No={getClassNameFromTypeId:Do,getTypeIdFromClassName:Mo,isLinear:Lo,hasSubCells:ko};function $o(e,t){t.classHierarchy.push("vtkCellTypes"),e.allocate=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:512,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e3;t.size=n>0?n:1,t.extend=r>0?r:1,t.maxId=-1,t.typeArray=new Uint8Array(n),t.locationArray=new Uint32Array(n)},e.insertCell=(n,r,s)=>{t.typeArray[n]=r,t.locationArray[n]=s,n>t.maxId&&(t.maxId=n)},e.insertNextCell=(n,r)=>(e.insertCell(++t.maxId,n,r),t.maxId),e.setCellTypes=(n,r,s)=>{t.size=n,t.typeArray=r,t.locationArray=s,t.maxId=n-1},e.getCellLocation=n=>t.locationArray[n],e.deleteCell=n=>{t.typeArray[n]=I.VTK_EMPTY_CELL},e.getNumberOfTypes=()=>t.maxId+1,e.isType=n=>{const r=e.getNumberOfTypes();for(let s=0;s<r;++s)if(n===e.getCellType(s))return!0;return!1},e.insertNextType=n=>e.insertNextCell(n,-1),e.getCellType=n=>t.typeArray[n],e.reset=()=>{t.maxId=-1},e.deepCopy=n=>{e.allocate(n.getSize(),n.getExtend()),t.typeArray.set(n.getTypeArray()),t.locationArray.set(n.getLocationArray()),t.maxId=n.getMaxId()}}const Ro={size:0,maxId:-1,extend:1e3};function _s(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(t,Ro,n),N.obj(e,t),N.get(e,t,["size","maxId","extend"]),N.getArray(e,t,["typeArray","locationArray"]),$o(e,t)}const Vo=N.newInstance(_s,"vtkCellTypes");var _o={newInstance:Vo,extend:_s,...No};const Io={NO_INTERSECTION:0,YES_INTERSECTION:1,ON_LINE:2};var Is={IntersectionState:Io};const{IntersectionState:Ut}=Is;function gt(e,t,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;const s={t:Number.MIN_VALUE,distance:0},a=[];let i;a[0]=n[0]-t[0],a[1]=n[1]-t[1],a[2]=n[2]-t[2];const c=a[0]*(e[0]-t[0])+a[1]*(e[1]-t[1])+a[2]*(e[2]-t[2]),o=R(a,a);let u=1e-5*c;return o!==0&&(s.t=c/o),u<0&&(u=-u),-u<o&&o<u||o<=0||s.t<0?i=t:s.t>1?i=n:(i=a,a[0]=t[0]+s.t*a[0],a[1]=t[1]+s.t*a[1],a[2]=t[2]+s.t*a[2]),r&&(r[0]=i[0],r[1]=i[1],r[2]=i[2]),s.distance=J(i,e),s}function Fs(e,t,n,r,s,a){const i=[],c=[],o=[];s[0]=0,a[0]=0,et(t,e,i),et(r,n,c),et(n,e,o);const u=[R(i,i),-R(i,c),-R(i,c),R(c,c)],f=[];if(f[0]=R(i,o),f[1]=-R(c,o),Qa(u,f,2)===0){let g=Number.MAX_VALUE;const l=[e,t,n,r],h=[n,n,e,e],y=[r,r,t,t];a[0],a[0],s[0],s[0],s[0],s[0],a[0],a[0];let p;for(let m=0;m<4;m++)p=gt(l[m],h[m],y[m]),p.distance<g&&(g=p.distance);return Ut.ON_LINE}return s[0]=f[0],a[0]=f[1],s[0]>=0&&s[0]<=1&&a[0]>=0&&a[0]<=1?Ut.YES_INTERSECTION:Ut.NO_INTERSECTION}const Fo={distanceToLine:gt,intersection:Fs};function Uo(e,t){t.classHierarchy.push("vtkLine");function n(r){return r>=0&&r<=1}e.getCellDimension=()=>1,e.intersectWithLine=(r,s,a,i,c)=>{const o={intersect:0,t:Number.MAX_VALUE,subId:0,betweenPoints:null};c[1]=0,c[2]=0;const u=[],f=[],g=[];t.points.getPoint(0,f),t.points.getPoint(1,g);const l=[],h=[],y=Fs(r,s,f,g,l,h);if(o.t=l[0],o.betweenPoints=n(o.t),c[0]=h[0],y===Ut.YES_INTERSECTION){for(let p=0;p<3;p++)i[p]=f[p]+c[0]*(g[p]-f[p]),u[p]=r[p]+o.t*(s[p]-r[p]);if(J(i,u)<=a*a)return o.intersect=1,o}else{let p;if(o.t<0)return p=gt(r,f,g,i),p.distance<=a*a&&(o.t=0,o.intersect=1,o.betweenPoints=!0),o;if(o.t>1)return p=gt(s,f,g,i),p.distance<=a*a&&(o.t=1,o.intersect=1,o.betweenPoints=!0),o;if(c[0]<0)return c[0]=0,p=gt(f,r,s,i),o.t=p.t,p.distance<=a*a&&(o.intersect=1),o;if(c[0]>1)return c[0]=1,p=gt(g,r,s,i),o.t=p.t,p.distance<=a*a&&(o.intersect=1),o}return o},e.evaluateLocation=(r,s,a)=>{const i=[],c=[];t.points.getPoint(0,i),t.points.getPoint(1,c);for(let o=0;o<3;o++)s[o]=i[o]+r[0]*(c[o]-i[o]);a[0]=1-r[0],a[1]=r[0]},e.evaluateOrientation=(r,s,a)=>t.orientations?(Ft(s,t.orientations[0],t.orientations[1],r[0]),a[0]=1-r[0],a[1]=r[0],!0):!1}const jo={orientations:null};function Us(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(t,jo,n),Wt.extend(e,t,n),N.setGet(e,t,["orientations"]),Uo(e,t)}const zo=N.newInstance(Us,"vtkLine");var B={newInstance:zo,extend:Us,...Fo,...Is};function Ao(e,t){t.classHierarchy.push("vtkPointSet"),t.points?t.points=W(t.points):t.points=Ue.newInstance(),e.getNumberOfPoints=()=>t.points.getNumberOfPoints(),e.getBounds=()=>t.points.getBounds(),e.computeBounds=()=>{e.getBounds()};const n=e.shallowCopy;e.shallowCopy=function(r){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;n(r,s),t.points=Ue.newInstance(),t.points.shallowCopy(r.getPoints())}}const bo={};function js(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(t,bo,n),Os.extend(e,t,n),N.setGet(e,t,["points"]),Ao(e,t)}const Bo=N.newInstance(js,"vtkPointSet");var Go={newInstance:Bo,extend:js};function sn(e,t,n,r){const s=n[0]-t[0],a=n[1]-t[1],i=n[2]-t[2],c=e[0]-t[0],o=e[1]-t[1],u=e[2]-t[2];r[0]=a*u-i*o,r[1]=i*c-s*u,r[2]=s*o-a*c}function qt(e,t,n,r){sn(e,t,n,r);const s=Math.sqrt(r[0]*r[0]+r[1]*r[1]+r[2]*r[2]);s!==0&&(r[0]/=s,r[1]/=s,r[2]/=s)}function Ko(e,t,n,r,s,a){let i=arguments.length>6&&arguments[6]!==void 0?arguments[6]:1e-6,c=!1;const o=[],u=[],f=[],g=[],l=[];qt(e,t,n,g),qt(r,s,a,l);const h=-R(g,e),y=-R(l,r),p=[R(l,e)+y,R(l,t)+y,R(l,n)+y];if(p[0]*p[1]>i&&p[0]*p[2]>i)return{intersect:!1,coplanar:c,pt1:o,pt2:u,surfaceId:f};const m=[R(g,r)+h,R(g,s)+h,R(g,a)+h];if(m[0]*m[1]>i&&m[0]*m[2]>i)return{intersect:!1,coplanar:c,pt1:o,pt2:u,surfaceId:f};if(Math.abs(g[0]-l[0])<1e-9&&Math.abs(g[1]-l[1])<1e-9&&Math.abs(g[2]-l[2])<1e-9&&Math.abs(h-y)<1e-9)return c=!0,{intersect:!1,coplanar:c,pt1:o,pt2:u,surfaceId:f};const C=[e,t,n],E=[r,s,a],v=R(g,l),d=(h-y*v)/(v*v-1),x=(y-h*v)/(v*v-1),w=[d*g[0]+x*l[0],d*g[1]+x*l[1],d*g[2]+x*l[2]],O=Ur(g,l,[]);Ya(O);let T=0,M=0;const S=[],L=[];let k=50,$=50;for(let _=0;_<3;_++){const b=_,ct=(_+1)%3,G=ot.intersectWithLine(C[b],C[ct],r,l);G.intersection&&G.t>0-i&&G.t<1+i&&(G.t<1+i&&G.t>1-i&&(k=T),S[T++]=R(G.x,O)-R(w,O));const q=ot.intersectWithLine(E[b],E[ct],e,g);q.intersection&&q.t>0-i&&q.t<1+i&&(q.t<1+i&&q.t>1-i&&($=M),L[M++]=R(q.x,O)-R(w,O))}if(T>2){T--;const _=S[2];S[2]=S[k],S[k]=_}if(M>2){M--;const _=L[2];L[2]=L[$],L[$]=_}if(T!==2||M!==2)return{intersect:!1,coplanar:c,pt1:o,pt2:u,surfaceId:f};if(Number.isNaN(S[0])||Number.isNaN(S[1])||Number.isNaN(L[0])||Number.isNaN(L[1]))return{intersect:!1,coplanar:c,pt1:o,pt2:u,surfaceId:f};if(S[0]>S[1]){const _=S[1];S[1]=S[0],S[0]=_}if(L[0]>L[1]){const _=L[1];L[1]=L[0],L[0]=_}let D,V;return S[1]<L[0]||L[1]<S[0]?{intersect:!1,coplanar:c,pt1:o,pt2:u,surfaceId:f}:(S[0]<L[0]?S[1]<L[1]?(f[0]=2,f[1]=1,D=L[0],V=S[1]):(f[0]=2,f[1]=2,D=L[0],V=L[1]):S[1]<L[1]?(f[0]=1,f[1]=1,D=S[0],V=S[1]):(f[0]=1,f[1]=2,D=S[0],V=L[1]),jn(w,O,D,o),jn(w,O,V,u),{intersect:!0,coplanar:c,pt1:o,pt2:u,surfaceId:f})}const Ho={computeNormalDirection:sn,computeNormal:qt,intersectWithTriangle:Ko};function Wo(e,t){t.classHierarchy.push("vtkTriangle"),e.getCellDimension=()=>2,e.intersectWithLine=(n,r,s,a,i)=>{const c={subId:0,t:Number.MAX_VALUE,intersect:0,betweenPoints:!1};i[2]=0;const o=[],u=s*s,f=[],g=[],l=[];t.points.getPoint(0,f),t.points.getPoint(1,g),t.points.getPoint(2,l);const h=[],y=[];if(qt(f,g,l,h),h[0]!==0||h[1]!==0||h[2]!==0){const v=ot.intersectWithLine(n,r,f,h);if(c.betweenPoints=v.betweenPoints,c.t=v.t,a[0]=v.x[0],a[1]=v.x[1],a[2]=v.x[2],!v.intersection)return i[0]=0,i[1]=0,c.intersect=0,c;const d=e.evaluatePosition(a,o,i,y);if(d.evaluation>=0)return d.dist2<=u?(c.intersect=1,c):(c.intersect=d.evaluation,c)}const p=J(f,g),m=J(g,l),C=J(l,f);t.line||(t.line=B.newInstance()),p>m&&p>C?(t.line.getPoints().setPoint(0,f),t.line.getPoints().setPoint(1,g)):m>C&&m>p?(t.line.getPoints().setPoint(0,g),t.line.getPoints().setPoint(1,l)):(t.line.getPoints().setPoint(0,l),t.line.getPoints().setPoint(1,f));const E=t.line.intersectWithLine(n,r,s,a,i);if(c.betweenPoints=E.betweenPoints,c.t=E.t,E.intersect){const v=[],d=[],x=[];for(let w=0;w<3;w++)v[w]=f[w]-l[w],d[w]=g[w]-l[w],x[w]=a[w]-l[w];return i[0]=R(x,v)/C,i[1]=R(x,d)/m,c.intersect=1,c}return i[0]=0,i[1]=0,c.intersect=0,c},e.evaluatePosition=(n,r,s,a)=>{const i={subId:0,dist2:0,evaluation:-1};let c,o;const u=[],f=[],g=[],l=[];let h;const y=[],p=[],m=[];let C=0,E=0;const v=[];let d,x,w,O=[];const T=[],M=[],S=[];i.subId=0,s[2]=0,t.points.getPoint(1,u),t.points.getPoint(2,f),t.points.getPoint(0,g),sn(u,f,g,l),ot.generalizedProjectPoint(n,u,l,S);let L=0;for(c=0;c<3;c++)l[c]<0?h=-l[c]:h=l[c],h>L&&(L=h,E=c);for(o=0,c=0;c<3;c++)c!==E&&(v[o++]=c);for(c=0;c<2;c++)y[c]=S[v[c]]-g[v[c]],p[c]=u[v[c]]-g[v[c]],m[c]=f[v[c]]-g[v[c]];if(C=It(p,m),C===0)return s[0]=0,s[1]=0,i.evaluation=-1,i;if(s[0]=It(y,m)/C,s[1]=It(p,y)/C,a[0]=1-(s[0]+s[1]),a[1]=s[0],a[2]=s[1],a[0]>=0&&a[0]<=1&&a[1]>=0&&a[1]<=1&&a[2]>=0&&a[2]<=1)r&&(i.dist2=J(S,n),r[0]=S[0],r[1]=S[1],r[2]=S[2]),i.evaluation=1;else{let k;if(r){if(a[1]<0&&a[2]<0)for(d=J(n,g),x=B.distanceToLine(n,u,g,k,T),w=B.distanceToLine(n,g,f,k,M),d<x?(i.dist2=d,O=g):(i.dist2=x,O=T),w<i.dist2&&(i.dist2=w,O=M),c=0;c<3;c++)r[c]=O[c];else if(a[2]<0&&a[0]<0)for(d=J(n,u),x=B.distanceToLine(n,u,g,k,T),w=B.distanceToLine(n,u,f,k,M),d<x?(i.dist2=d,O=u):(i.dist2=x,O=T),w<i.dist2&&(i.dist2=w,O=M),c=0;c<3;c++)r[c]=O[c];else if(a[1]<0&&a[0]<0)for(d=J(n,f),x=B.distanceToLine(n,f,g,k,T),w=B.distanceToLine(n,u,f,k,M),d<x?(i.dist2=d,O=f):(i.dist2=x,O=T),w<i.dist2&&(i.dist2=w,O=M),c=0;c<3;c++)r[c]=O[c];else if(a[0]<0){const $=B.distanceToLine(n,u,f,r);i.dist2=$.distance}else if(a[1]<0){const $=B.distanceToLine(n,f,g,r);i.dist2=$.distance}else if(a[2]<0){const $=B.distanceToLine(n,u,g,r);i.dist2=$.distance}}i.evaluation=0}return i},e.evaluateLocation=(n,r,s)=>{const a=[],i=[],c=[];t.points.getPoint(0,a),t.points.getPoint(1,i),t.points.getPoint(2,c);const o=1-n[0]-n[1];for(let u=0;u<3;u++)r[u]=a[u]*o+i[u]*n[0]+c[u]*n[1];s[0]=o,s[1]=n[0],s[2]=n[1]},e.getParametricDistance=n=>{let r,s=0;const a=[];a[0]=n[0],a[1]=n[1],a[2]=1-n[0]-n[1];for(let i=0;i<3;i++)a[i]<0?r=-a[i]:a[i]>1?r=a[i]-1:r=0,r>s&&(s=r);return s}}const qo={};function zs(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(t,qo,n),Wt.extend(e,t,n),Wo(e,t)}const Xo=N.newInstance(zs,"vtkTriangle");var Yo={newInstance:Xo,extend:zs,...Ho};const Me=["verts","lines","polys","strips"],{vtkWarningMacro:Yn}=N,Po={[I.VTK_LINE]:B,[I.VTK_POLY_LINE]:B,[I.VTK_TRIANGLE]:Yo};function Jo(e,t){t.classHierarchy.push("vtkPolyData");function n(s){return s.replace(/(?:^\w|[A-Z]|\b\w)/g,a=>a.toUpperCase()).replace(/\s+/g,"")}Me.forEach(s=>{e[`getNumberOf${n(s)}`]=()=>t[s].getNumberOfCells(),t[s]?t[s]=W(t[s]):t[s]=Xn.newInstance()}),e.getNumberOfCells=()=>Me.reduce((s,a)=>s+t[a].getNumberOfCells(),0);const r=e.shallowCopy;e.shallowCopy=function(s){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;r(s,a),Me.forEach(i=>{t[i]=Xn.newInstance(),t[i].shallowCopy(s.getReferenceByName(i))})},e.buildCells=()=>{const s=e.getNumberOfVerts(),a=e.getNumberOfLines(),i=e.getNumberOfPolys(),c=e.getNumberOfStrips(),o=s+a+i+c,u=new Uint8Array(o);let f=u;const g=new Uint32Array(o);let l=g;if(s){let h=0;t.verts.getCellSizes().forEach((y,p)=>{l[p]=h,f[p]=y>1?I.VTK_POLY_VERTEX:I.VTK_VERTEX,h+=y+1}),l=l.subarray(s),f=f.subarray(s)}if(a){let h=0;t.lines.getCellSizes().forEach((y,p)=>{l[p]=h,f[p]=y>2?I.VTK_POLY_LINE:I.VTK_LINE,y===1&&Yn("Building VTK_LINE ",p," with only one point, but VTK_LINE needs at least two points. Check the input."),h+=y+1}),l=l.subarray(a),f=f.subarray(a)}if(i){let h=0;t.polys.getCellSizes().forEach((y,p)=>{switch(l[p]=h,y){case 3:f[p]=I.VTK_TRIANGLE;break;case 4:f[p]=I.VTK_QUAD;break;default:f[p]=I.VTK_POLYGON;break}y<3&&Yn("Building VTK_TRIANGLE ",p," with less than three points, but VTK_TRIANGLE needs at least three points. Check the input."),h+=y+1}),l+=l.subarray(i),f+=f.subarray(i)}if(c){let h=0;f.fill(I.VTK_TRIANGLE_STRIP,0,c),t.strips.getCellSizes().forEach((y,p)=>{l[p]=h,h+=y+1})}t.cells=_o.newInstance(),t.cells.setCellTypes(o,u,g)},e.buildLinks=function(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;t.cells===void 0&&e.buildCells(),t.links=So.newInstance(),s>0?t.links.allocate(s):t.links.allocate(e.getPoints().getNumberOfPoints()),t.links.buildLinks(e)},e.getCellType=s=>t.cells.getCellType(s),e.getCellPoints=s=>{const a=e.getCellType(s);let i=null;switch(a){case I.VTK_VERTEX:case I.VTK_POLY_VERTEX:i=t.verts;break;case I.VTK_LINE:case I.VTK_POLY_LINE:i=t.lines;break;case I.VTK_TRIANGLE:case I.VTK_QUAD:case I.VTK_POLYGON:i=t.polys;break;case I.VTK_TRIANGLE_STRIP:i=t.strips;break;default:return i=null,{type:0,cellPointIds:null}}const c=t.cells.getCellLocation(s),o=i.getCell(c);return{cellType:a,cellPointIds:o}},e.getPointCells=s=>t.links.getCells(s),e.getCellEdgeNeighbors=(s,a,i)=>{const c=t.links.getLink(a),o=t.links.getLink(i);return c.cells.filter(u=>u!==s&&o.cells.indexOf(u)!==-1)},e.getCell=function(s){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const i=e.getCellPoints(s),c=a||Po[i.cellType].newInstance();return c.initialize(e.getPoints(),i.cellPointIds),c}}const Qo={};function As(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(t,Qo,n),Go.extend(e,t,n),N.get(e,t,["cells","links"]),N.setGet(e,t,["verts","lines","polys","strips"]),Jo(e,t)}const Zo=N.newInstance(As,"vtkPolyData");var an={newInstance:Zo,extend:As};const{vtkErrorMacro:Pn}=Fr;function tc(e){const t=e.getPolys().getData(),n=e.getStrips().getData(),r={cellSize:0,cell:[],done:!1,polyIdx:0,stripIdx:0,remainingStripLength:0,next(){if(r.polyIdx<t.length){r.cellSize=t[r.polyIdx];const s=r.polyIdx+1,a=s+r.cellSize;r.polyIdx=a;let i=0;for(let c=s;c<a;++c)r.cell[i++]=t[c]}else if(r.stripIdx<n.length){r.cellSize=3,r.remainingStripLength===0&&(r.remainingStripLength=n[r.stripIdx]-2,r.stripIdx+=3);const s=r.stripIdx-2,a=r.stripIdx+1;r.stripIdx++,r.remainingStripLength--;let i=0;for(let c=s;c<a;++c)r.cell[i++]=n[c]}else if(!r.done)r.done=!0;else throw new Error("Iterator is done")}};return r.next(),r}function ec(e,t){t.classHierarchy.push("vtkCutter");const n={...e};e.getMTime=()=>{let s=n.getMTime();return t.cutFunction&&(s=Math.max(s,t.cutFunction.getMTime())),s};function r(s,a){const i=s.getPoints(),c=i.getData(),o=i.getNumberOfPoints(),u=[],f=[],g=[];(!t.cutScalars||t.cutScalars.length<o)&&(t.cutScalars=new Float32Array(o));let l=0,h=0;for(;l<c.length;)t.cutScalars[h++]=t.cutFunction.evaluateFunction(c[l++],c[l++],c[l++]);const y=[],p=new Array(3),m=new Array(3),C=[];for(const v=tc(s);!v.done;v.next()){if(v.cellSize<=2)continue;for(let T=0;T<v.cellSize;)C[T]=t.cutScalars[v.cell[T++]];const d=C[0]>0;let x=!0;for(let T=1;T<v.cell.length;T++)if(C[T]>0!==d){x=!1;break}if(x)continue;const w=[];for(let T=0;T<v.cellSize;T++){const M=T+1===v.cellSize?0:T+1,S=C[T]>0;if(C[M]>0===S)continue;let k=T,$=M,D=C[$]-C[k];D<=0&&(k=M,$=T,D*=-1);let V=0;D!==0&&(V=(t.cutValue-C[k])/D);const _=v.cell[k],b=v.cell[$];p[0]=c[_*3],p[1]=c[_*3+1],p[2]=c[_*3+2],m[0]=c[b*3],m[1]=c[b*3+1],m[2]=c[b*3+2];const ct=[p[0]+V*(m[0]-p[0]),p[1]+V*(m[1]-p[1]),p[2]+V*(m[2]-p[2])];w.push({pointEdge1:_,pointEdge2:b,intersectedPoint:ct,newPointID:-1})}for(let T=0;T<w.length;T++){const M=w[T];let S=!1;for(let L=0;L<y.length;L++){const k=y[L],$=M.pointEdge1===k.pointEdge1&&M.pointEdge2===k.pointEdge2,D=M.intersectedPoint[0]===k.intersectedPoint[0]&&M.intersectedPoint[1]===k.intersectedPoint[1]&&M.intersectedPoint[2]===k.intersectedPoint[2];if($||D){S=!0,w[T].newPointID=y[L].newPointID;break}}S||(u.push(M.intersectedPoint[0]),u.push(M.intersectedPoint[1]),u.push(M.intersectedPoint[2]),w[T].newPointID=u.length/3-1,y.push(w[T]))}const O=w.length;O===2?f.push(O,w[0].newPointID,w[1].newPointID):O>2&&(g.push(O),w.forEach(T=>{g.push(T.newPointID)}))}a.getPoints().setData(Yt(i.getDataType(),u),3),f.length!==0&&a.getLines().setData(Uint16Array.from(f)),g.length!==0&&a.getPolys().setData(Uint16Array.from(g))}e.requestData=(s,a)=>{const i=s[0];if(!i){Pn("Invalid or missing input");return}if(!t.cutFunction){Pn("Missing cut function");return}const c=an.newInstance();r(i,c),a[0]=c}}const nc={cutFunction:null,cutScalars:null,cutValue:0};function bs(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(t,nc,n),Jt(e,t),He(e,t,1,1),Zt(e,t,["cutFunction","cutValue"]),ec(e,t)}const rc=te(bs,"vtkCutter");var sc={newInstance:rc,extend:bs};function Et(e,t){return e.worldToIndex(t).map(Math.round)}class ac{constructor(t,n,r=1){this.rows=new Map,this.height=1,this.width=1,this.depth=1,this.jMultiple=1,this.kMultiple=1,this.numComps=1,this.defaultValue=0,this.pixelDataConstructor=Uint8Array,this.get=s=>{const a=s%this.jMultiple,i=(s-a)/this.jMultiple;return this.getRLE(a,i)?.value||this.defaultValue},this.getRun=(s,a)=>{const i=s+a*this.height;return this.rows.get(i)},this.set=(s,a)=>{if(a===void 0)throw new Error(`Can't set undefined at ${s%this.width}`);const i=s%this.width,c=(s-i)/this.width,o=this.rows.get(c);if(!o){this.rows.set(c,[{start:i,end:i+1,value:a}]);return}const u=this.findIndex(o,i),f=o[u],g=o[u-1];if(!f){if(!g||g.value!==a||g.end!==i){o[u]={start:i,end:i+1,value:a};return}g.end++;return}const{start:l,end:h,value:y}=f;if(a===y&&i>=l)return;const p={start:i,end:i+1,value:a},m=i>l,C=m?u+1:u,E=m?f:g;let v=m?o[u+1]:f;if(E?.value===a&&E?.end===i){E.end++,v?.value===a&&v.start===i+1?(E.end=v.end,o.splice(u,1)):v?.start===i&&(v.start++,v.start===v.end&&(o.splice(u,1),v=o[u],v?.start===i+1&&v.value===a&&(E.end=v.end,o.splice(u,1))));return}if(v?.value===a&&v.start===i+1){v.start--,E?.end>i&&(E.end=i,E.end===E.start&&o.splice(u,1));return}if(v?.start===i&&v.end===i+1){v.value=a;const d=o[u+1];d?.start==i+1&&d.value===a&&(o.splice(u+1,1),v.end=d.end);return}i===v?.start&&v.start++,m&&h>i+1?o.splice(C,0,p,{start:i+1,end:E.end,value:E.value}):o.splice(C,0,p),E?.end>i&&(E.end=i)},this.width=t,this.height=n,this.depth=r,this.jMultiple=t,this.kMultiple=this.jMultiple*n}getRLE(t,n,r=0){const s=this.rows.get(n+r*this.height);if(!s)return;const a=this.findIndex(s,t),i=s[a];return t>=i?.start?i:void 0}findIndex(t,n){for(let r=0;r<t.length;r++){const{end:s}=t[r];if(n<s)return r}return t.length}clear(){this.rows.clear()}keys(){return[...this.rows.keys()]}getPixelData(t=0,n){n?n.fill(0):n=new this.pixelDataConstructor(this.width*this.height*this.numComps);const{width:r,height:s,numComps:a}=this;for(let i=0;i<s;i++){const c=this.getRun(i,t);if(c)if(a===1)for(const o of c){const u=i*r,{start:f,end:g,value:l}=o;for(let h=f;h<g;h++)n[u+h]=l}else for(const o of c){const u=i*r*a,{start:f,end:g,value:l}=o;for(let h=f;h<g;h+=a)for(let y=0;y<a;y++)n[u+h+y]=l[y]}}return n}}const ic=5*1024;class j{constructor(t,n,r){this.modifiedSlices=new Set,this.boundsIJK=[[1/0,-1/0],[1/0,-1/0],[1/0,-1/0]],this.numComps=1,this.getAtIJK=(s,a,i)=>{const c=s+a*this.width+i*this.frameSize;return this._get(c)},this.setAtIJK=(s,a,i,c)=>{const o=s+a*this.width+i*this.frameSize;this._set(o,c)!==!1&&(this.modifiedSlices.add(i),j.addBounds(this.boundsIJK,[s,a,i]))},this.getAtIJKPoint=([s,a,i])=>this.getAtIJK(s,a,i),this.setAtIJKPoint=([s,a,i],c)=>this.setAtIJK(s,a,i,c),this.getAtIndex=s=>this._get(s),this.setAtIndex=(s,a)=>{if(this._set(s,a)!==!1){const i=this.toIJK(s);this.modifiedSlices.add(i[2]),j.addBounds(this.boundsIJK,i)}},this.forEach=(s,a)=>{const i=a?.boundsIJK||this.getBoundsIJK(),{isWithinObject:c}=a||{};if(this.map)for(const o of this.map.keys()){const u=this.toIJK(o),g={value:this._get(o),index:o,pointIJK:u};c?.(g)!==!1&&s(g)}else for(let o=i[2][0];o<=i[2][1];o++){const u=o*this.frameSize;for(let f=i[1][0];f<=i[1][1];f++){const g=u+f*this.width;for(let l=i[0][0],h=g+l;l<=i[0][1];l++,h++){const p={value:this.getAtIndex(h),index:h,pointIJK:[l,f,o]};c?.(p)!==!1&&s(p)}}}},this.dimensions=t,this.width=t[0],this.frameSize=this.width*t[1],this._get=n,this._set=r}addPoint(t){const n=Array.isArray(t)?t[0]+this.width*t[1]+this.frameSize*t[2]:t;this.points||(this.points=new Set),this.points.add(n)}getPoints(){return this.points?[...this.points].map(t=>this.toIJK(t)):[]}getPointIndices(){return this.points?[...this.points]:[]}toIJK(t){return[t%this.width,Math.floor(t%this.frameSize/this.width),Math.floor(t/this.frameSize)]}toIndex(t){return t[0]+t[1]*this.width+t[2]*this.frameSize}getBoundsIJK(){return this.boundsIJK[0][0]<this.dimensions[0]?this.boundsIJK:this.dimensions.map(t=>[0,t-1])}clear(){this.map&&this.map.clear(),this.boundsIJK.map(t=>{t[0]=1/0,t[1]=-1/0}),this.modifiedSlices.clear(),this.points?.clear()}getArrayOfSlices(){return Array.from(this.modifiedSlices)}static addBounds(t,n){t||(t=[[1/0,-1/0],[1/0,-1/0],[1/0,-1/0]]),t[0][0]=Math.min(n[0],t[0][0]),t[0][1]=Math.max(n[0],t[0][1]),t[1][0]=Math.min(n[1],t[1][0]),t[1][1]=Math.max(n[1],t[1][1]),t[2][0]=Math.min(n[2],t[2][0]),t[2][1]=Math.max(n[2],t[2][1])}static createRGBVolumeVoxelManager(t,n,r){const s=new j(t,a=>(a*=r,[n[a++],n[a++],n[a++]]),(a,i)=>{a*=3;const c=!oo(n[a],i);return n[a++]=i[0],n[a++]=i[1],n[a++]=i[2],c});return s.numComps=r,s.scalarData=n,s}static createVolumeVoxelManager(t,n,r=0){if(t.length!==3)throw new Error("Dimensions must be provided as [number, number, number] for [width, height, depth]");if(!r&&(r=n.length/t[0]/t[1]/t[2],r>4||r<1||r===2))throw new Error(`Number of components ${r} must be 1, 3 or 4`);return r>1?j.createRGBVolumeVoxelManager(t,n,r):j.createNumberVolumeVoxelManager(t,n)}static createNumberVolumeVoxelManager(t,n){const r=new j(t,s=>n[s],(s,a)=>{const i=n[s]!==a;return n[s]=a,i});return r.scalarData=n,r}static createMapVoxelManager(t){const n=new Map,r=new j(t,n.get.bind(n),(s,a)=>n.set(s,a)&&!0);return r.map=n,r}static createHistoryVoxelManager(t){const n=new Map,{dimensions:r}=t,s=new j(r,a=>n.get(a),function(a,i){if(n.has(a))i===n.get(a)&&n.delete(a);else{const c=this.sourceVoxelManager.getAtIndex(a);if(c===i)return!1;n.set(a,c)}this.sourceVoxelManager.setAtIndex(a,i)});return s.map=n,s.scalarData=t.scalarData,s.sourceVoxelManager=t,s}static createLazyVoxelManager(t,n){const r=new Map,[s,a,i]=t,c=s*a,o=new j(t,u=>r.get(Math.floor(u/c))?.[u%c],(u,f)=>{const g=Math.floor(u/c);let l=r.get(g);l||(l=n(s,a),r.set(g,l)),l[u%c]=f});return o.map=r,o}static createRLEVoxelManager(t){const[n,r,s]=t,a=new ac(n,r,s),i=new j(t,c=>a.get(c),(c,o)=>a.set(c,o));return i.map=a,i.getPixelData=a.getPixelData.bind(a),i}static addInstanceToImage(t){const{width:n,height:r}=t,s=t.getPixelData();if(s?.length>=n*r){t.voxelManager=j.createVolumeVoxelManager([n,r,1],s);return}t.voxelManager=j.createRLEVoxelManager([n,r,1]),t.getPixelData=t.voxelManager.getPixelData,t.sizeInBytes=ic}}function oc(e,t){const n=[...e];return t>=n.length?(Jn(n),n):(Jn(n),n.slice(0,t))}function Jn(e){for(let t=e.length-1;t>0;t--){const n=Math.floor(Math.random()*(t+1));[e[t],e[n]]=[e[n],e[t]]}}const Qn={Forward:1,Backward:-1},St=new Set;function cc(e,t){e.requestData=(n,r)=>{const[s]=n;r[0]||(r[0]=an.newInstance());const[a]=r;e.extractContours(s,a),a.modified()},e.traverseLoop=(n,r,s,a,i)=>{let c=s,o=a,u=!1,f=0;for(;!u;){const{cellPointIds:g}=n.getCellPoints(c);if(!g)continue;o=g[0]!==o?g[0]:g[1],f++;const l=r*f;i.push({t:l,ptId:o});const h=n.getPointCells(o);if(h.length!==2||o===a)return o;h.length===2?(c=h[0]!==c?h[0]:h[1],St.add(c)):u=!0}return o},e.extractContours=(n,r)=>{const s=[];St.clear();const a=n.getLines();r.getPoints().setData(Float32Array.from(n.getPoints().getData()));for(let c=0;c<a.getNumberOfCells();c++){if(St.has(c))continue;const{cellPointIds:o}=n.getCellPoints(c);if(!o)continue;St.add(c);const u=o[0],f=[];f.push({t:0,ptId:u});const g=e.traverseLoop(n,Qn.Forward,c,u,f);u!==g&&(e.traverseLoop(n,Qn.Backward,c,u,f),f.sort((l,h)=>l.t<h.t?-1:1),f.length&&f[0].ptId!==f[f.length-1]?.ptId&&f.push({...f[f.length-1]})),f.length&&s.push(f)}const i=r.getLines();i.resize(0),s.forEach(c=>{i.insertNextCell(c.map(o=>o.ptId))})}}const uc={};function Bs(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(t,uc,n),N.obj(e,t),N.algo(e,t,1,1),cc(e)}const fc=N.newInstance(Bs,"vtkContourLoopExtraction");var lc={newInstance:fc,extend:Bs};function gc(e,t,n=!1){let r=1/0,s=n?-1/0:0,a=1/0,i=n?-1/0:0,c=1/0,o=n?-1/0:0;const u=e[0]?.length===3;for(let f=0;f<e.length;f++){const g=e[f];r=Math.min(g[0],r),s=Math.max(g[0],s),a=Math.min(g[1],a),i=Math.max(g[1],i),u&&(c=Math.min(g[2]??c,c),o=Math.max(g[2]??o,o))}return n||(r=Math.max(0,r),s=Math.min(1/0,s),a=Math.max(0,a),i=Math.min(1/0,i),u&&(c=Math.max(0,c),o=Math.min(1/0,o))),u?[[r,s],[a,i],[c,o]]:[[r,s],[a,i],null]}function Zn(e,t){return gc(e,t,!0)}function Le(e,t,n,r){let s,a,i,c,o,u,f;const{numComps:g}=e;if(e.getScalarData?f=e.getScalarData():f=e.getPointData().getScalars().getData(),!f){console.warn("No scalar data found for imageData",e);return}const l=e.getDimensions();r?[[s,a],[i,c],[o,u]]=r:(s=0,a=l[0],i=0,c=l[1],o=0,u=l[2]);const h=z(s,i,o),y=e.getDirection(),p=y.slice(0,3),m=y.slice(3,6),C=y.slice(6,9),E=e.getSpacing(),[v,d,x]=E,w=e.indexToWorld(h),O=z(p[0]*v,p[1]*v,p[2]*v),T=z(m[0]*d,m[1]*d,m[2]*d),M=z(C[0]*x,C[1]*x,C[2]*x),S=g||f.length/l[2]/l[1]/l[0],L=l[0]*S,k=l[1]*L,$=[],D=Ee(w);for(let V=o;V<=u;V++){const _=Ee(D);for(let b=i;b<=c;b++){const ct=Ee(D);for(let G=s;G<=a;G++){const q=[G,b,V];if(t(D,q)){const ut=V*k+b*L+G*S;let vt;S>2?vt=[f[ut],f[ut+1],f[ut+2]]:vt=f[ut],$.push({value:vt,index:ut,pointIJK:q,pointLPS:D.slice()}),n&&n({value:vt,index:ut,pointIJK:q,pointLPS:D})}Se(D,D,O)}bn(D,ct),Se(D,D,T)}bn(D,_),Se(D,D,M)}return $}function hc(e,t){if(e.length!==t.length)throw Error("Both points should have the same dimensionality");const[n,r,s=0]=e,[a,i,c=0]=t,o=a-n,u=i-r,f=c-s;return o*o+u*u+f*f}function yc(e){if(e.length<3)return!1;const t=e.length,n=e[0],r=e[t-1],s=hc(n,r);return ti(0,s)}function ze(e,t,n={closed:void 0}){if(e.length<3)return!1;const r=e.length;let s=0;const{closed:a,holes:i}=n;if(i?.length){for(const u of i)if(ze(u,t))return!1}const c=!(a===void 0?yc(e):a),o=e.length-(c?1:2);for(let u=0;u<=o;u++){const f=e[u],g=u===r-1?0:u+1,l=e[g],h=f[0]>=l[0]?f[0]:l[0],y=f[1]>=l[1]?f[1]:l[1],p=f[1]<=l[1]?f[1]:l[1];if(t[0]<=h&&t[1]>=p&&t[1]<y){let E=f[0]===l[0];if(!E){const v=(t[1]-f[1])*(l[0]-f[0])/(l[1]-f[1])+f[0];E=t[0]<=v}s+=E?1:0}}return!!(s%2)}function tr(e,t){let n=e;const r=t?.numDimensions||2,s=r===3;if(!Array.isArray(e[0])){const g=e,l=g.length/r;n=new Array(g.length/r);for(let h=0,y=l;h<y;h++)n[h]=[g[h*r],g[h*r+1]],s&&n[h].push(g[h*r+2])}let a=1/0,i=1/0,c=-1/0,o=-1/0,u=1/0,f=-1/0;n=n;for(let g=0,l=n.length;g<l;g++){const[h,y,p]=n[g];a=a<h?a:h,i=i<y?i:y,c=c>h?c:h,o=o>y?o:y,s&&(u=u<p?u:p,f=f>p?f:p)}return s?{minX:a,maxX:c,minY:i,maxY:o,minZ:u,maxZ:f}:{minX:a,maxX:c,minY:i,maxY:o}}const pc=1e-6;function Dt(e){let t;const n=oc(e,50);for(let i=0;i<3;i++)if(n.every((c,o,u)=>Math.abs(c[i]-u[0][i])<pc)){t=i;break}if(t===void 0)throw new Error("Cannot find a shared dimension index for polyline, probably oblique plane");const r=[],s=(t+1)%3,a=(t+2)%3;for(let i=0;i<e.length;i++)r.push([e[i][s],e[i][a]]);return{sharedDimensionIndex:t,projectedPolyline:r}}const mc=(e,t,n,r,s,a,i,c)=>{const o=[z(n,r,s),z(a,r,s),z(n,i,s),z(a,i,s),z(n,r,c),z(a,r,c),z(n,i,c),z(a,i,c)],u=z(t[0],t[1],t[2]),f=z(e[0],e[1],e[2]),g=-Re(u,f);let l=null;for(const h of o){const y=Re(u,h)+g;if(l===null)l=Math.sign(y);else if(Math.sign(y)!==l)return!0}return!1},vc={polySeg:null,polySegInitializing:!1,polySegInitializingPromise:null,async initializePolySeg(e){if(this.polySegInitializing){await this.polySegInitializingPromise;return}this.polySeg?.instance||(this.polySegInitializing=!0,this.polySegInitializingPromise=new Promise(t=>{this.polySeg=new ht,this.polySeg.initialize({updateProgress:e}).then(()=>{this.polySegInitializing=!1,t()})}),await this.polySegInitializingPromise)},async convertContourToSurface(e,...t){const{polylines:n,numPointsArray:r}=e,[s]=t;return await this.initializePolySeg(s),await this.polySeg.instance.convertContourRoiToSurface(n,r)},async convertLabelmapToSurface(e,...t){const[n]=t;return await this.initializePolySeg(n),this.polySeg.instance.convertLabelmapToSurface(e.scalarData,e.dimensions,e.spacing,e.direction,e.origin,[e.segmentIndex])},async convertContourToVolumeLabelmap(e,...t){const[n]=t;await(await new ht).initialize({updateProgress:n});const{segmentIndices:s,scalarData:a,annotationUIDsInSegmentMap:i,dimensions:c,origin:o,direction:u,spacing:f}=e,g=j.createVolumeVoxelManager(c,a),l=xt.newInstance();l.setDimensions(c),l.setOrigin(o),l.setDirection(u),l.setSpacing(f);const h=Q.newInstance({name:"Pixels",numberOfComponents:1,values:a});l.getPointData().setScalars(h),l.modified();for(const y of s){const p=i.get(y);for(const m of p){if(!m.polyline)continue;const{polyline:C,holesPolyline:E}=m,v=Zn(C),[d,x,w]=Et(l,[v[0][0],v[1][0],v[2][0]]),[O,T,M]=Et(l,[v[0][1],v[1][1],v[2][1]]),{projectedPolyline:S,sharedDimensionIndex:L}=Dt(C),k=E?.map(V=>{const{projectedPolyline:_}=Dt(V);return _}),$=(L+1)%3,D=(L+2)%3;Le(l,V=>{const _=[V[$],V[D]];return ze(S,_,{holes:k})},({pointIJK:V})=>{g.setAtIJKPoint(V,y)},[[d,O],[x,T],[w,M]])}}return g.scalarData},async convertContourToStackLabelmap(e,...t){const[n]=t;await(await new ht).initialize({updateProgress:n});const{segmentationsInfo:s,annotationUIDsInSegmentMap:a,segmentIndices:i}=e,c=new Map;s.forEach((o,u)=>{const{dimensions:f,scalarData:g,direction:l,spacing:h,origin:y}=o,p=j.createVolumeVoxelManager(f,g),m=xt.newInstance();m.setDimensions(f),m.setOrigin(y),m.setDirection(l),m.setSpacing(h);const C=Q.newInstance({name:"Pixels",numberOfComponents:1,values:g});m.getPointData().setScalars(C),m.modified(),c.set(u,{manager:p,imageData:m})});for(const o of i){const u=a.get(o);for(const f of u){if(!f.polyline)continue;const{polyline:g,holesPolyline:l,referencedImageId:h}=f,y=Zn(g),{manager:p,imageData:m}=c.get(h),[C,E,v]=Et(m,[y[0][0],y[1][0],y[2][0]]),[d,x,w]=Et(m,[y[0][1],y[1][1],y[2][1]]),{projectedPolyline:O,sharedDimensionIndex:T}=Dt(g),M=l?.map(k=>{const{projectedPolyline:$}=Dt(k);return $}),S=(T+1)%3,L=(T+2)%3;Le(m,k=>{const $=[k[S],k[L]];return ze(O,$,{holes:M})},({pointIJK:k})=>{p.setAtIJKPoint(k,o)},[[C,d],[E,x],[v,w]])}}return s.forEach((o,u)=>{const{manager:f}=c.get(u);o.scalarData=f.scalarData}),s},async convertSurfaceToVolumeLabelmap(e,...t){const[n]=t;return await this.initializePolySeg(n),this.polySeg.instance.convertSurfaceToLabelmap(e.points,e.polys,e.dimensions,e.spacing,e.direction,e.origin)},async convertSurfacesToVolumeLabelmap(e,...t){const[n]=t;await this.initializePolySeg(n);const{segmentsInfo:r}=e,s=Array.from(r.keys()).map(g=>{const{points:l,polys:h}=r.get(g);return{...this.polySeg.instance.convertSurfaceToLabelmap(l,h,e.dimensions,e.spacing,e.direction,e.origin),segmentIndex:g}}),a=await Promise.all(s),i=xt.newInstance();i.setDimensions(e.dimensions),i.setOrigin(e.origin),i.setSpacing(e.spacing),i.setDirection(e.direction);const c=e.dimensions[0]*e.dimensions[1]*e.dimensions[2],o=Q.newInstance({name:"Pixels",numberOfComponents:1,values:new Uint8Array(c)});i.getPointData().setScalars(o),i.modified();const u=j.createVolumeVoxelManager(e.dimensions,i.getPointData().getScalars().getData()),f=a.map(g=>{const{data:l,dimensions:h,direction:y,origin:p,spacing:m}=g,C=xt.newInstance();C.setDimensions(h),C.setOrigin(p),C.setSpacing(m),C.setDirection(y);const E=Q.newInstance({name:"Pixels",numberOfComponents:1,values:l});C.getPointData().setScalars(E),C.modified();const v=j.createVolumeVoxelManager(h,l),d=C.getExtent();return{volume:C,voxelManager:v,extent:d,scalarData:l,segmentIndex:g.segmentIndex}});return Le(i,()=>!0,({pointIJK:g,pointLPS:l})=>{try{for(const h of f){const{volume:y,extent:p,voxelManager:m,segmentIndex:C}=h,E=y.worldToIndex(l);if(E[0]<p[0]||E[0]>p[1]||E[1]<p[2]||E[1]>p[3]||E[2]<p[4]||E[2]>p[5])continue;const v=E.map(Math.round);if(m.getAtIJK(...v)>0){u.setAtIJKPoint(g,C);break}}}catch{}}),u.scalarData},getSurfacesAABBs({surfacesInfo:e}){const t=new Map;for(const{points:n,id:r}of e){const s=tr(n,{numDimensions:3});t.set(r,s)}return t},cutSurfacesIntoPlanes({planesInfo:e,surfacesInfo:t,surfacesAABB:n=new Map},r,s){const a=e.length,i=sc.newInstance(),c=ot.newInstance();i.setCutFunction(c);const o=an.newInstance();try{for(const[u,f]of e.entries()){const{sliceIndex:g,planes:l}=f,h=new Map;for(const y of t){const{points:p,polys:m,id:C}=y,E=n.get(C)||tr(p,{numDimensions:3});n.has(C)||n.set(C,E);const{minX:v,minY:d,minZ:x,maxX:w,maxY:O,maxZ:T}=E,{origin:M,normal:S}=l[0];if(!mc(M,S,v,d,x,w,O,T))continue;o.getPoints().setData(p,3),o.getPolys().setData(m,3),o.modified(),i.setInputData(o),c.setOrigin(M),c.setNormal(S);try{i.update()}catch(V){console.warn("Error during clipping",V);continue}const L=i.getOutputData(),k=L;k.buildLinks();const $=lc.newInstance();$.setInputData(k);const D=$.getOutputData();L&&h.set(C,{points:D.getPoints().getData(),lines:D.getLines().getData(),numberOfCells:D.getLines().getNumberOfCells()})}r({progress:(u+1)/a}),s({sliceIndex:g,polyDataResults:h})}}catch(u){console.warn("Error during processing",u)}finally{t=null,c.delete()}}};Ae(vc)});export default dc();
